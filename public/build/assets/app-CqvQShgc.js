import{N as Me,A as Ve,E as Be,a as ze,d as ae,r as Ke,T as Qe,p as Ie,f as Ge}from"./vendor-pt-cqKXK.js";import{C as Le,f as Ue,B as We,g as Xe,L as Je,p as Ye,h as Ze}from"./vendor_chartjs-Bm73lTZW.js";window.Notyf=Me;window.Ably=Ve;window.Echo=new Be({broadcaster:"ably",tls:!0,disableStats:!0,authEndpoint:"/broadcasting/auth",auth:{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}});window.Echo.connector.ably.connection.on(t=>{t.current==="connected"&&console.log("connected to ably server")});window.Echo.connector.ably.connection.on("stateChange",t=>{t.current==="connected"?console.log("Connected to Ably server"):t.current==="failed"&&console.error("Failed to connect to Ably server:",t.reason)});window.axios=ze;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";let de=document.head.querySelector('meta[name="csrf-token"]');de?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=de.content:console.error("CSRF token not found!");var et=Object.defineProperty,tt=(t,e,s)=>e in t?et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,D=(t,e,s)=>tt(t,typeof e!="symbol"?e+"":e,s);document.addEventListener("alpine:init",()=>{window.Alpine.store("editOnClickValidation",{pending:[],set(t,e){this.pending=this.pending.filter(s=>s.value!==t),this.pending.push({value:t,textContent:e})},has(t){return this.pending.some(e=>e.value===t)},get(t){return this.pending.find(e=>e.value===t)},notContains(t){return this.pending.length>0&&!this.has(t)},clear(){this.pending=[]},getTextContent(t){const e=this.pending.find(s=>s.value===t);return e?e.textContent:null}}),window.editOnClickValidation=window.Alpine.store("editOnClickValidation")});document.addEventListener("alpine:init",()=>{window.Alpine.store("pgBulkActions",{selected:[],init(){window.addEventListener("pgBulkActions::addMore",t=>{const e=t.__livewire.params[0];typeof this.selected[e.tableName]>"u"&&(this.selected[e.tableName]=[]),this.selected[e.tableName].push(e.value)}),window.addEventListener("pgBulkActions::clear",t=>{this.clear(t.detail)}),window.addEventListener("pgBulkActions::clearAll",()=>{this.clearAll()})},add(t,e){if(typeof this.selected[e]>"u"&&(this.selected[e]=[]),!this.selected[e].includes(t)){this.selected[e].push(t);return}this.remove(t,e)},remove(t,e){const s=this.selected[e].indexOf(t);s>-1&&this.selected[e].splice(s,1)},get(t){return this.selected[t]??""},count(t){return typeof this.selected[t]>"u"?0:this.selected[t].length},clear(t){this.selected[t]=[]},clearAll(){this.selected=[]}}),window.pgBulkActions=window.Alpine.store("pgBulkActions")});const st=t=>({field:t.field??null,tableName:t.tableName??null,enabled:t.enabled??!1,id:t.id,trueValue:t.trueValue,falseValue:t.falseValue,toggle:t.toggle,save(){this.toggle=this.toggle===0?1:0,this.$wire.dispatch("pg:toggleable-"+this.tableName,{id:this.id,field:this.field,value:this.toggle})}}),nt=(t,e,s)=>{const n=t[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})},it=t=>({dataField:t.dataField,tableName:t.tableName,label:t.label??null,locale:t.locale??{locale:"default",dateFormat:"Y-m-d H:i",time_24hr:!1,enableTime:!0},onlyFuture:t.onlyFuture??!1,noWeekEnds:t.noWeekEnds??!1,customConfig:t.customConfig??null,type:t.type,element:null,selectedDates:null,async init(){typeof flatpickr>"u"&&(console.log("%c%s","color: #f59e0c; font-size: 1.2em; font-weight: bold; line-height: 1.5"," PowerGrid"),console.error("%c%s","font-size: 1em; line-height: 1.5",`
Failed to mount filter: Filter::datetime('${this.dataField}') on table ['${this.tableName}']

• Install flatpickr: npm install flatpickr

• Add 'import flatpickr from "flatpickr"' in resources/js/app.js file
  `)),window.addEventListener(`pg:clear_flatpickr::${this.tableName}:${this.dataField}`,()=>{this.$refs.rangeInput&&this.element&&this.element.clear()}),window.addEventListener(`pg:clear_all_flatpickr::${this.tableName}`,()=>{this.$refs.rangeInput&&this.element&&this.element.clear()});try{const s=await nt(Object.assign({}),`./flatpickr/dist/l10n/${this.locale.locale}.js`,5);flatpickr.localize(s.default||s)}catch{}const e=this.getOptions();this.$refs.rangeInput&&typeof flatpickr<"u"&&(this.element=flatpickr(this.$refs.rangeInput,e),this.selectedDates=this.$wire.get(`filters.${this.type}.${this.dataField}.formatted`),this.element.setDate(this.selectedDates))},getOptions(){const e={mode:"range",defaultHour:0,...this.locale,...this.customConfig};return this.onlyFuture&&(e.minDate="today"),this.noWeekEnds&&(e.disable=[function(s){return s.getDay()===0||s.getDay()===6}]),e.onClose=(s,n,i)=>{s=s.map(o=>this.element.formatDate(o,"Y-m-d")),s.length>0&&this.selectedDates!==n&&Livewire.dispatch("pg:datePicker-"+this.tableName,{selectedDates:s,dateStr:n,timezone:this.customConfig.timezone??new Date().toString().match(/([-\+][0-9]+)\s/)[1],type:this.type,field:this.dataField,label:this.label,dateFormat:this.locale.dateFormat??"Y-m-d H:i"})},e}}),rt=t=>({theme:t.theme,id:t.id??null,dataField:t.dataField??null,content:t.content,fallback:t.fallback,inputClass:t.inputClass,saveOnMouseOut:t.saveOnMouseOut,oldContent:null,editable:!1,hash:null,hashError:!0,showEditable:!1,editableInput:"",init(){this.content.length===0&&this.fallback&&(this.content=this.htmlSpecialChars(this.fallback)),this.hash=this.dataField+"-"+this.id,window.addEventListener("toggle-"+this.hash,()=>{this.observe(()=>document.getElementById("clickable-"+this.hash),e=>{e.click(),this.observe(()=>document.getElementById("editable-"+this.hash),s=>{setTimeout(()=>this.setFocusToEnd(s),100)})})}),this.$watch("editable",e=>{if(e){let s=!1;if(this.showEditable=!1,this.content=this.htmlSpecialChars(this.content),this.oldContent=this.content,this.hashError=this.store().notContains(this.hash),this.observe(()=>document.getElementById("editable-"+this.hash),n=>{setTimeout(()=>{this.setFocusToEnd(n),this.store().getTextContent(this.hash)&&(n.textContent=this.store().getTextContent(this.hash))},30)}),this.hashError){const n=this.store().get(this.hash),i=document.getElementById("clickable-"+n);i&&i.click()}s=!0,this.editableInput=`
                <div
                    x-ref="editable"
                    x-text="content"
                    value="${this.content}"
                    placeholder="${this.content}"
                    contenteditable
                    class="pg-single-line ${this.inputClass}"
                    ${this.saveOnMouseOut?'x-on:mousedown.outside="save()"':""}
                    x-on:keydown.enter="save()"
                    id="${"editable-"+this.dataField+"-"+this.id}"
                    x-on:keydown.esc="cancel"
                >
                </div>`,this.$nextTick(()=>setTimeout(()=>{this.showEditable=s,this.focus()},150))}}),this.content=this.htmlSpecialChars(this.content)},store(){return window.editOnClickValidation},save(){this.store().clear(),this.store().set(this.hash,this.$el.textContent),this.observe(()=>document.getElementById("clickable-"+this.hash),e=>{e.textContent=this.$el.textContent}),window.addEventListener("pg:editable-close-"+this.id,()=>{this.store().clear(),this.editable=!1,this.showEditable=!1}),this.store().has(this.hash)||this.store().set(this.hash,this.$el.textContent),this.$wire.dispatch("pg:editable-"+this.$wire.tableName,{id:this.id,value:this.$el.textContent,field:this.dataField}),this.oldContent=this.store().getTextContent(this.hash),this.$nextTick(()=>{this.focus(),this.$el.setAttribute("value","")}),this.content=this.htmlSpecialChars(this.$el.textContent)},focus(){this.setFocusToEnd(this.$el)},cancel(){this.store().clear(),this.$refs.editable.textContent=this.oldContent,this.content=this.oldContent,this.editable=!1,this.showEditable=!1,this.$refs.error&&(this.$refs.error.innerHTML="")},htmlSpecialChars(e){const s=document.createElement("div");return s.innerHTML=e,s.textContent},observe(e,s){new MutationObserver((n,i)=>{for(let o of n)if(o.type==="childList"){const r=e();if(r){s(r),i.disconnect();break}}}).observe(document.body,{childList:!0,subtree:!0})},setFocusToEnd(e){if(!e)return;const s=window.getSelection(),n=document.createRange();n.selectNodeContents(e),n.collapse(!1),s.removeAllRanges(),s.addRange(n),e.focus()}});function ot(t){t.querySelectorAll("tbody tr td").forEach(e=>{e.classList.remove("hidden")}),t.querySelectorAll("thead tr th").forEach(e=>{e.classList.remove("hidden")})}function lt(t){let e=0;const s=t.querySelectorAll("table thead tr:nth-child(1) th[fixed]"),n=oe(t);return s.forEach(i=>{e+=oe(i)}),n-e}function at(t,e){const s=[].slice.call(t.querySelectorAll("table thead tr:nth-child(1) th")),n=Array.from(s).filter(a=>getComputedStyle(a).display!=="none"),i=[].slice.call(n).sort(function(a,c){const u=a.getAttribute("sort_order")??999,d=c.getAttribute("sort_order")??999;return u-d});let o=0,r=!0;const l=[];return i.forEach(a=>{const c=oe(a);a.getAttribute("fixed")===null&&(r&&o<=e&&o+c<=e?o+=c:(l.push(n.indexOf(a)+1),r=!1))}),l}function ct(t,e){for(const s of e)t.querySelectorAll(`tbody:not(tbody[expand]) tr td:nth-child(${s})`).forEach(n=>{n.classList.add("hidden")}),t.querySelectorAll(`thead tr th:nth-child(${s})`).forEach(n=>{n.classList.add("hidden")})}function dt(t,e){var s,n;if(t.querySelectorAll("table tbody[expand] tr td div").length){for(const i of t.querySelectorAll("table tbody[expand] tr td div"))i.innerHTML="";if(e.length)for(const i of e){const o=t.querySelectorAll("table tbody:not(tbody[expand])");for(const r of o){const l=(s=r.nextElementSibling)==null?void 0:s.querySelector("tr td div");if(!l)continue;let a=t.querySelector(`table thead tr th:nth-child(${i}) span[data-value]`).textContent;const c=(n=r.querySelector(`tr:last-child td:nth-child(${i})`))==null?void 0:n.innerHTML;a.length&&(a+=":"),l.querySelector(`div[data-expand-item-${i}]`)||(l.innerHTML+=`<div class="responsive-row-expand-item-container" data-expand-item-${i}>
                    <span class="font-bold responsive-row-expand-item-name">${a}</span>
                    <span class="responsive-row-expand-item-value">${c}</span>
                </div>`)}}}}function oe(t){return parseFloat(t.getBoundingClientRect().width.toFixed(2))}function ut(t){ot(t);const e=lt(t),s=at(t,e);dt(t,s),ct(t,s)}const pt=()=>({running:!1,expanded:null,element:null,hasHiddenElements:!1,size:0,toggleExpanded(t){this.expanded=this.expanded==t?null:t},init(){this.$nextTick(()=>{this.handleResize(),this.observeElement(),window.addEventListener("pg-livewire-request-finished",()=>{setTimeout(()=>this.handleResize(),5)})})},handleResize(){var t;const e=this.$el;ut(e),this.hasHiddenElements=(t=e.querySelector("table tbody[expand] tr td div"))==null?void 0:t.innerHTML,this.hasHiddenElements||(this.expanded=null)},observeElement(){new ResizeObserver(t=>{t.forEach(e=>{if(e.contentRect.width>0){if(this.size===this.$el.getBoundingClientRect().width)return;this.size=this.$el.getBoundingClientRect().width,this.handleResize()}})}).observe(this.$el)}}),ht=(t,e,s)=>{Livewire.dispatch(`${t}-${e.tableName}`,{label:e.label,field:e.dataField,values:s})},Fe=(t,e)=>{ht("pg:multiSelect",t,e)};function Z(t,e){t.split(/\s+/).forEach(s=>{e(s)})}class ft{constructor(){this._events={}}on(e,s){Z(e,n=>{const i=this._events[n]||[];i.push(s),this._events[n]=i})}off(e,s){var n=arguments.length;if(n===0){this._events={};return}Z(e,i=>{if(n===1){delete this._events[i];return}const o=this._events[i];o!==void 0&&(o.splice(o.indexOf(s),1),this._events[i]=o)})}trigger(e,...s){var n=this;Z(e,i=>{const o=n._events[i];o!==void 0&&o.forEach(r=>{r.apply(n,s)})})}}function gt(t){return t.plugins={},class extends t{constructor(){super(...arguments),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(e,s){t.plugins[e]={name:e,fn:s}}initializePlugins(e){var s,n;const i=this,o=[];if(Array.isArray(e))e.forEach(r=>{typeof r=="string"?o.push(r):(i.plugins.settings[r.name]=r.options,o.push(r.name))});else if(e)for(s in e)e.hasOwnProperty(s)&&(i.plugins.settings[s]=e[s],o.push(s));for(;n=o.shift();)i.require(n)}loadPlugin(e){var s=this,n=s.plugins,i=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');n.requested[e]=!0,n.loaded[e]=i.fn.apply(s,[s.plugins.settings[e]||{}]),n.names.push(e)}require(e){var s=this,n=s.plugins;if(!s.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');s.loadPlugin(e)}return n.loaded[e]}}}const Y=t=>(t=t.filter(Boolean),t.length<2?t[0]||"":vt(t)==1?"["+t.join("")+"]":"(?:"+t.join("|")+")"),$e=t=>{if(!mt(t))return t.join("");let e="",s=0;const n=()=>{s>1&&(e+="{"+s+"}")};return t.forEach((i,o)=>{if(i===t[o-1]){s++;return}n(),e+=i,s=1}),n(),e},Te=t=>{let e=Array.from(t);return Y(e)},mt=t=>new Set(t).size!==t.length,R=t=>(t+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),vt=t=>t.reduce((e,s)=>Math.max(e,yt(s)),0),yt=t=>Array.from(t).length,qe=t=>{if(t.length===1)return[[t]];let e=[];const s=t.substring(1);return qe(s).forEach(function(n){let i=n.slice(0);i[0]=t.charAt(0)+i[0],e.push(i),i=n.slice(0),i.unshift(t.charAt(0)),e.push(i)}),e},bt=[[0,65535]],wt="[̀-ͯ·ʾʼ]";let W,je;const Ot=3,ce={},ue={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let t in ue){let e=ue[t]||"";for(let s=0;s<e.length;s++){let n=e.substring(s,s+1);ce[n]=t}}const Ct=new RegExp(Object.keys(ce).join("|")+"|"+wt,"gu"),At=t=>{W===void 0&&(W=_t(bt))},pe=(t,e="NFKD")=>t.normalize(e),X=t=>Array.from(t).reduce((e,s)=>e+St(s),""),St=t=>(t=pe(t).toLowerCase().replace(Ct,e=>ce[e]||""),pe(t,"NFC"));function*kt(t){for(const[e,s]of t)for(let n=e;n<=s;n++){let i=String.fromCharCode(n),o=X(i);o!=i.toLowerCase()&&(o.length>Ot||o.length!=0&&(yield{folded:o,composed:i,code_point:n}))}}const xt=t=>{const e={},s=(n,i)=>{const o=e[n]||new Set,r=new RegExp("^"+Te(o)+"$","iu");i.match(r)||(o.add(R(i)),e[n]=o)};for(let n of kt(t))s(n.folded,n.folded),s(n.folded,n.composed);return e},_t=t=>{const e=xt(t),s={};let n=[];for(let o in e){let r=e[o];r&&(s[o]=Te(r)),o.length>1&&n.push(R(o))}n.sort((o,r)=>r.length-o.length);const i=Y(n);return je=new RegExp("^"+i,"u"),s},Et=(t,e=1)=>{let s=0;return t=t.map(n=>(W[n]&&(s+=n.length),W[n]||n)),s>=e?$e(t):""},It=(t,e=1)=>(e=Math.max(e,t.length-1),Y(qe(t).map(s=>Et(s,e)))),he=(t,e=!0)=>{let s=t.length>1?1:0;return Y(t.map(n=>{let i=[];const o=e?n.length():n.length()-1;for(let r=0;r<o;r++)i.push(It(n.substrs[r]||"",s));return $e(i)}))},Lt=(t,e)=>{for(const s of e){if(s.start!=t.start||s.end!=t.end||s.substrs.join("")!==t.substrs.join(""))continue;let n=t.parts;const i=o=>{for(const r of n){if(r.start===o.start&&r.substr===o.substr)return!1;if(!(o.length==1||r.length==1)&&(o.start<r.start&&o.end>r.start||r.start<o.start&&r.end>o.start))return!0}return!1};if(!(s.parts.filter(i).length>0))return!0}return!1};class J{constructor(){D(this,"parts"),D(this,"substrs"),D(this,"start"),D(this,"end"),this.parts=[],this.substrs=[],this.start=0,this.end=0}add(e){e&&(this.parts.push(e),this.substrs.push(e.substr),this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(e,s){let n=new J,i=JSON.parse(JSON.stringify(this.parts)),o=i.pop();for(const a of i)n.add(a);let r=s.substr.substring(0,e-o.start),l=r.length;return n.add({start:o.start,end:o.start+l,length:l,substr:r}),n}}const Ft=t=>{At(),t=X(t);let e="",s=[new J];for(let n=0;n<t.length;n++){let i=t.substring(n).match(je);const o=t.substring(n,n+1),r=i?i[0]:null;let l=[],a=new Set;for(const c of s){const u=c.last();if(!u||u.length==1||u.end<=n)if(r){const d=r.length;c.add({start:n,end:n+d,length:d,substr:r}),a.add("1")}else c.add({start:n,end:n+1,length:1,substr:o}),a.add("2");else if(r){let d=c.clone(n,u);const h=r.length;d.add({start:n,end:n+h,length:h,substr:r}),l.push(d)}else a.add("3")}if(l.length>0){l=l.sort((c,u)=>c.length()-u.length());for(let c of l)Lt(c,s)||s.push(c);continue}if(n>0&&a.size==1&&!a.has("3")){e+=he(s,!1);let c=new J;const u=s[0];u&&c.add(u.last()),s=[c]}}return e+=he(s,!0),e},$t=(t,e)=>{if(t)return t[e]},Tt=(t,e)=>{if(t){for(var s,n=e.split(".");(s=n.shift())&&(t=t[s]););return t}},ee=(t,e,s)=>{var n,i;return!t||(t=t+"",e.regex==null)||(i=t.search(e.regex),i===-1)?0:(n=e.string.length/t.length,i===0&&(n+=.5),n*s)},te=(t,e)=>{var s=t[e];if(typeof s=="function")return s;s&&!Array.isArray(s)&&(t[e]=[s])},z=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},qt=(t,e)=>typeof t=="number"&&typeof e=="number"?t>e?1:t<e?-1:0:(t=X(t+"").toLowerCase(),e=X(e+"").toLowerCase(),t>e?1:e>t?-1:0);class jt{constructor(e,s){D(this,"items"),D(this,"settings"),this.items=e,this.settings=s||{diacritics:!0}}tokenize(e,s,n){if(!e||!e.length)return[];const i=[],o=e.split(/\s+/);var r;return n&&(r=new RegExp("^("+Object.keys(n).map(R).join("|")+"):(.*)$")),o.forEach(l=>{let a,c=null,u=null;r&&(a=l.match(r))&&(c=a[1],l=a[2]),l.length>0&&(this.settings.diacritics?u=Ft(l)||null:u=R(l),u&&s&&(u="\\b"+u)),i.push({string:l,regex:u?new RegExp(u,"iu"):null,field:c})}),i}getScoreFunction(e,s){var n=this.prepareSearch(e,s);return this._getScoreFunction(n)}_getScoreFunction(e){const s=e.tokens,n=s.length;if(!n)return function(){return 0};const i=e.options.fields,o=e.weights,r=i.length,l=e.getAttrFn;if(!r)return function(){return 1};const a=function(){return r===1?function(c,u){const d=i[0].field;return ee(l(u,d),c,o[d]||1)}:function(c,u){var d=0;if(c.field){const h=l(u,c.field);!c.regex&&h?d+=1/r:d+=ee(h,c,1)}else z(o,(h,O)=>{d+=ee(l(u,O),c,h)});return d/r}}();return n===1?function(c){return a(s[0],c)}:e.options.conjunction==="and"?function(c){var u,d=0;for(let h of s){if(u=a(h,c),u<=0)return 0;d+=u}return d/n}:function(c){var u=0;return z(s,d=>{u+=a(d,c)}),u/n}}getSortFunction(e,s){var n=this.prepareSearch(e,s);return this._getSortFunction(n)}_getSortFunction(e){var s,n=[];const i=this,o=e.options,r=!e.query&&o.sort_empty?o.sort_empty:o.sort;if(typeof r=="function")return r.bind(this);const l=function(a,c){return a==="$score"?c.score:e.getAttrFn(i.items[c.id],a)};if(r)for(let a of r)(e.query||a.field!=="$score")&&n.push(a);if(e.query){s=!0;for(let a of n)if(a.field==="$score"){s=!1;break}s&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter(a=>a.field!=="$score");return n.length?function(a,c){var u,d;for(let h of n)if(d=h.field,u=(h.direction==="desc"?-1:1)*qt(l(d,a),l(d,c)),u)return u;return 0}:null}prepareSearch(e,s){const n={};var i=Object.assign({},s);if(te(i,"sort"),te(i,"sort_empty"),i.fields){te(i,"fields");const o=[];i.fields.forEach(r=>{typeof r=="string"&&(r={field:r,weight:1}),o.push(r),n[r.field]="weight"in r?r.weight:1}),i.fields=o}return{options:i,query:e.toLowerCase().trim(),tokens:this.tokenize(e,i.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:i.nesting?Tt:$t}}search(e,s){var n=this,i,o;o=this.prepareSearch(e,s),s=o.options,e=o.query;const r=s.score||n._getScoreFunction(o);e.length?z(n.items,(a,c)=>{i=r(a),(s.filter===!1||i>0)&&o.items.push({score:i,id:c})}):z(n.items,(a,c)=>{o.items.push({score:1,id:c})});const l=n._getSortFunction(o);return l&&o.items.sort(l),o.total=o.items.length,typeof s.limit=="number"&&(o.items=o.items.slice(0,s.limit)),o}}const F=t=>typeof t>"u"||t===null?null:U(t),U=t=>typeof t=="boolean"?t?"1":"0":t+"",se=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),Nt=(t,e)=>e>0?window.setTimeout(t,e):(t.call(null),null),Pt=(t,e)=>{var s;return function(n,i){var o=this;s&&(o.loading=Math.max(o.loading-1,0),clearTimeout(s)),s=setTimeout(function(){s=null,o.loadedSearches[n]=!0,t.call(o,n,i)},e)}},fe=(t,e,s)=>{var n,i=t.trigger,o={};t.trigger=function(){var r=arguments[0];if(e.indexOf(r)!==-1)o[r]=arguments;else return i.apply(t,arguments)},s.apply(t,[]),t.trigger=i;for(n of e)n in o&&i.apply(t,o[n])},Ht=t=>({start:t.selectionStart||0,length:(t.selectionEnd||0)-(t.selectionStart||0)}),k=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},E=(t,e,s,n)=>{t.addEventListener(e,s,n)},j=(t,e)=>{if(!e||!e[t])return!1;var s=(e.altKey?1:0)+(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.metaKey?1:0);return s===1},ne=(t,e)=>t.getAttribute("id")||(t.setAttribute("id",e),e),ge=t=>t.replace(/[\\"']/g,"\\$&"),N=(t,e)=>{e&&t.append(e)},x=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},T=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(Ne(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},Ne=t=>typeof t=="string"&&t.indexOf("<")>-1,Dt=t=>t.replace(/['"\\]/g,"\\$&"),ie=(t,e)=>{var s=document.createEvent("HTMLEvents");s.initEvent(e,!0,!1),t.dispatchEvent(s)},K=(t,e)=>{Object.assign(t.style,e)},L=(t,...e)=>{var s=Pe(e);t=He(t),t.map(n=>{s.map(i=>{n.classList.add(i)})})},q=(t,...e)=>{var s=Pe(e);t=He(t),t.map(n=>{s.map(i=>{n.classList.remove(i)})})},Pe=t=>{var e=[];return x(t,s=>{typeof s=="string"&&(s=s.trim().split(/[\t\n\f\r\s]/)),Array.isArray(s)&&(e=e.concat(s))}),e.filter(Boolean)},He=t=>(Array.isArray(t)||(t=[t]),t),re=(t,e,s)=>{if(!(s&&!s.contains(t)))for(;t&&t.matches;){if(t.matches(e))return t;t=t.parentNode}},me=(t,e=0)=>e>0?t[t.length-1]:t[0],Rt=t=>Object.keys(t).length===0,ve=(t,e)=>{if(!t)return-1;e=e||t.nodeName;for(var s=0;t=t.previousElementSibling;)t.matches(e)&&s++;return s},A=(t,e)=>{x(e,(s,n)=>{s==null?t.removeAttribute(n):t.setAttribute(n,""+s)})},le=(t,e)=>{t.parentNode&&t.parentNode.replaceChild(e,t)},Mt=(t,e)=>{if(e===null)return;if(typeof e=="string"){if(!e.length)return;e=new RegExp(e,"i")}const s=o=>{var r=o.data.match(e);if(r&&o.data.length>0){var l=document.createElement("span");l.className="highlight";var a=o.splitText(r.index);a.splitText(r[0].length);var c=a.cloneNode(!0);return l.appendChild(c),le(a,l),1}return 0},n=o=>{o.nodeType===1&&o.childNodes&&!/(script|style)/i.test(o.tagName)&&(o.className!=="highlight"||o.tagName!=="SPAN")&&Array.from(o.childNodes).forEach(r=>{i(r)})},i=o=>o.nodeType===3?s(o):(n(o),0);i(t)},Vt=t=>{var e=t.querySelectorAll("span.highlight");Array.prototype.forEach.call(e,function(s){var n=s.parentNode;n.replaceChild(s.firstChild,s),n.normalize()})},Bt=65,zt=13,Kt=27,Qt=37,Gt=38,Ut=39,Wt=40,ye=8,Xt=46,be=9,Jt=typeof navigator>"u"?!1:/Mac/.test(navigator.userAgent),Q=Jt?"metaKey":"ctrlKey",we={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(t){return t.length>0},render:{}};function Oe(t,e){var s=Object.assign({},we,e),n=s.dataAttr,i=s.labelField,o=s.valueField,r=s.disabledField,l=s.optgroupField,a=s.optgroupLabelField,c=s.optgroupValueField,u=t.tagName.toLowerCase(),d=t.getAttribute("placeholder")||t.getAttribute("data-placeholder");if(!d&&!s.allowEmptyOption){let v=t.querySelector('option[value=""]');v&&(d=v.textContent)}var h={placeholder:d,options:[],optgroups:[],items:[],maxItems:null},O=()=>{var v,C=h.options,b={},f=1;let S=0;var $=m=>{var y=Object.assign({},m.dataset),g=n&&y[n];return typeof g=="string"&&g.length&&(y=Object.assign(y,JSON.parse(g))),y},M=(m,y)=>{var g=F(m.value);if(g!=null&&!(!g&&!s.allowEmptyOption)){if(b.hasOwnProperty(g)){if(y){var _=b[g][l];_?Array.isArray(_)?_.push(y):b[g][l]=[_,y]:b[g][l]=y}}else{var w=$(m);w[i]=w[i]||m.textContent,w[o]=w[o]||g,w[r]=w[r]||m.disabled,w[l]=w[l]||y,w.$option=m,w.$order=w.$order||++S,b[g]=w,C.push(w)}m.selected&&h.items.push(g)}},P=m=>{var y,g;g=$(m),g[a]=g[a]||m.getAttribute("label")||"",g[c]=g[c]||f++,g[r]=g[r]||m.disabled,g.$order=g.$order||++S,h.optgroups.push(g),y=g[c],x(m.children,_=>{M(_,y)})};h.maxItems=t.hasAttribute("multiple")?null:1,x(t.children,m=>{v=m.tagName.toLowerCase(),v==="optgroup"?P(m):v==="option"&&M(m)})},p=()=>{const v=t.getAttribute(n);if(v)h.options=JSON.parse(v),x(h.options,b=>{h.items.push(b[o])});else{var C=t.value.trim()||"";if(!s.allowEmptyOption&&!C.length)return;const b=C.split(s.delimiter);x(b,f=>{const S={};S[i]=f,S[o]=f,h.options.push(S)}),h.items=b}};return u==="select"?O():p(),Object.assign({},we,h,e)}var Ce=0;class I extends gt(ft){constructor(e,s){super(),this.order=0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,Ce++;var n,i=T(e);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this;var o=window.getComputedStyle&&window.getComputedStyle(i,null);n=o.getPropertyValue("direction");const r=Oe(i,s);this.settings=r,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag=i.tagName.toLowerCase()==="select",this.rtl=/rtl/i.test(n),this.inputId=ne(i,"tomselect-"+Ce),this.isRequired=i.required,this.sifter=new jt(this.options,{diacritics:r.diacritics}),r.mode=r.mode||(r.maxItems===1?"single":"multi"),typeof r.hideSelected!="boolean"&&(r.hideSelected=r.mode==="multi"),typeof r.hidePlaceholder!="boolean"&&(r.hidePlaceholder=r.mode!=="multi");var l=r.createFilter;typeof l!="function"&&(typeof l=="string"&&(l=new RegExp(l)),l instanceof RegExp?r.createFilter=C=>l.test(C):r.createFilter=C=>this.settings.duplicates||!this.options[C]),this.initializePlugins(r.plugins),this.setupCallbacks(),this.setupTemplates();const a=T("<div>"),c=T("<div>"),u=this._render("dropdown"),d=T('<div role="listbox" tabindex="-1">'),h=this.input.getAttribute("class")||"",O=r.mode;var p;if(L(a,r.wrapperClass,h,O),L(c,r.controlClass),N(a,c),L(u,r.dropdownClass,O),r.copyClassesToDropdown&&L(u,h),L(d,r.dropdownContentClass),N(u,d),T(r.dropdownParent||a).appendChild(u),Ne(r.controlInput)){p=T(r.controlInput);var v=["autocorrect","autocapitalize","autocomplete","spellcheck"];x(v,C=>{i.getAttribute(C)&&A(p,{[C]:i.getAttribute(C)})}),p.tabIndex=-1,c.appendChild(p),this.focus_node=p}else r.controlInput?(p=T(r.controlInput),this.focus_node=p):(p=T("<input/>"),this.focus_node=c);this.wrapper=a,this.dropdown=u,this.dropdown_content=d,this.control=c,this.control_input=p,this.setup()}setup(){const e=this,s=e.settings,n=e.control_input,i=e.dropdown,o=e.dropdown_content,r=e.wrapper,l=e.control,a=e.input,c=e.focus_node,u={passive:!0},d=e.inputId+"-ts-dropdown";A(o,{id:d}),A(c,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":d});const h=ne(c,e.inputId+"-ts-control"),O="label[for='"+Dt(e.inputId)+"']",p=document.querySelector(O),v=e.focus.bind(e);if(p){E(p,"click",v),A(p,{for:h});const f=ne(p,e.inputId+"-ts-label");A(c,{"aria-labelledby":f}),A(o,{"aria-labelledby":f})}if(r.style.width=a.style.width,e.plugins.names.length){const f="plugin-"+e.plugins.names.join(" plugin-");L([r,i],f)}(s.maxItems===null||s.maxItems>1)&&e.is_select_tag&&A(a,{multiple:"multiple"}),s.placeholder&&A(n,{placeholder:s.placeholder}),!s.splitOn&&s.delimiter&&(s.splitOn=new RegExp("\\s*"+R(s.delimiter)+"+\\s*")),s.load&&s.loadThrottle&&(s.load=Pt(s.load,s.loadThrottle)),E(i,"mousemove",()=>{e.ignoreHover=!1}),E(i,"mouseenter",f=>{var S=re(f.target,"[data-selectable]",i);S&&e.onOptionHover(f,S)},{capture:!0}),E(i,"click",f=>{const S=re(f.target,"[data-selectable]");S&&(e.onOptionSelect(f,S),k(f,!0))}),E(l,"click",f=>{var S=re(f.target,"[data-ts-item]",l);if(S&&e.onItemSelect(f,S)){k(f,!0);return}n.value==""&&(e.onClick(),k(f,!0))}),E(c,"keydown",f=>e.onKeyDown(f)),E(n,"keypress",f=>e.onKeyPress(f)),E(n,"input",f=>e.onInput(f)),E(c,"blur",f=>e.onBlur(f)),E(c,"focus",f=>e.onFocus(f)),E(n,"paste",f=>e.onPaste(f));const C=f=>{const S=f.composedPath()[0];if(!r.contains(S)&&!i.contains(S)){e.isFocused&&e.blur(),e.inputState();return}S==n&&e.isOpen?f.stopPropagation():k(f,!0)},b=()=>{e.isOpen&&e.positionDropdown()};E(document,"mousedown",C),E(window,"scroll",b,u),E(window,"resize",b,u),this._destroy=()=>{document.removeEventListener("mousedown",C),window.removeEventListener("scroll",b),window.removeEventListener("resize",b),p&&p.removeEventListener("click",v)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",e.wrapper),e.sync(!1),s.items=[],delete s.optgroups,delete s.options,E(a,"invalid",()=>{e.isValid&&(e.isValid=!1,e.isInvalid=!0,e.refreshState())}),e.updateOriginalInput(),e.refreshItems(),e.close(!1),e.inputState(),e.isSetup=!0,a.disabled?e.disable():a.readOnly?e.setReadOnly(!0):e.enable(),e.on("change",this.onChange),L(a,"tomselected","ts-hidden-accessible"),e.trigger("initialize"),s.preload===!0&&e.preload()}setupOptions(e=[],s=[]){this.addOptions(e),x(s,n=>{this.registerOptionGroup(n)})}setupTemplates(){var e=this,s=e.settings.labelField,n=e.settings.optgroupLabelField,i={optgroup:o=>{let r=document.createElement("div");return r.className="optgroup",r.appendChild(o.options),r},optgroup_header:(o,r)=>'<div class="optgroup-header">'+r(o[n])+"</div>",option:(o,r)=>"<div>"+r(o[s])+"</div>",item:(o,r)=>"<div>"+r(o[s])+"</div>",option_create:(o,r)=>'<div class="create">Add <strong>'+r(o.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};e.settings.render=Object.assign({},i,e.settings.render)}setupCallbacks(){var e,s,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)s=this.settings[n[e]],s&&this.on(e,s)}sync(e=!0){const s=this,n=e?Oe(s.input,{delimiter:s.settings.delimiter}):s.settings;s.setupOptions(n.options,n.optgroups),s.setValue(n.items||[],!0),s.lastQuery=null}onClick(){var e=this;if(e.activeItems.length>0){e.clearActiveItems(),e.focus();return}e.isFocused&&e.isOpen?e.blur():e.focus()}onMouseDown(){}onChange(){ie(this.input,"input"),ie(this.input,"change")}onPaste(e){var s=this;if(s.isInputHidden||s.isLocked){k(e);return}s.settings.splitOn&&setTimeout(()=>{var n=s.inputValue();if(n.match(s.settings.splitOn)){var i=n.trim().split(s.settings.splitOn);x(i,o=>{F(o)&&(this.options[o]?s.addItem(o):s.createItem(o))})}},0)}onKeyPress(e){var s=this;if(s.isLocked){k(e);return}var n=String.fromCharCode(e.keyCode||e.which);if(s.settings.create&&s.settings.mode==="multi"&&n===s.settings.delimiter){s.createItem(),k(e);return}}onKeyDown(e){var s=this;if(s.ignoreHover=!0,s.isLocked){e.keyCode!==be&&k(e);return}switch(e.keyCode){case Bt:if(j(Q,e)&&s.control_input.value==""){k(e),s.selectAll();return}break;case Kt:s.isOpen&&(k(e,!0),s.close()),s.clearActiveItems();return;case Wt:if(!s.isOpen&&s.hasOptions)s.open();else if(s.activeOption){let n=s.getAdjacent(s.activeOption,1);n&&s.setActiveOption(n)}k(e);return;case Gt:if(s.activeOption){let n=s.getAdjacent(s.activeOption,-1);n&&s.setActiveOption(n)}k(e);return;case zt:s.canSelect(s.activeOption)?(s.onOptionSelect(e,s.activeOption),k(e)):(s.settings.create&&s.createItem()||document.activeElement==s.control_input&&s.isOpen)&&k(e);return;case Qt:s.advanceSelection(-1,e);return;case Ut:s.advanceSelection(1,e);return;case be:s.settings.selectOnTab&&(s.canSelect(s.activeOption)&&(s.onOptionSelect(e,s.activeOption),k(e)),s.settings.create&&s.createItem()&&k(e));return;case ye:case Xt:s.deleteSelection(e);return}s.isInputHidden&&!j(Q,e)&&k(e)}onInput(e){if(this.isLocked)return;const s=this.inputValue();if(this.lastValue!==s){if(this.lastValue=s,s==""){this._onInput();return}this.refreshTimeout&&window.clearTimeout(this.refreshTimeout),this.refreshTimeout=Nt(()=>{this.refreshTimeout=null,this._onInput()},this.settings.refreshThrottle)}}_onInput(){const e=this.lastValue;this.settings.shouldLoad.call(this,e)&&this.load(e),this.refreshOptions(),this.trigger("type",e)}onOptionHover(e,s){this.ignoreHover||this.setActiveOption(s,!1)}onFocus(e){var s=this,n=s.isFocused;if(s.isDisabled||s.isReadOnly){s.blur(),k(e);return}s.ignoreFocus||(s.isFocused=!0,s.settings.preload==="focus"&&s.preload(),n||s.trigger("focus"),s.activeItems.length||(s.inputState(),s.refreshOptions(!!s.settings.openOnFocus)),s.refreshState())}onBlur(e){if(document.hasFocus()!==!1){var s=this;if(s.isFocused){s.isFocused=!1,s.ignoreFocus=!1;var n=()=>{s.close(),s.setActiveItem(),s.setCaret(s.items.length),s.trigger("blur")};s.settings.create&&s.settings.createOnBlur?s.createItem(null,n):n()}}}onOptionSelect(e,s){var n,i=this;s.parentElement&&s.parentElement.matches("[data-disabled]")||(s.classList.contains("create")?i.createItem(null,()=>{i.settings.closeAfterSelect&&i.close()}):(n=s.dataset.value,typeof n<"u"&&(i.lastQuery=null,i.addItem(n),i.settings.closeAfterSelect&&i.close(),!i.settings.hideSelected&&e.type&&/click/.test(e.type)&&i.setActiveOption(s))))}canSelect(e){return!!(this.isOpen&&e&&this.dropdown_content.contains(e))}onItemSelect(e,s){var n=this;return!n.isLocked&&n.settings.mode==="multi"?(k(e),n.setActiveItem(s,e),!0):!1}canLoad(e){return!(!this.settings.load||this.loadedSearches.hasOwnProperty(e))}load(e){const s=this;if(!s.canLoad(e))return;L(s.wrapper,s.settings.loadingClass),s.loading++;const n=s.loadCallback.bind(s);s.settings.load.call(s,e,n)}loadCallback(e,s){const n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(e,s),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||q(n.wrapper,n.settings.loadingClass),n.trigger("load",e,s)}preload(){var e=this.wrapper.classList;e.contains("preloaded")||(e.add("preloaded"),this.load(""))}setTextboxValue(e=""){var s=this.control_input,n=s.value!==e;n&&(s.value=e,ie(s,"update"),this.lastValue=e)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(e,s){var n=s?[]:["change"];fe(this,n,()=>{this.clear(s),this.addItems(e,s)})}setMaxItems(e){e===0&&(e=null),this.settings.maxItems=e,this.refreshState()}setActiveItem(e,s){var n=this,i,o,r,l,a,c;if(n.settings.mode!=="single"){if(!e){n.clearActiveItems(),n.isFocused&&n.inputState();return}if(i=s&&s.type.toLowerCase(),i==="click"&&j("shiftKey",s)&&n.activeItems.length){for(c=n.getLastActive(),r=Array.prototype.indexOf.call(n.control.children,c),l=Array.prototype.indexOf.call(n.control.children,e),r>l&&(a=r,r=l,l=a),o=r;o<=l;o++)e=n.control.children[o],n.activeItems.indexOf(e)===-1&&n.setActiveItemClass(e);k(s)}else i==="click"&&j(Q,s)||i==="keydown"&&j("shiftKey",s)?e.classList.contains("active")?n.removeActiveItem(e):n.setActiveItemClass(e):(n.clearActiveItems(),n.setActiveItemClass(e));n.inputState(),n.isFocused||n.focus()}}setActiveItemClass(e){const s=this,n=s.control.querySelector(".last-active");n&&q(n,"last-active"),L(e,"active last-active"),s.trigger("item_select",e),s.activeItems.indexOf(e)==-1&&s.activeItems.push(e)}removeActiveItem(e){var s=this.activeItems.indexOf(e);this.activeItems.splice(s,1),q(e,"active")}clearActiveItems(){q(this.activeItems,"active"),this.activeItems=[]}setActiveOption(e,s=!0){e!==this.activeOption&&(this.clearActiveOption(),e&&(this.activeOption=e,A(this.focus_node,{"aria-activedescendant":e.getAttribute("id")}),A(e,{"aria-selected":"true"}),L(e,"active"),s&&this.scrollToOption(e)))}scrollToOption(e,s){if(!e)return;const n=this.dropdown_content,i=n.clientHeight,o=n.scrollTop||0,r=e.offsetHeight,l=e.getBoundingClientRect().top-n.getBoundingClientRect().top+o;l+r>i+o?this.scroll(l-i+r,s):l<o&&this.scroll(l,s)}scroll(e,s){const n=this.dropdown_content;s&&(n.style.scrollBehavior=s),n.scrollTop=e,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(q(this.activeOption,"active"),A(this.activeOption,{"aria-selected":null})),this.activeOption=null,A(this.focus_node,{"aria-activedescendant":null})}selectAll(){const e=this;if(e.settings.mode==="single")return;const s=e.controlChildren();s.length&&(e.inputState(),e.close(),e.activeItems=s,x(s,n=>{e.setActiveItemClass(n)}))}inputState(){var e=this;e.control.contains(e.control_input)&&(A(e.control_input,{placeholder:e.settings.placeholder}),e.activeItems.length>0||!e.isFocused&&e.settings.hidePlaceholder&&e.items.length>0?(e.setTextboxValue(),e.isInputHidden=!0):(e.settings.hidePlaceholder&&e.items.length>0&&A(e.control_input,{placeholder:""}),e.isInputHidden=!1),e.wrapper.classList.toggle("input-hidden",e.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var e=this;e.isDisabled||e.isReadOnly||(e.ignoreFocus=!0,e.control_input.offsetWidth?e.control_input.focus():e.focus_node.focus(),setTimeout(()=>{e.ignoreFocus=!1,e.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}getSearchOptions(){var e=this.settings,s=e.sortField;return typeof e.sortField=="string"&&(s=[{field:e.sortField}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:s,nesting:e.nesting}}search(e){var s,n,i=this,o=this.getSearchOptions();if(i.settings.score&&(n=i.settings.score.call(i,e),typeof n!="function"))throw new Error('Tom Select "score" setting must be a function that returns a function');return e!==i.lastQuery?(i.lastQuery=e,s=i.sifter.search(e,Object.assign(o,{score:n})),i.currentResults=s):s=Object.assign({},i.currentResults),i.settings.hideSelected&&(s.items=s.items.filter(r=>{let l=F(r.id);return!(l&&i.items.indexOf(l)!==-1)})),s}refreshOptions(e=!0){var s,n,i,o,r,l,a,c,u,d;const h={},O=[];var p=this,v=p.inputValue();const C=v===p.lastQuery||v==""&&p.lastQuery==null;var b=p.search(v),f=null,S=p.settings.shouldOpen||!1,$=p.dropdown_content;C&&(f=p.activeOption,f&&(u=f.closest("[data-group]"))),o=b.items.length,typeof p.settings.maxOptions=="number"&&(o=Math.min(o,p.settings.maxOptions)),o>0&&(S=!0);const M=(m,y)=>{let g=h[m];if(g!==void 0){let w=O[g];if(w!==void 0)return[g,w.fragment]}let _=document.createDocumentFragment();return g=O.length,O.push({fragment:_,order:y,optgroup:m}),[g,_]};for(s=0;s<o;s++){let m=b.items[s];if(!m)continue;let y=m.id,g=p.options[y];if(g===void 0)continue;let _=U(y),w=p.getOption(_,!0);for(p.settings.hideSelected||w.classList.toggle("selected",p.items.includes(_)),r=g[p.settings.optgroupField]||"",l=Array.isArray(r)?r:[r],n=0,i=l&&l.length;n<i;n++){r=l[n];let V=g.$order,B=p.optgroups[r];B===void 0?r="":V=B.$order;const[De,Re]=M(r,V);n>0&&(w=w.cloneNode(!0),A(w,{id:g.$id+"-clone-"+n,"aria-selected":null}),w.classList.add("ts-cloned"),q(w,"active"),p.activeOption&&p.activeOption.dataset.value==y&&u&&u.dataset.group===r.toString()&&(f=w)),Re.appendChild(w),r!=""&&(h[r]=De)}}p.settings.lockOptgroupOrder&&O.sort((m,y)=>m.order-y.order),a=document.createDocumentFragment(),x(O,m=>{let y=m.fragment,g=m.optgroup;if(!y||!y.children.length)return;let _=p.optgroups[g];if(_!==void 0){let w=document.createDocumentFragment(),V=p.render("optgroup_header",_);N(w,V),N(w,y);let B=p.render("optgroup",{group:_,options:w});N(a,B)}else N(a,y)}),$.innerHTML="",N($,a),p.settings.highlight&&(Vt($),b.query.length&&b.tokens.length&&x(b.tokens,m=>{Mt($,m.regex)}));var P=m=>{let y=p.render(m,{input:v});return y&&(S=!0,$.insertBefore(y,$.firstChild)),y};if(p.loading?P("loading"):p.settings.shouldLoad.call(p,v)?b.items.length===0&&P("no_results"):P("not_loading"),c=p.canCreate(v),c&&(d=P("option_create")),p.hasOptions=b.items.length>0||c,S){if(b.items.length>0){if(!f&&p.settings.mode==="single"&&p.items[0]!=null&&(f=p.getOption(p.items[0])),!$.contains(f)){let m=0;d&&!p.settings.addPrecedence&&(m=1),f=p.selectable()[m]}}else d&&(f=d);e&&!p.isOpen&&(p.open(),p.scrollToOption(f,"auto")),p.setActiveOption(f)}else p.clearActiveOption(),e&&p.isOpen&&p.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(e,s=!1){const n=this;if(Array.isArray(e))return n.addOptions(e,s),!1;const i=F(e[n.settings.valueField]);return i===null||n.options.hasOwnProperty(i)?!1:(e.$order=e.$order||++n.order,e.$id=n.inputId+"-opt-"+e.$order,n.options[i]=e,n.lastQuery=null,s&&(n.userOptions[i]=s,n.trigger("option_add",i,e)),i)}addOptions(e,s=!1){x(e,n=>{this.addOption(n,s)})}registerOption(e){return this.addOption(e)}registerOptionGroup(e){var s=F(e[this.settings.optgroupValueField]);return s===null?!1:(e.$order=e.$order||++this.order,this.optgroups[s]=e,s)}addOptionGroup(e,s){var n;s[this.settings.optgroupValueField]=e,(n=this.registerOptionGroup(s))&&this.trigger("optgroup_add",n,s)}removeOptionGroup(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(e,s){const n=this;var i,o;const r=F(e),l=F(s[n.settings.valueField]);if(r===null)return;const a=n.options[r];if(a==null)return;if(typeof l!="string")throw new Error("Value must be set in option data");const c=n.getOption(r),u=n.getItem(r);if(s.$order=s.$order||a.$order,delete n.options[r],n.uncacheValue(l),n.options[l]=s,c){if(n.dropdown_content.contains(c)){const d=n._render("option",s);le(c,d),n.activeOption===c&&n.setActiveOption(d)}c.remove()}u&&(o=n.items.indexOf(r),o!==-1&&n.items.splice(o,1,l),i=n._render("item",s),u.classList.contains("active")&&L(i,"active"),le(u,i)),n.lastQuery=null}removeOption(e,s){const n=this;e=U(e),n.uncacheValue(e),delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,s)}clearOptions(e){const s=(e||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();const n={};x(this.options,(i,o)=>{s(i,o)&&(n[o]=i)}),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(e,s){return this.items.indexOf(s)>=0}getOption(e,s=!1){const n=F(e);if(n===null)return null;const i=this.options[n];if(i!=null){if(i.$div)return i.$div;if(s)return this._render("option",i)}return null}getAdjacent(e,s,n="option"){var i=this,o;if(!e)return null;n=="item"?o=i.controlChildren():o=i.dropdown_content.querySelectorAll("[data-selectable]");for(let r=0;r<o.length;r++)if(o[r]==e)return s>0?o[r+1]:o[r-1];return null}getItem(e){if(typeof e=="object")return e;var s=F(e);return s!==null?this.control.querySelector(`[data-value="${ge(s)}"]`):null}addItems(e,s){var n=this,i=Array.isArray(e)?e:[e];i=i.filter(r=>n.items.indexOf(r)===-1);const o=i[i.length-1];i.forEach(r=>{n.isPending=r!==o,n.addItem(r,s)})}addItem(e,s){var n=s?[]:["change","dropdown_close"];fe(this,n,()=>{var i,o;const r=this,l=r.settings.mode,a=F(e);if(!(a&&r.items.indexOf(a)!==-1&&(l==="single"&&r.close(),l==="single"||!r.settings.duplicates))&&!(a===null||!r.options.hasOwnProperty(a))&&(l==="single"&&r.clear(s),!(l==="multi"&&r.isFull()))){if(i=r._render("item",r.options[a]),r.control.contains(i)&&(i=i.cloneNode(!0)),o=r.isFull(),r.items.splice(r.caretPos,0,a),r.insertAtCaret(i),r.isSetup){if(!r.isPending&&r.settings.hideSelected){let c=r.getOption(a),u=r.getAdjacent(c,1);u&&r.setActiveOption(u)}!r.isPending&&!r.settings.closeAfterSelect&&r.refreshOptions(r.isFocused&&l!=="single"),r.settings.closeAfterSelect!=!1&&r.isFull()?r.close():r.isPending||r.positionDropdown(),r.trigger("item_add",a,i),r.isPending||r.updateOriginalInput({silent:s})}(!r.isPending||!o&&r.isFull())&&(r.inputState(),r.refreshState())}})}removeItem(e=null,s){const n=this;if(e=n.getItem(e),!e)return;var i,o;const r=e.dataset.value;i=ve(e),e.remove(),e.classList.contains("active")&&(o=n.activeItems.indexOf(e),n.activeItems.splice(o,1),q(e,"active")),n.items.splice(i,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(r)&&n.removeOption(r,s),i<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:s}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",r,e)}createItem(e=null,s=()=>{}){arguments.length===3&&(s=arguments[2]),typeof s!="function"&&(s=()=>{});var n=this,i=n.caretPos,o;if(e=e||n.inputValue(),!n.canCreate(e))return s(),!1;n.lock();var r=!1,l=a=>{if(n.unlock(),!a||typeof a!="object")return s();var c=F(a[n.settings.valueField]);if(typeof c!="string")return s();n.setTextboxValue(),n.addOption(a,!0),n.setCaret(i),n.addItem(c),s(a),r=!0};return typeof n.settings.create=="function"?o=n.settings.create.call(this,e,l):o={[n.settings.labelField]:e,[n.settings.valueField]:e},r||l(o),!0}refreshItems(){var e=this;e.lastQuery=null,e.isSetup&&e.addItems(e.items),e.updateOriginalInput(),e.refreshState()}refreshState(){const e=this;e.refreshValidityState();const s=e.isFull(),n=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);const i=e.wrapper.classList;i.toggle("focus",e.isFocused),i.toggle("disabled",e.isDisabled),i.toggle("readonly",e.isReadOnly),i.toggle("required",e.isRequired),i.toggle("invalid",!e.isValid),i.toggle("locked",n),i.toggle("full",s),i.toggle("input-active",e.isFocused&&!e.isInputHidden),i.toggle("dropdown-active",e.isOpen),i.toggle("has-options",Rt(e.options)),i.toggle("has-items",e.items.length>0)}refreshValidityState(){var e=this;e.input.validity&&(e.isValid=e.input.validity.valid,e.isInvalid=!e.isValid)}isFull(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems}updateOriginalInput(e={}){const s=this;var n,i;const o=s.input.querySelector('option[value=""]');if(s.is_select_tag){let r=function(c,u,d){return c||(c=T('<option value="'+se(u)+'">'+se(d)+"</option>")),c!=o&&s.input.append(c),l.push(c),(c!=o||a>0)&&(c.selected=!0),c};const l=[],a=s.input.querySelectorAll("option:checked").length;s.input.querySelectorAll("option:checked").forEach(c=>{c.selected=!1}),s.items.length==0&&s.settings.mode=="single"?r(o,"",""):s.items.forEach(c=>{if(n=s.options[c],i=n[s.settings.labelField]||"",l.includes(n.$option)){const u=s.input.querySelector(`option[value="${ge(c)}"]:not(:checked)`);r(u,c,i)}else n.$option=r(n.$option,c,i)})}else s.input.value=s.getValue();s.isSetup&&(e.silent||s.trigger("change",s.getValue()))}open(){var e=this;e.isLocked||e.isOpen||e.settings.mode==="multi"&&e.isFull()||(e.isOpen=!0,A(e.focus_node,{"aria-expanded":"true"}),e.refreshState(),K(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),K(e.dropdown,{visibility:"visible",display:"block"}),e.focus(),e.trigger("dropdown_open",e.dropdown))}close(e=!0){var s=this,n=s.isOpen;e&&(s.setTextboxValue(),s.settings.mode==="single"&&s.items.length&&s.inputState()),s.isOpen=!1,A(s.focus_node,{"aria-expanded":"false"}),K(s.dropdown,{display:"none"}),s.settings.hideSelected&&s.clearActiveOption(),s.refreshState(),n&&s.trigger("dropdown_close",s.dropdown)}positionDropdown(){if(this.settings.dropdownParent==="body"){var e=this.control,s=e.getBoundingClientRect(),n=e.offsetHeight+s.top+window.scrollY,i=s.left+window.scrollX;K(this.dropdown,{width:s.width+"px",top:n+"px",left:i+"px"})}}clear(e){var s=this;if(s.items.length){var n=s.controlChildren();x(n,i=>{s.removeItem(i,!0)}),s.inputState(),e||s.updateOriginalInput(),s.trigger("clear")}}insertAtCaret(e){const s=this,n=s.caretPos,i=s.control;i.insertBefore(e,i.children[n]||null),s.setCaret(n+1)}deleteSelection(e){var s,n,i,o,r=this;s=e&&e.keyCode===ye?-1:1,n=Ht(r.control_input);const l=[];if(r.activeItems.length)o=me(r.activeItems,s),i=ve(o),s>0&&i++,x(r.activeItems,a=>l.push(a));else if((r.isFocused||r.settings.mode==="single")&&r.items.length){const a=r.controlChildren();let c;s<0&&n.start===0&&n.length===0?c=a[r.caretPos-1]:s>0&&n.start===r.inputValue().length&&(c=a[r.caretPos]),c!==void 0&&l.push(c)}if(!r.shouldDelete(l,e))return!1;for(k(e,!0),typeof i<"u"&&r.setCaret(i);l.length;)r.removeItem(l.pop());return r.inputState(),r.positionDropdown(),r.refreshOptions(!1),!0}shouldDelete(e,s){const n=e.map(i=>i.dataset.value);return!(!n.length||typeof this.settings.onDelete=="function"&&this.settings.onDelete(n,s)===!1)}advanceSelection(e,s){var n,i,o=this;o.rtl&&(e*=-1),!o.inputValue().length&&(j(Q,s)||j("shiftKey",s)?(n=o.getLastActive(e),n?n.classList.contains("active")?i=o.getAdjacent(n,e,"item"):i=n:e>0?i=o.control_input.nextElementSibling:i=o.control_input.previousElementSibling,i&&(i.classList.contains("active")&&o.removeActiveItem(n),o.setActiveItemClass(i))):o.moveCaret(e))}moveCaret(e){}getLastActive(e){let s=this.control.querySelector(".last-active");if(s)return s;var n=this.control.querySelectorAll(".active");if(n)return me(n,e)}setCaret(e){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(e=this.isReadOnly||this.isDisabled){this.isLocked=e,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(e){this.focus_node.tabIndex=e?-1:this.tabIndex,this.isDisabled=e,this.input.disabled=e,this.control_input.disabled=e,this.setLocked()}setReadOnly(e){this.isReadOnly=e,this.input.readOnly=e,this.control_input.readOnly=e,this.setLocked()}destroy(){var e=this,s=e.revertSettings;e.trigger("destroy"),e.off(),e.wrapper.remove(),e.dropdown.remove(),e.input.innerHTML=s.innerHTML,e.input.tabIndex=s.tabIndex,q(e.input,"tomselected","ts-hidden-accessible"),e._destroy(),delete e.input.tomselect}render(e,s){var n,i;const o=this;if(typeof this.settings.render[e]!="function"||(i=o.settings.render[e].call(this,s,se),!i))return null;if(i=T(i),e==="option"||e==="option_create"?s[o.settings.disabledField]?A(i,{"aria-disabled":"true"}):A(i,{"data-selectable":""}):e==="optgroup"&&(n=s.group[o.settings.optgroupValueField],A(i,{"data-group":n}),s.group[o.settings.disabledField]&&A(i,{"data-disabled":""})),e==="option"||e==="item"){const r=U(s[o.settings.valueField]);A(i,{"data-value":r}),e==="item"?(L(i,o.settings.itemClass),A(i,{"data-ts-item":""})):(L(i,o.settings.optionClass),A(i,{role:"option",id:s.$id}),s.$div=i,o.options[r]=s)}return i}_render(e,s){const n=this.render(e,s);if(n==null)throw"HTMLElement expected";return n}clearCache(){x(this.options,e=>{e.$div&&(e.$div.remove(),delete e.$div)})}uncacheValue(e){const s=this.getOption(e);s&&s.remove()}canCreate(e){return this.settings.create&&e.length>0&&this.settings.createFilter.call(this,e)}hook(e,s,n){var i=this,o=i[s];i[s]=function(){var r,l;return e==="after"&&(r=o.apply(i,arguments)),l=n.apply(i,arguments),e==="instead"?l:(e==="before"&&(r=o.apply(i,arguments)),r)}}}const Yt=(t,e,s,n)=>{t.addEventListener(e,s,n)};function Zt(){Yt(this.input,"change",()=>{this.sync()})}const es=t=>typeof t>"u"||t===null?null:ts(t),ts=t=>typeof t=="boolean"?t?"1":"0":t+"",Ae=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},ss=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(ns(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},ns=t=>typeof t=="string"&&t.indexOf("<")>-1;function is(t){var e=this,s=e.onOptionSelect;e.settings.hideSelected=!1;const n=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},t);var i=function(r,l){l?(r.checked=!0,n.uncheckedClassNames&&r.classList.remove(...n.uncheckedClassNames),n.checkedClassNames&&r.classList.add(...n.checkedClassNames)):(r.checked=!1,n.checkedClassNames&&r.classList.remove(...n.checkedClassNames),n.uncheckedClassNames&&r.classList.add(...n.uncheckedClassNames))},o=function(r){setTimeout(()=>{var l=r.querySelector("input."+n.className);l instanceof HTMLInputElement&&i(l,r.classList.contains("selected"))},1)};e.hook("after","setupTemplates",()=>{var r=e.settings.render.option;e.settings.render.option=(l,a)=>{var c=ss(r.call(e,l,a)),u=document.createElement("input");n.className&&u.classList.add(n.className),u.addEventListener("click",function(h){Ae(h)}),u.type="checkbox";const d=es(l[e.settings.valueField]);return i(u,!!(d&&e.items.indexOf(d)>-1)),c.prepend(u),c}}),e.on("item_remove",r=>{var l=e.getOption(r);l&&(l.classList.remove("selected"),o(l))}),e.on("item_add",r=>{var l=e.getOption(r);l&&o(l)}),e.hook("instead","onOptionSelect",(r,l)=>{if(l.classList.contains("selected")){l.classList.remove("selected"),e.removeItem(l.dataset.value),e.refreshOptions(),Ae(r,!0);return}s.call(e,r,l),o(l)})}const rs=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(os(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},os=t=>typeof t=="string"&&t.indexOf("<")>-1;function ls(t){const e=this,s=Object.assign({className:"clear-button",title:"Clear All",html:n=>`<div class="${n.className}" title="${n.title}">&#10799;</div>`},t);e.on("initialize",()=>{var n=rs(s.html(s));n.addEventListener("click",i=>{e.isLocked||(e.clear(),e.settings.mode==="single"&&e.settings.allowEmptyOption&&e.addItem(""),i.preventDefault(),i.stopPropagation())}),e.control.appendChild(n)})}const as=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},H=(t,e,s,n)=>{t.addEventListener(e,s,n)},cs=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},ds=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(us(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},us=t=>typeof t=="string"&&t.indexOf("<")>-1,ps=(t,e)=>{cs(e,(s,n)=>{s==null?t.removeAttribute(n):t.setAttribute(n,""+s)})},hs=(t,e)=>{var s;(s=t.parentNode)==null||s.insertBefore(e,t.nextSibling)},fs=(t,e)=>{var s;(s=t.parentNode)==null||s.insertBefore(e,t)},gs=(t,e)=>{do{var s;if(e=(s=e)==null?void 0:s.previousElementSibling,t==e)return!0}while(e&&e.previousElementSibling);return!1};function ms(){var t=this;if(t.settings.mode!=="multi")return;var e=t.lock,s=t.unlock;let n=!0,i;t.hook("after","setupTemplates",()=>{var o=t.settings.render.item;t.settings.render.item=(r,l)=>{const a=ds(o.call(t,r,l));ps(a,{draggable:"true"});const c=v=>{n||as(v),v.stopPropagation()},u=v=>{i=a,setTimeout(()=>{a.classList.add("ts-dragging")},0)},d=v=>{v.preventDefault(),a.classList.add("ts-drag-over"),O(a,i)},h=()=>{a.classList.remove("ts-drag-over")},O=(v,C)=>{C!==void 0&&(gs(C,a)?hs(v,C):fs(v,C))},p=()=>{var v;document.querySelectorAll(".ts-drag-over").forEach(b=>b.classList.remove("ts-drag-over")),(v=i)==null||v.classList.remove("ts-dragging"),i=void 0;var C=[];t.control.querySelectorAll("[data-value]").forEach(b=>{if(b.dataset.value){let f=b.dataset.value;f&&C.push(f)}}),t.setValue(C)};return H(a,"mousedown",c),H(a,"dragstart",u),H(a,"dragenter",d),H(a,"dragover",d),H(a,"dragleave",h),H(a,"dragend",p),a}}),t.hook("instead","lock",()=>(n=!1,e.call(t))),t.hook("instead","unlock",()=>(n=!0,s.call(t)))}const vs=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},ys=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(bs(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},bs=t=>typeof t=="string"&&t.indexOf("<")>-1;function ws(t){const e=this,s=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:n=>'<div class="'+n.headerClass+'"><div class="'+n.titleRowClass+'"><span class="'+n.labelClass+'">'+n.title+'</span><a class="'+n.closeClass+'">&times;</a></div></div>'},t);e.on("initialize",()=>{var n=ys(s.html(s)),i=n.querySelector("."+s.closeClass);i&&i.addEventListener("click",o=>{vs(o,!0),e.close()}),e.dropdown.insertBefore(n,e.dropdown.firstChild)})}const Os=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},Cs=(t,...e)=>{var s=As(e);t=Ss(t),t.map(n=>{s.map(i=>{n.classList.remove(i)})})},As=t=>{var e=[];return Os(t,s=>{typeof s=="string"&&(s=s.trim().split(/[\t\n\f\r\s]/)),Array.isArray(s)&&(e=e.concat(s))}),e.filter(Boolean)},Ss=t=>(Array.isArray(t)||(t=[t]),t),ks=(t,e)=>{if(!t)return-1;e=e||t.nodeName;for(var s=0;t=t.previousElementSibling;)t.matches(e)&&s++;return s};function xs(){var t=this;t.hook("instead","setCaret",e=>{t.settings.mode==="single"||!t.control.contains(t.control_input)?e=t.items.length:(e=Math.max(0,Math.min(t.items.length,e)),e!=t.caretPos&&!t.isPending&&t.controlChildren().forEach((s,n)=>{n<e?t.control_input.insertAdjacentElement("beforebegin",s):t.control.appendChild(s)})),t.caretPos=e}),t.hook("instead","moveCaret",e=>{if(!t.isFocused)return;const s=t.getLastActive(e);if(s){const n=ks(s);t.setCaret(e>0?n+1:n),t.setActiveItem(),Cs(s,"last-active")}else t.setCaret(t.caretPos+e)})}const _s=27,Es=9,Is=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},Ls=(t,e,s,n)=>{t.addEventListener(e,s,n)},Fs=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},Se=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if($s(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},$s=t=>typeof t=="string"&&t.indexOf("<")>-1,Ts=(t,...e)=>{var s=qs(e);t=js(t),t.map(n=>{s.map(i=>{n.classList.add(i)})})},qs=t=>{var e=[];return Fs(t,s=>{typeof s=="string"&&(s=s.trim().split(/[\t\n\f\r\s]/)),Array.isArray(s)&&(e=e.concat(s))}),e.filter(Boolean)},js=t=>(Array.isArray(t)||(t=[t]),t);function Ns(){const t=this;t.settings.shouldOpen=!0,t.hook("before","setup",()=>{t.focus_node=t.control,Ts(t.control_input,"dropdown-input");const e=Se('<div class="dropdown-input-wrap">');e.append(t.control_input),t.dropdown.insertBefore(e,t.dropdown.firstChild);const s=Se('<input class="items-placeholder" tabindex="-1" />');s.placeholder=t.settings.placeholder||"",t.control.append(s)}),t.on("initialize",()=>{t.control_input.addEventListener("keydown",s=>{switch(s.keyCode){case _s:t.isOpen&&(Is(s,!0),t.close()),t.clearActiveItems();return;case Es:t.focus_node.tabIndex=-1;break}return t.onKeyDown.call(t,s)}),t.on("blur",()=>{t.focus_node.tabIndex=t.isDisabled?-1:t.tabIndex}),t.on("dropdown_open",()=>{t.control_input.focus()});const e=t.onBlur;t.hook("instead","onBlur",s=>{if(!(s&&s.relatedTarget==t.control_input))return e.call(t)}),Ls(t.control_input,"blur",()=>t.onBlur()),t.hook("before","close",()=>{t.isOpen&&t.focus_node.focus({preventScroll:!0})})})}const G=(t,e,s,n)=>{t.addEventListener(e,s,n)};function Ps(){var t=this;t.on("initialize",()=>{var e=document.createElement("span"),s=t.control_input;e.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",t.wrapper.appendChild(e);var n=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const o of n)e.style[o]=s.style[o];var i=()=>{e.textContent=s.value,s.style.width=e.clientWidth+"px"};i(),t.on("update item_add item_remove",i),G(s,"input",i),G(s,"keyup",i),G(s,"blur",i),G(s,"update",i)})}function Hs(){var t=this,e=t.deleteSelection;this.hook("instead","deleteSelection",s=>t.activeItems.length?e.call(t,s):!1)}function Ds(){this.hook("instead","setActiveItem",()=>{}),this.hook("instead","selectAll",()=>{})}const ke=37,Rs=39,Ms=(t,e,s)=>{for(;t&&t.matches;){if(t.matches(e))return t;t=t.parentNode}},Vs=(t,e)=>{if(!t)return-1;e=e||t.nodeName;for(var s=0;t=t.previousElementSibling;)t.matches(e)&&s++;return s};function Bs(){var t=this,e=t.onKeyDown;t.hook("instead","onKeyDown",s=>{var n,i,o,r;if(!t.isOpen||!(s.keyCode===ke||s.keyCode===Rs))return e.call(t,s);t.ignoreHover=!0,r=Ms(t.activeOption,"[data-group]"),n=Vs(t.activeOption,"[data-selectable]"),r&&(s.keyCode===ke?r=r.previousSibling:r=r.nextSibling,r&&(o=r.querySelectorAll("[data-selectable]"),i=o[Math.min(o.length-1,n)],i&&t.setActiveOption(i)))})}const zs=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),xe=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},_e=(t,e,s,n)=>{t.addEventListener(e,s,n)},Ee=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(Ks(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},Ks=t=>typeof t=="string"&&t.indexOf("<")>-1;function Qs(t){const e=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},t);var s=this;if(e.append){var n='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+zs(e.title)+'">'+e.label+"</a>";s.hook("after","setupTemplates",()=>{var i=s.settings.render.item;s.settings.render.item=(o,r)=>{var l=Ee(i.call(s,o,r)),a=Ee(n);return l.appendChild(a),_e(a,"mousedown",c=>{xe(c,!0)}),_e(a,"click",c=>{s.isLocked||(xe(c,!0),!s.isLocked&&s.shouldDelete([l],c)&&(s.removeItem(l),s.refreshOptions(!1),s.inputState()))}),l}})}}function Gs(t){const e=this,s=Object.assign({text:n=>n[e.settings.labelField]},t);e.on("item_remove",function(n){if(e.isFocused&&e.control_input.value.trim()===""){var i=e.options[n];i&&e.setTextboxValue(s.text.call(e,i))}})}const Us=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var s in t)t.hasOwnProperty(s)&&e(t[s],s)},Ws=(t,...e)=>{var s=Xs(e);t=Js(t),t.map(n=>{s.map(i=>{n.classList.add(i)})})},Xs=t=>{var e=[];return Us(t,s=>{typeof s=="string"&&(s=s.trim().split(/[\t\n\f\r\s]/)),Array.isArray(s)&&(e=e.concat(s))}),e.filter(Boolean)},Js=t=>(Array.isArray(t)||(t=[t]),t);function Ys(){const t=this,e=t.canLoad,s=t.clearActiveOption,n=t.loadCallback;var i={},o,r=!1,l,a=[];if(t.settings.shouldLoadMore||(t.settings.shouldLoadMore=()=>{if(o.clientHeight/(o.scrollHeight-o.scrollTop)>.9)return!0;if(t.activeOption){var d=t.selectable(),h=Array.from(d).indexOf(t.activeOption);if(h>=d.length-2)return!0}return!1}),!t.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";t.settings.sortField=[{field:"$order"},{field:"$score"}];const c=d=>typeof t.settings.maxOptions=="number"&&o.children.length>=t.settings.maxOptions?!1:!!(d in i&&i[d]),u=(d,h)=>t.items.indexOf(h)>=0||a.indexOf(h)>=0;t.setNextUrl=(d,h)=>{i[d]=h},t.getUrl=d=>{if(d in i){const h=i[d];return i[d]=!1,h}return t.clearPagination(),t.settings.firstUrl.call(t,d)},t.clearPagination=()=>{i={}},t.hook("instead","clearActiveOption",()=>{if(!r)return s.call(t)}),t.hook("instead","canLoad",d=>d in i?c(d):e.call(t,d)),t.hook("instead","loadCallback",(d,h)=>{if(!r)t.clearOptions(u);else if(l){const O=d[0];O!==void 0&&(l.dataset.value=O[t.settings.valueField])}n.call(t,d,h),r=!1}),t.hook("after","refreshOptions",()=>{const d=t.lastValue;var h;c(d)?(h=t.render("loading_more",{query:d}),h&&(h.setAttribute("data-selectable",""),l=h)):d in i&&!o.querySelector(".no-results")&&(h=t.render("no_more_results",{query:d})),h&&(Ws(h,t.settings.optionClass),o.append(h))}),t.on("initialize",()=>{a=Object.keys(t.options),o=t.dropdown_content,t.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},t.settings.render),o.addEventListener("scroll",()=>{t.settings.shouldLoadMore.call(t)&&c(t.lastValue)&&(r||(r=!0,t.load.call(t,t.lastValue)))})})}I.define("change_listener",Zt);I.define("checkbox_options",is);I.define("clear_button",ls);I.define("drag_drop",ms);I.define("dropdown_header",ws);I.define("caret_position",xs);I.define("dropdown_input",Ns);I.define("input_autogrow",Ps);I.define("no_backspace_delete",Hs);I.define("no_active_items",Ds);I.define("optgroup_columns",Bs);I.define("remove_button",Qs);I.define("restore_on_backspace",Gs);I.define("virtual_scroll",Ys);const Zs=t=>({init(){const e=this.$refs[`select_picker_${t.dataField}_${t.tableName}`],s={items:t.initialValues,...t.framework,onChange:o=>{Fe(t,o)},onInitialize:()=>{t.appliedFilters&&t.dataField&&this.applyFilterForDataField(t.appliedFilters,t.dataField,e),window.addEventListener(`pg:clear_multi_select::${t.tableName}:${t.dataField}`,()=>{e&&e.tomselect.clear(!0)}),window.addEventListener(`pg:clear_all_multi_select::${t.tableName}`,()=>{e&&e.tomselect.clear(!0)})}},n={valueField:t.optionValue,labelField:t.optionLabel,searchField:t.optionLabel,load:async function(o,r){function l(a,c){var u;const{method:d,url:h}=a,O=new Request(h,{method:d,body:d.toLowerCase()==="post"?JSON.stringify({search:c,...i}):void 0});O.headers.set("Content-Type","application/json"),O.headers.set("Accept","application/json"),O.headers.set("X-Requested-With","XMLHttpRequest");const p=(u=document.head.querySelector('[name="csrf-token"]'))==null?void 0:u.getAttribute("content");return p&&O.headers.set("X-CSRF-TOKEN",p),O}fetch(l(t.asyncData,o)).then(a=>a.json()).then(a=>{r(a)}).catch(()=>{r()})},render:{option:function(o,r){return`<div class="py-2 mb-1"><span>${r(o[t.optionLabel])}</span></div>`},item:function(o,r){return`<div class="py-2 mb-1"><span>${r(o[t.optionLabel])}</span></div>`}}};let i=s;t.hasOwnProperty("asyncData")&&(i=Object.assign(s,n)),new I(e,i)},applyFilterForDataField(e,s,n){const i=s.split(".");let o=e;for(const r of i)if(o&&typeof o=="object"&&o.hasOwnProperty(r))o=o[r];else return;Array.isArray(o)&&o.length>0&&n.tomselect.addItems(o)}}),en=t=>({initialValues:t.initialValues,framework:t.framework,init(){const e=this.$refs["select_picker_"+t.dataField+"_"+t.tableName],s=this.deepCopy(this.framework);new window.SlimSelect({select:e,...s,events:{afterChange:n=>{let i=n.map(o=>o.value);Fe(t,i)}}}),t.appliedFilters&&t.dataField&&this.applyFilterForDataField(t.appliedFilters,t.dataField,e),window.addEventListener("pg:clear_multi_select::"+t.tableName+":"+t.dataField,()=>{e.slim.setSelected([],!1)}),window.addEventListener("pg:clear_all_multi_select::"+t.tableName,()=>{e.slim.setSelected([],!1)})},applyFilterForDataField(e,s,n){const i=s.split(".");let o=e;for(const r of i)if(o&&typeof o=="object"&&o.hasOwnProperty(r))o=o[r];else return;Array.isArray(o)&&o.length>0&&n.slim.setSelected(o,!1)},deepCopy(e){if(e===null||typeof e!="object")return e;if(Array.isArray(e))return e.map(this.deepCopy);const s={};for(const n in e)e.hasOwnProperty(n)&&(s[n]=this.deepCopy(e[n]));return s}}),tn=()=>({init(){Livewire.on("pg:scrollTop",t=>{setTimeout(()=>{document.querySelector("body").scrollIntoView({behavior:"auto"})},0)}),new IntersectionObserver(t=>{t[0].isIntersecting&&this.$wire.call("loadMore")},{rootMargin:"300px"}).observe(this.$el)}}),sn=t=>({rowId:(t==null?void 0:t.rowId)??null,parentId:(t==null?void 0:t.parentId)??null,toHtml(){let e=null;const s=this.parentId??this.$wire.id;if(this.rowId){const i=window[`pgActions_${s}`];i&&i[this.rowId]!==void 0&&(e=i[this.rowId])}else e=window[`pgActionsHeader_${s}`];if(typeof e!="object"||e===null)return"";let n="";return e.forEach(i=>{let o=this.shouldHideAction(i),r=this.getReplaceHtml(i);if(!o)if(r)n+=r;else{let l=this.buildAttributesString(i);if(i.icon){let a=this.processIcon(i);if(!a)return;n+=this.buildActionHtmlWithIcon(i,l,a)}else n+=this.buildActionHtml(i,l)}}),n},shouldHideAction(e){if(e.can===!1)return!0;let s=!1;return e.rules&&Object.values(e.rules).length>0&&Object.values(e.rules).forEach(n=>{n.action.includes(e.action)&&n.apply&&n.rule.hide&&(s=!0)}),s},getReplaceHtml(e){let s=null;return e.rules&&Object.values(e.rules).length>0&&Object.values(e.rules).forEach(n=>{n.apply&&n.action.includes(e.action)&&n.replaceHtml&&(s=n.replaceHtml)}),s},buildAttributesString(e){let s=e.attributes??[];return e.rules&&Object.values(e.rules).length>0&&Object.values(e.rules).forEach(n=>{n.apply&&n.action.includes(e.action)&&n.rule.setAttribute&&n.rule.setAttribute.length>0&&Object.values(n.rule.setAttribute).forEach(i=>{s[i.attribute]=i.value})}),Object.entries(s).map(([n,i])=>` ${n}="${i}"`).join("")},processIcon(e){const s=Object.entries(e.iconAttributes??[]).map(([i,o])=>` ${i}="${o}"`).join("");let n=window.pgResourceIcons[e.icon];return typeof n>"u"?(console.warn(`PowerGrid: Unable to load icons in javascript window in row: [${this.rowId}]`),null):this.replaceIconAttributes(n,s)},replaceIconAttributes(e,s){return e.replace(/<([^\s>]+)([^>]*)>/,(n,i,o)=>{let r=o.trim();const l=s.replace(/class="([^"]*)"/,(a,c)=>(r.includes("class=")?r=r.replace(/class="([^"]*)"/,(u,d)=>`class="${d} ${c.trim()}"`):r+=` ${a}`,""));return`<${i} ${r} ${l}>`})},buildActionHtmlWithIcon(e,s,n){return e.slot?`<${e.tag??"button"} ${s}>${n} ${e.slot}</${e.tag??"button"}>`:`<${e.tag??"button"} ${s}>${n}</${e.tag??"button"}>`},buildActionHtml(e,s){return`<${e.tag??"button"} ${s}>${e.slot}</${e.tag??"button"}>`}}),nn=t=>({templateContent:(t==null?void 0:t.templateContent)??null,rendered:null,parentId:(t==null?void 0:t.parentId)??null,init(){const e=Object.keys(this.templateContent)[0],s=window[`pgRowTemplates_${this.parentId??this.$wire.id}`][e],n=this.templateContent[e];if(n){let i=s;for(const[o,r]of Object.entries(n)){const l=`{{ ${o} }}`,a=String(r).replace(/'/g,"\\'");i=i.replaceAll(l,a)}this.rendered=i}}}),rn=t=>({rowId:t.rowId,rules:t.rules,defaultClasses:t.defaultClasses,attributes:[],theme:[],init(){this.rules&&Object.values(this.rules).forEach(e=>{(e.applyLoop||e.apply)&&e!=null&&e.attributes&&this.attributes.push(e.attributes)})},getAttributes(){let e={class:this.defaultClasses};return this.attributes.forEach(s=>{Object.keys(s).forEach(n=>{typeof s[n]=="object"?e[s[n].key]=s[n].value:e[n]+=e[n]?` ${s[n]}`:s[n]})}),e}});window.pgToggleable=st;window.pgFlatpickr=it;window.pgEditable=rt;window.pgResponsive=pt;window.pgTomSelect=Zs;window.pgSlimSelect=en;window.pgLoadMore=tn;window.pgRenderActions=sn;window.pgRowAttributes=rn;window.pgRenderRowTemplate=nn;document.addEventListener("DOMContentLoaded",()=>{Livewire.hook("commit",({component:t,succeed:e,fail:s})=>{t.ephemeral.setUp&&t.ephemeral.setUp.hasOwnProperty("responsive")&&(e(()=>{queueMicrotask(()=>{window.dispatchEvent(new CustomEvent("pg-livewire-request-finished"))})}),s(()=>{window.dispatchEvent(new CustomEvent("pg-livewire-request-finished"))}))})});document.addEventListener("DOMContentLoaded",()=>{window.Alpine.directive("multisort-shift-click",(t,{expression:e})=>{t.addEventListener("click",s=>{window.Livewire.find(e).set("multiSort",s.shiftKey)})})});ae.extend(Ke);ae.locale("id");window.dayjs=ae;window.TomSelect=Qe;Le.register(Ue,We,Xe,Je,Ye,Ze,Ie);window.Chart=Le;window.ChartDataLabels=Ie;window.flatpickr=Ge;
