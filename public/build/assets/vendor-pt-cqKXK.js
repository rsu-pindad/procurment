var jo=Object.defineProperty;var Uo=(r,t,e)=>t in r?jo(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var pt=(r,t,e)=>Uo(r,typeof t!="symbol"?t+"":t,e);import{m as Ht,i as Ft,a as Bo,e as Ho,c as wi,r as Ae,v as Go,t as $o,d as Wo,b as Vo,A as zo,P as Yo,B as Ko}from"./vendor_chartjs-Bm73lTZW.js";function Jo(r,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(r,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}function Si(r,t){return function(){return r.apply(t,arguments)}}const{toString:qo}=Object.prototype,{getPrototypeOf:Or}=Object,{iterator:En,toStringTag:Ai}=Symbol,Tn=(r=>t=>{const e=qo.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),Ze=r=>(r=r.toLowerCase(),t=>Tn(t)===r),Rn=r=>t=>typeof t===r,{isArray:Dt}=Array,Gt=Rn("undefined");function Qo(r){return r!==null&&!Gt(r)&&r.constructor!==null&&!Gt(r.constructor)&&Be(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Ei=Ze("ArrayBuffer");function Xo(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&Ei(r.buffer),t}const Zo=Rn("string"),Be=Rn("function"),Ti=Rn("number"),Mn=r=>r!==null&&typeof r=="object",ea=r=>r===!0||r===!1,dn=r=>{if(Tn(r)!=="object")return!1;const t=Or(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Ai in r)&&!(En in r)},ta=Ze("Date"),na=Ze("File"),ra=Ze("Blob"),ia=Ze("FileList"),oa=r=>Mn(r)&&Be(r.pipe),aa=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||Be(r.append)&&((t=Tn(r))==="formdata"||t==="object"&&Be(r.toString)&&r.toString()==="[object FormData]"))},sa=Ze("URLSearchParams"),[ua,la,ca,fa]=["ReadableStream","Request","Response","Headers"].map(Ze),da=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function zt(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let n,i;if(typeof r!="object"&&(r=[r]),Dt(r))for(n=0,i=r.length;n<i;n++)t.call(null,r[n],n,r);else{const a=e?Object.getOwnPropertyNames(r):Object.keys(r),o=a.length;let u;for(n=0;n<o;n++)u=a[n],t.call(null,r[u],u,r)}}function Ri(r,t){t=t.toLowerCase();const e=Object.keys(r);let n=e.length,i;for(;n-- >0;)if(i=e[n],t===i.toLowerCase())return i;return null}const yt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Mi=r=>!Gt(r)&&r!==yt;function ur(){const{caseless:r}=Mi(this)&&this||{},t={},e=(n,i)=>{const a=r&&Ri(t,i)||i;dn(t[a])&&dn(n)?t[a]=ur(t[a],n):dn(n)?t[a]=ur({},n):Dt(n)?t[a]=n.slice():t[a]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&zt(arguments[n],e);return t}const ha=(r,t,e,{allOwnKeys:n}={})=>(zt(t,(i,a)=>{e&&Be(i)?r[a]=Si(i,e):r[a]=i},{allOwnKeys:n}),r),pa=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),ga=(r,t,e,n)=>{r.prototype=Object.create(t.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},ma=(r,t,e,n)=>{let i,a,o;const u={};if(t=t||{},r==null)return t;do{for(i=Object.getOwnPropertyNames(r),a=i.length;a-- >0;)o=i[a],(!n||n(o,r,t))&&!u[o]&&(t[o]=r[o],u[o]=!0);r=e!==!1&&Or(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},va=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const n=r.indexOf(t,e);return n!==-1&&n===e},ya=r=>{if(!r)return null;if(Dt(r))return r;let t=r.length;if(!Ti(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},ba=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Or(Uint8Array)),Ca=(r,t)=>{const n=(r&&r[En]).call(r);let i;for(;(i=n.next())&&!i.done;){const a=i.value;t.call(r,a[0],a[1])}},Oa=(r,t)=>{let e;const n=[];for(;(e=r.exec(t))!==null;)n.push(e);return n},wa=Ze("HTMLFormElement"),Sa=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,i){return n.toUpperCase()+i}),Dr=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),Aa=Ze("RegExp"),xi=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),n={};zt(e,(i,a)=>{let o;(o=t(i,a,r))!==!1&&(n[a]=o||i)}),Object.defineProperties(r,n)},Ea=r=>{xi(r,(t,e)=>{if(Be(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=r[e];if(Be(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},Ta=(r,t)=>{const e={},n=i=>{i.forEach(a=>{e[a]=!0})};return Dt(r)?n(r):n(String(r).split(t)),e},Ra=()=>{},Ma=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function xa(r){return!!(r&&Be(r.append)&&r[Ai]==="FormData"&&r[En])}const Ia=r=>{const t=new Array(10),e=(n,i)=>{if(Mn(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[i]=n;const a=Dt(n)?[]:{};return zt(n,(o,u)=>{const d=e(o,i+1);!Gt(d)&&(a[u]=d)}),t[i]=void 0,a}}return n};return e(r,0)},Da=Ze("AsyncFunction"),_a=r=>r&&(Mn(r)||Be(r))&&Be(r.then)&&Be(r.catch),Ii=((r,t)=>r?setImmediate:t?((e,n)=>(yt.addEventListener("message",({source:i,data:a})=>{i===yt&&a===e&&n.length&&n.shift()()},!1),i=>{n.push(i),yt.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",Be(yt.postMessage)),Pa=typeof queueMicrotask<"u"?queueMicrotask.bind(yt):typeof process<"u"&&process.nextTick||Ii,ka=r=>r!=null&&Be(r[En]),J={isArray:Dt,isArrayBuffer:Ei,isBuffer:Qo,isFormData:aa,isArrayBufferView:Xo,isString:Zo,isNumber:Ti,isBoolean:ea,isObject:Mn,isPlainObject:dn,isReadableStream:ua,isRequest:la,isResponse:ca,isHeaders:fa,isUndefined:Gt,isDate:ta,isFile:na,isBlob:ra,isRegExp:Aa,isFunction:Be,isStream:oa,isURLSearchParams:sa,isTypedArray:ba,isFileList:ia,forEach:zt,merge:ur,extend:ha,trim:da,stripBOM:pa,inherits:ga,toFlatObject:ma,kindOf:Tn,kindOfTest:Ze,endsWith:va,toArray:ya,forEachEntry:Ca,matchAll:Oa,isHTMLForm:wa,hasOwnProperty:Dr,hasOwnProp:Dr,reduceDescriptors:xi,freezeMethods:Ea,toObjectSet:Ta,toCamelCase:Sa,noop:Ra,toFiniteNumber:Ma,findKey:Ri,global:yt,isContextDefined:Mi,isSpecCompliantForm:xa,toJSONObject:Ia,isAsyncFn:Da,isThenable:_a,setImmediate:Ii,asap:Pa,isIterable:ka};function ce(r,t,e,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",t&&(this.code=t),e&&(this.config=e),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}J.inherits(ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const Di=ce.prototype,_i={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{_i[r]={value:r}});Object.defineProperties(ce,_i);Object.defineProperty(Di,"isAxiosError",{value:!0});ce.from=(r,t,e,n,i,a)=>{const o=Object.create(Di);return J.toFlatObject(r,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError"),ce.call(o,r.message,t,e,n,i),o.cause=r,o.name=r.name,a&&Object.assign(o,a),o};const La=null;function lr(r){return J.isPlainObject(r)||J.isArray(r)}function Pi(r){return J.endsWith(r,"[]")?r.slice(0,-2):r}function _r(r,t,e){return r?r.concat(t).map(function(i,a){return i=Pi(i),!e&&a?"["+i+"]":i}).join(e?".":""):t}function Na(r){return J.isArray(r)&&!r.some(lr)}const Fa=J.toFlatObject(J,{},null,function(t){return/^is[A-Z]/.test(t)});function xn(r,t,e){if(!J.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=J.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,T){return!J.isUndefined(T[A])});const n=e.metaTokens,i=e.visitor||m,a=e.dots,o=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(i))throw new TypeError("visitor must be a function");function h(l){if(l===null)return"";if(J.isDate(l))return l.toISOString();if(J.isBoolean(l))return l.toString();if(!d&&J.isBlob(l))throw new ce("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(l)||J.isTypedArray(l)?d&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function m(l,A,T){let x=l;if(l&&!T&&typeof l=="object"){if(J.endsWith(A,"{}"))A=n?A:A.slice(0,-2),l=JSON.stringify(l);else if(J.isArray(l)&&Na(l)||(J.isFileList(l)||J.endsWith(A,"[]"))&&(x=J.toArray(l)))return A=Pi(A),x.forEach(function(y,R){!(J.isUndefined(y)||y===null)&&t.append(o===!0?_r([A],R,a):o===null?A:A+"[]",h(y))}),!1}return lr(l)?!0:(t.append(_r(T,A,a),h(l)),!1)}const C=[],w=Object.assign(Fa,{defaultVisitor:m,convertValue:h,isVisitable:lr});function M(l,A){if(!J.isUndefined(l)){if(C.indexOf(l)!==-1)throw Error("Circular reference detected in "+A.join("."));C.push(l),J.forEach(l,function(x,b){(!(J.isUndefined(x)||x===null)&&i.call(t,x,J.isString(b)?b.trim():b,A,w))===!0&&M(x,A?A.concat(b):[b])}),C.pop()}}if(!J.isObject(r))throw new TypeError("data must be an object");return M(r),t}function Pr(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function wr(r,t){this._pairs=[],r&&xn(r,this,t)}const ki=wr.prototype;ki.append=function(t,e){this._pairs.push([t,e])};ki.toString=function(t){const e=t?function(n){return t.call(this,n,Pr)}:Pr;return this._pairs.map(function(i){return e(i[0])+"="+e(i[1])},"").join("&")};function ja(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Li(r,t,e){if(!t)return r;const n=e&&e.encode||ja;J.isFunction(e)&&(e={serialize:e});const i=e&&e.serialize;let a;if(i?a=i(t,e):a=J.isURLSearchParams(t)?t.toString():new wr(t,e).toString(n),a){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+a}return r}class kr{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){J.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Ni={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ua=typeof URLSearchParams<"u"?URLSearchParams:wr,Ba=typeof FormData<"u"?FormData:null,Ha=typeof Blob<"u"?Blob:null,Ga={isBrowser:!0,classes:{URLSearchParams:Ua,FormData:Ba,Blob:Ha},protocols:["http","https","file","blob","url","data"]},Sr=typeof window<"u"&&typeof document<"u",cr=typeof navigator=="object"&&navigator||void 0,$a=Sr&&(!cr||["ReactNative","NativeScript","NS"].indexOf(cr.product)<0),Wa=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Va=Sr&&window.location.href||"http://localhost",za=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Sr,hasStandardBrowserEnv:$a,hasStandardBrowserWebWorkerEnv:Wa,navigator:cr,origin:Va},Symbol.toStringTag,{value:"Module"})),ke={...za,...Ga};function Ya(r,t){return xn(r,new ke.classes.URLSearchParams,Object.assign({visitor:function(e,n,i,a){return ke.isNode&&J.isBuffer(e)?(this.append(n,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}function Ka(r){return J.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ja(r){const t={},e=Object.keys(r);let n;const i=e.length;let a;for(n=0;n<i;n++)a=e[n],t[a]=r[a];return t}function Fi(r){function t(e,n,i,a){let o=e[a++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),d=a>=e.length;return o=!o&&J.isArray(i)?i.length:o,d?(J.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!u):((!i[o]||!J.isObject(i[o]))&&(i[o]=[]),t(e,n,i[o],a)&&J.isArray(i[o])&&(i[o]=Ja(i[o])),!u)}if(J.isFormData(r)&&J.isFunction(r.entries)){const e={};return J.forEachEntry(r,(n,i)=>{t(Ka(n),i,e,0)}),e}return null}function qa(r,t,e){if(J.isString(r))try{return(t||JSON.parse)(r),J.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(r)}const Yt={transitional:Ni,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,a=J.isObject(t);if(a&&J.isHTMLForm(t)&&(t=new FormData(t)),J.isFormData(t))return i?JSON.stringify(Fi(t)):t;if(J.isArrayBuffer(t)||J.isBuffer(t)||J.isStream(t)||J.isFile(t)||J.isBlob(t)||J.isReadableStream(t))return t;if(J.isArrayBufferView(t))return t.buffer;if(J.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ya(t,this.formSerializer).toString();if((u=J.isFileList(t))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return xn(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return a||i?(e.setContentType("application/json",!1),qa(t)):t}],transformResponse:[function(t){const e=this.transitional||Yt.transitional,n=e&&e.forcedJSONParsing,i=this.responseType==="json";if(J.isResponse(t)||J.isReadableStream(t))return t;if(t&&J.isString(t)&&(n&&!this.responseType||i)){const o=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?ce.from(u,ce.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ke.classes.FormData,Blob:ke.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],r=>{Yt.headers[r]={}});const Qa=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Xa=r=>{const t={};let e,n,i;return r&&r.split(`
`).forEach(function(o){i=o.indexOf(":"),e=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!e||t[e]&&Qa[e])&&(e==="set-cookie"?t[e]?t[e].push(n):t[e]=[n]:t[e]=t[e]?t[e]+", "+n:n)}),t},Lr=Symbol("internals");function kt(r){return r&&String(r).trim().toLowerCase()}function hn(r){return r===!1||r==null?r:J.isArray(r)?r.map(hn):String(r)}function Za(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(r);)t[n[1]]=n[2];return t}const es=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Gn(r,t,e,n,i){if(J.isFunction(n))return n.call(this,t,e);if(i&&(t=e),!!J.isString(t)){if(J.isString(n))return t.indexOf(n)!==-1;if(J.isRegExp(n))return n.test(t)}}function ts(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}function ns(r,t){const e=J.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+e,{value:function(i,a,o){return this[n].call(this,t,i,a,o)},configurable:!0})})}let He=class{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function a(u,d,h){const m=kt(d);if(!m)throw new Error("header name must be a non-empty string");const C=J.findKey(i,m);(!C||i[C]===void 0||h===!0||h===void 0&&i[C]!==!1)&&(i[C||d]=hn(u))}const o=(u,d)=>J.forEach(u,(h,m)=>a(h,m,d));if(J.isPlainObject(t)||t instanceof this.constructor)o(t,e);else if(J.isString(t)&&(t=t.trim())&&!es(t))o(Xa(t),e);else if(J.isObject(t)&&J.isIterable(t)){let u={},d,h;for(const m of t){if(!J.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[h=m[0]]=(d=u[h])?J.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}o(u,e)}else t!=null&&a(e,t,n);return this}get(t,e){if(t=kt(t),t){const n=J.findKey(this,t);if(n){const i=this[n];if(!e)return i;if(e===!0)return Za(i);if(J.isFunction(e))return e.call(this,i,n);if(J.isRegExp(e))return e.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=kt(t),t){const n=J.findKey(this,t);return!!(n&&this[n]!==void 0&&(!e||Gn(this,this[n],n,e)))}return!1}delete(t,e){const n=this;let i=!1;function a(o){if(o=kt(o),o){const u=J.findKey(n,o);u&&(!e||Gn(n,n[u],u,e))&&(delete n[u],i=!0)}}return J.isArray(t)?t.forEach(a):a(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const a=e[n];(!t||Gn(this,this[a],a,t,!0))&&(delete this[a],i=!0)}return i}normalize(t){const e=this,n={};return J.forEach(this,(i,a)=>{const o=J.findKey(n,a);if(o){e[o]=hn(i),delete e[a];return}const u=t?ts(a):String(a).trim();u!==a&&delete e[a],e[u]=hn(i),n[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return J.forEach(this,(n,i)=>{n!=null&&n!==!1&&(e[i]=t&&J.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[Lr]=this[Lr]={accessors:{}}).accessors,i=this.prototype;function a(o){const u=kt(o);n[u]||(ns(i,o),n[u]=!0)}return J.isArray(t)?t.forEach(a):a(t),this}};He.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(He.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(n){this[e]=n}}});J.freezeMethods(He);function $n(r,t){const e=this||Yt,n=t||e,i=He.from(n.headers);let a=n.data;return J.forEach(r,function(u){a=u.call(e,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}function ji(r){return!!(r&&r.__CANCEL__)}function _t(r,t,e){ce.call(this,r??"canceled",ce.ERR_CANCELED,t,e),this.name="CanceledError"}J.inherits(_t,ce,{__CANCEL__:!0});function Ui(r,t,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?r(e):t(new ce("Request failed with status code "+e.status,[ce.ERR_BAD_REQUEST,ce.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function rs(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function is(r,t){r=r||10;const e=new Array(r),n=new Array(r);let i=0,a=0,o;return t=t!==void 0?t:1e3,function(d){const h=Date.now(),m=n[a];o||(o=h),e[i]=d,n[i]=h;let C=a,w=0;for(;C!==i;)w+=e[C++],C=C%r;if(i=(i+1)%r,i===a&&(a=(a+1)%r),h-o<t)return;const M=m&&h-m;return M?Math.round(w*1e3/M):void 0}}function os(r,t){let e=0,n=1e3/t,i,a;const o=(h,m=Date.now())=>{e=m,i=null,a&&(clearTimeout(a),a=null),r.apply(null,h)};return[(...h)=>{const m=Date.now(),C=m-e;C>=n?o(h,m):(i=h,a||(a=setTimeout(()=>{a=null,o(i)},n-C)))},()=>i&&o(i)]}const mn=(r,t,e=3)=>{let n=0;const i=is(50,250);return os(a=>{const o=a.loaded,u=a.lengthComputable?a.total:void 0,d=o-n,h=i(d),m=o<=u;n=o;const C={loaded:o,total:u,progress:u?o/u:void 0,bytes:d,rate:h||void 0,estimated:h&&u&&m?(u-o)/h:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};r(C)},e)},Nr=(r,t)=>{const e=r!=null;return[n=>t[0]({lengthComputable:e,total:r,loaded:n}),t[1]]},Fr=r=>(...t)=>J.asap(()=>r(...t)),as=ke.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,ke.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(ke.origin),ke.navigator&&/(msie|trident)/i.test(ke.navigator.userAgent)):()=>!0,ss=ke.hasStandardBrowserEnv?{write(r,t,e,n,i,a){const o=[r+"="+encodeURIComponent(t)];J.isNumber(e)&&o.push("expires="+new Date(e).toGMTString()),J.isString(n)&&o.push("path="+n),J.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const t=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function us(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function ls(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function Bi(r,t,e){let n=!us(t);return r&&(n||e==!1)?ls(r,t):t}const jr=r=>r instanceof He?{...r}:r;function Ct(r,t){t=t||{};const e={};function n(h,m,C,w){return J.isPlainObject(h)&&J.isPlainObject(m)?J.merge.call({caseless:w},h,m):J.isPlainObject(m)?J.merge({},m):J.isArray(m)?m.slice():m}function i(h,m,C,w){if(J.isUndefined(m)){if(!J.isUndefined(h))return n(void 0,h,C,w)}else return n(h,m,C,w)}function a(h,m){if(!J.isUndefined(m))return n(void 0,m)}function o(h,m){if(J.isUndefined(m)){if(!J.isUndefined(h))return n(void 0,h)}else return n(void 0,m)}function u(h,m,C){if(C in t)return n(h,m);if(C in r)return n(void 0,h)}const d={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(h,m,C)=>i(jr(h),jr(m),C,!0)};return J.forEach(Object.keys(Object.assign({},r,t)),function(m){const C=d[m]||i,w=C(r[m],t[m],m);J.isUndefined(w)&&C!==u||(e[m]=w)}),e}const Hi=r=>{const t=Ct({},r);let{data:e,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:u}=t;t.headers=o=He.from(o),t.url=Li(Bi(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let d;if(J.isFormData(e)){if(ke.hasStandardBrowserEnv||ke.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((d=o.getContentType())!==!1){const[h,...m]=d?d.split(";").map(C=>C.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...m].join("; "))}}if(ke.hasStandardBrowserEnv&&(n&&J.isFunction(n)&&(n=n(t)),n||n!==!1&&as(t.url))){const h=i&&a&&ss.read(a);h&&o.set(i,h)}return t},cs=typeof XMLHttpRequest<"u",fs=cs&&function(r){return new Promise(function(e,n){const i=Hi(r);let a=i.data;const o=He.from(i.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:h}=i,m,C,w,M,l;function A(){M&&M(),l&&l(),i.cancelToken&&i.cancelToken.unsubscribe(m),i.signal&&i.signal.removeEventListener("abort",m)}let T=new XMLHttpRequest;T.open(i.method.toUpperCase(),i.url,!0),T.timeout=i.timeout;function x(){if(!T)return;const y=He.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),p={data:!u||u==="text"||u==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:y,config:r,request:T};Ui(function(c){e(c),A()},function(c){n(c),A()},p),T=null}"onloadend"in T?T.onloadend=x:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(x)},T.onabort=function(){T&&(n(new ce("Request aborted",ce.ECONNABORTED,r,T)),T=null)},T.onerror=function(){n(new ce("Network Error",ce.ERR_NETWORK,r,T)),T=null},T.ontimeout=function(){let R=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const p=i.transitional||Ni;i.timeoutErrorMessage&&(R=i.timeoutErrorMessage),n(new ce(R,p.clarifyTimeoutError?ce.ETIMEDOUT:ce.ECONNABORTED,r,T)),T=null},a===void 0&&o.setContentType(null),"setRequestHeader"in T&&J.forEach(o.toJSON(),function(R,p){T.setRequestHeader(p,R)}),J.isUndefined(i.withCredentials)||(T.withCredentials=!!i.withCredentials),u&&u!=="json"&&(T.responseType=i.responseType),h&&([w,l]=mn(h,!0),T.addEventListener("progress",w)),d&&T.upload&&([C,M]=mn(d),T.upload.addEventListener("progress",C),T.upload.addEventListener("loadend",M)),(i.cancelToken||i.signal)&&(m=y=>{T&&(n(!y||y.type?new _t(null,r,T):y),T.abort(),T=null)},i.cancelToken&&i.cancelToken.subscribe(m),i.signal&&(i.signal.aborted?m():i.signal.addEventListener("abort",m)));const b=rs(i.url);if(b&&ke.protocols.indexOf(b)===-1){n(new ce("Unsupported protocol "+b+":",ce.ERR_BAD_REQUEST,r));return}T.send(a||null)})},ds=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let n=new AbortController,i;const a=function(h){if(!i){i=!0,u();const m=h instanceof Error?h:this.reason;n.abort(m instanceof ce?m:new _t(m instanceof Error?m.message:m))}};let o=t&&setTimeout(()=>{o=null,a(new ce(`timeout ${t} of ms exceeded`,ce.ETIMEDOUT))},t);const u=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),r=null)};r.forEach(h=>h.addEventListener("abort",a));const{signal:d}=n;return d.unsubscribe=()=>J.asap(u),d}},hs=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let n=0,i;for(;n<e;)i=n+t,yield r.slice(n,i),n=i},ps=async function*(r,t){for await(const e of gs(r))yield*hs(e,t)},gs=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Ur=(r,t,e,n)=>{const i=ps(r,t);let a=0,o,u=d=>{o||(o=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:h,value:m}=await i.next();if(h){u(),d.close();return}let C=m.byteLength;if(e){let w=a+=C;e(w)}d.enqueue(new Uint8Array(m))}catch(h){throw u(h),h}},cancel(d){return u(d),i.return()}},{highWaterMark:2})},In=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Gi=In&&typeof ReadableStream=="function",ms=In&&(typeof TextEncoder=="function"?(r=>t=>r.encode(t))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),$i=(r,...t)=>{try{return!!r(...t)}catch{return!1}},vs=Gi&&$i(()=>{let r=!1;const t=new Request(ke.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!t}),Br=64*1024,fr=Gi&&$i(()=>J.isReadableStream(new Response("").body)),vn={stream:fr&&(r=>r.body)};In&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!vn[t]&&(vn[t]=J.isFunction(r[t])?e=>e[t]():(e,n)=>{throw new ce(`Response type '${t}' is not supported`,ce.ERR_NOT_SUPPORT,n)})})})(new Response);const ys=async r=>{if(r==null)return 0;if(J.isBlob(r))return r.size;if(J.isSpecCompliantForm(r))return(await new Request(ke.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(J.isArrayBufferView(r)||J.isArrayBuffer(r))return r.byteLength;if(J.isURLSearchParams(r)&&(r=r+""),J.isString(r))return(await ms(r)).byteLength},bs=async(r,t)=>{const e=J.toFiniteNumber(r.getContentLength());return e??ys(t)},Cs=In&&(async r=>{let{url:t,method:e,data:n,signal:i,cancelToken:a,timeout:o,onDownloadProgress:u,onUploadProgress:d,responseType:h,headers:m,withCredentials:C="same-origin",fetchOptions:w}=Hi(r);h=h?(h+"").toLowerCase():"text";let M=ds([i,a&&a.toAbortSignal()],o),l;const A=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let T;try{if(d&&vs&&e!=="get"&&e!=="head"&&(T=await bs(m,n))!==0){let p=new Request(t,{method:"POST",body:n,duplex:"half"}),f;if(J.isFormData(n)&&(f=p.headers.get("content-type"))&&m.setContentType(f),p.body){const[c,s]=Nr(T,mn(Fr(d)));n=Ur(p.body,Br,c,s)}}J.isString(C)||(C=C?"include":"omit");const x="credentials"in Request.prototype;l=new Request(t,{...w,signal:M,method:e.toUpperCase(),headers:m.normalize().toJSON(),body:n,duplex:"half",credentials:x?C:void 0});let b=await fetch(l,w);const y=fr&&(h==="stream"||h==="response");if(fr&&(u||y&&A)){const p={};["status","statusText","headers"].forEach(v=>{p[v]=b[v]});const f=J.toFiniteNumber(b.headers.get("content-length")),[c,s]=u&&Nr(f,mn(Fr(u),!0))||[];b=new Response(Ur(b.body,Br,c,()=>{s&&s(),A&&A()}),p)}h=h||"text";let R=await vn[J.findKey(vn,h)||"text"](b,r);return!y&&A&&A(),await new Promise((p,f)=>{Ui(p,f,{data:R,headers:He.from(b.headers),status:b.status,statusText:b.statusText,config:r,request:l})})}catch(x){throw A&&A(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new ce("Network Error",ce.ERR_NETWORK,r,l),{cause:x.cause||x}):ce.from(x,x&&x.code,r,l)}}),dr={http:La,xhr:fs,fetch:Cs};J.forEach(dr,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const Hr=r=>`- ${r}`,Os=r=>J.isFunction(r)||r===null||r===!1,Wi={getAdapter:r=>{r=J.isArray(r)?r:[r];const{length:t}=r;let e,n;const i={};for(let a=0;a<t;a++){e=r[a];let o;if(n=e,!Os(e)&&(n=dr[(o=String(e)).toLowerCase()],n===void 0))throw new ce(`Unknown adapter '${o}'`);if(n)break;i[o||"#"+a]=n}if(!n){const a=Object.entries(i).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(Hr).join(`
`):" "+Hr(a[0]):"as no adapter specified";throw new ce("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:dr};function Wn(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new _t(null,r)}function Gr(r){return Wn(r),r.headers=He.from(r.headers),r.data=$n.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Wi.getAdapter(r.adapter||Yt.adapter)(r).then(function(n){return Wn(r),n.data=$n.call(r,r.transformResponse,n),n.headers=He.from(n.headers),n},function(n){return ji(n)||(Wn(r),n&&n.response&&(n.response.data=$n.call(r,r.transformResponse,n.response),n.response.headers=He.from(n.response.headers))),Promise.reject(n)})}const Vi="1.10.0",Dn={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{Dn[r]=function(n){return typeof n===r||"a"+(t<1?"n ":" ")+r}});const $r={};Dn.transitional=function(t,e,n){function i(a,o){return"[Axios v"+Vi+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,u)=>{if(t===!1)throw new ce(i(o," has been removed"+(e?" in "+e:"")),ce.ERR_DEPRECATED);return e&&!$r[o]&&($r[o]=!0,console.warn(i(o," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(a,o,u):!0}};Dn.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function ws(r,t,e){if(typeof r!="object")throw new ce("options must be an object",ce.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let i=n.length;for(;i-- >0;){const a=n[i],o=t[a];if(o){const u=r[a],d=u===void 0||o(u,a,r);if(d!==!0)throw new ce("option "+a+" must be "+d,ce.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new ce("Unknown option "+a,ce.ERR_BAD_OPTION)}}const pn={assertOptions:ws,validators:Dn},tt=pn.validators;let bt=class{constructor(t){this.defaults=t||{},this.interceptors={request:new kr,response:new kr}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const a=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Ct(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:a}=e;n!==void 0&&pn.assertOptions(n,{silentJSONParsing:tt.transitional(tt.boolean),forcedJSONParsing:tt.transitional(tt.boolean),clarifyTimeoutError:tt.transitional(tt.boolean)},!1),i!=null&&(J.isFunction(i)?e.paramsSerializer={serialize:i}:pn.assertOptions(i,{encode:tt.function,serialize:tt.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),pn.assertOptions(e,{baseUrl:tt.spelling("baseURL"),withXsrfToken:tt.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=a&&J.merge(a.common,a[e.method]);a&&J.forEach(["delete","get","head","post","put","patch","common"],l=>{delete a[l]}),e.headers=He.concat(o,a);const u=[];let d=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(e)===!1||(d=d&&A.synchronous,u.unshift(A.fulfilled,A.rejected))});const h=[];this.interceptors.response.forEach(function(A){h.push(A.fulfilled,A.rejected)});let m,C=0,w;if(!d){const l=[Gr.bind(this),void 0];for(l.unshift.apply(l,u),l.push.apply(l,h),w=l.length,m=Promise.resolve(e);C<w;)m=m.then(l[C++],l[C++]);return m}w=u.length;let M=e;for(C=0;C<w;){const l=u[C++],A=u[C++];try{M=l(M)}catch(T){A.call(this,T);break}}try{m=Gr.call(this,M)}catch(l){return Promise.reject(l)}for(C=0,w=h.length;C<w;)m=m.then(h[C++],h[C++]);return m}getUri(t){t=Ct(this.defaults,t);const e=Bi(t.baseURL,t.url,t.allowAbsoluteUrls);return Li(e,t.params,t.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(t){bt.prototype[t]=function(e,n){return this.request(Ct(n||{},{method:t,url:e,data:(n||{}).data}))}});J.forEach(["post","put","patch"],function(t){function e(n){return function(a,o,u){return this.request(Ct(u||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}bt.prototype[t]=e(),bt.prototype[t+"Form"]=e(!0)});let Ss=class zi{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(a){e=a});const n=this;this.promise.then(i=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](i);n._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(u=>{n.subscribe(u),a=u}).then(i);return o.cancel=function(){n.unsubscribe(a)},o},t(function(a,o,u){n.reason||(n.reason=new _t(a,o,u),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=n=>{t.abort(n)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new zi(function(i){t=i}),cancel:t}}};function As(r){return function(e){return r.apply(null,e)}}function Es(r){return J.isObject(r)&&r.isAxiosError===!0}const hr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hr).forEach(([r,t])=>{hr[t]=r});function Yi(r){const t=new bt(r),e=Si(bt.prototype.request,t);return J.extend(e,bt.prototype,t,{allOwnKeys:!0}),J.extend(e,t,null,{allOwnKeys:!0}),e.create=function(i){return Yi(Ct(r,i))},e}const Ee=Yi(Yt);Ee.Axios=bt;Ee.CanceledError=_t;Ee.CancelToken=Ss;Ee.isCancel=ji;Ee.VERSION=Vi;Ee.toFormData=xn;Ee.AxiosError=ce;Ee.Cancel=Ee.CanceledError;Ee.all=function(t){return Promise.all(t)};Ee.spread=As;Ee.isAxiosError=Es;Ee.mergeConfig=Ct;Ee.AxiosHeaders=He;Ee.formToJSON=r=>Fi(J.isHTMLForm(r)?new FormData(r):r);Ee.getAdapter=Wi.getAdapter;Ee.HttpStatusCode=hr;Ee.default=Ee;const{Axios:Wc,AxiosError:Vc,CanceledError:zc,isCancel:Yc,CancelToken:Kc,VERSION:Jc,all:qc,Cancel:Qc,isAxiosError:Xc,spread:Zc,toFormData:ef,AxiosHeaders:tf,HttpStatusCode:nf,formToJSON:rf,getAdapter:of,mergeConfig:af}=Ee;function Ts(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ie(r,t,e){return t=xt(t),Ms(r,Ki()?Reflect.construct(t,e||[],xt(r).constructor):t.apply(r,e))}function be(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Rs(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,_s(n.key),n)}}function Ce(r,t,e){return t&&Rs(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Qe(){return Qe=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)({}).hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},Qe.apply(null,arguments)}function pr(){return pr=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,t,e){var n=xs(r,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?r:e):i.value}},pr.apply(null,arguments)}function xt(r){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(r)}function De(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&gr(r,t)}function Ki(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ki=function(){return!!r})()}function Ms(r,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ts(r)}function ot(){ot=function(){return t};var r,t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(O,E,P){O[E]=P.value},a=typeof Symbol=="function"?Symbol:{},o=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function h(O,E,P){return Object.defineProperty(O,E,{value:P,enumerable:!0,configurable:!0,writable:!0}),O[E]}try{h({},"")}catch{h=function(E,P,F){return E[P]=F}}function m(O,E,P,F){var B=E&&E.prototype instanceof x?E:x,z=Object.create(B.prototype),Y=new _(F||[]);return i(z,"_invoke",{value:g(O,P,Y)}),z}function C(O,E,P){try{return{type:"normal",arg:O.call(E,P)}}catch(F){return{type:"throw",arg:F}}}t.wrap=m;var w="suspendedStart",M="suspendedYield",l="executing",A="completed",T={};function x(){}function b(){}function y(){}var R={};h(R,o,function(){return this});var p=Object.getPrototypeOf,f=p&&p(p(I([])));f&&f!==e&&n.call(f,o)&&(R=f);var c=y.prototype=x.prototype=Object.create(R);function s(O){["next","throw","return"].forEach(function(E){h(O,E,function(P){return this._invoke(E,P)})})}function v(O,E){function P(B,z,Y,$){var D=C(O[B],O,z);if(D.type!=="throw"){var N=D.arg,j=N.value;return j&&typeof j=="object"&&n.call(j,"__await")?E.resolve(j.__await).then(function(G){P("next",G,Y,$)},function(G){P("throw",G,Y,$)}):E.resolve(j).then(function(G){N.value=G,Y(N)},function(G){return P("throw",G,Y,$)})}$(D.arg)}var F;i(this,"_invoke",{value:function(B,z){function Y(){return new E(function($,D){P(B,z,$,D)})}return F=F?F.then(Y,Y):Y()}})}function g(O,E,P){var F=w;return function(B,z){if(F===l)throw Error("Generator is already running");if(F===A){if(B==="throw")throw z;return{value:r,done:!0}}for(P.method=B,P.arg=z;;){var Y=P.delegate;if(Y){var $=S(Y,P);if($){if($===T)continue;return $}}if(P.method==="next")P.sent=P._sent=P.arg;else if(P.method==="throw"){if(F===w)throw F=A,P.arg;P.dispatchException(P.arg)}else P.method==="return"&&P.abrupt("return",P.arg);F=l;var D=C(O,E,P);if(D.type==="normal"){if(F=P.done?A:M,D.arg===T)continue;return{value:D.arg,done:P.done}}D.type==="throw"&&(F=A,P.method="throw",P.arg=D.arg)}}}function S(O,E){var P=E.method,F=O.iterator[P];if(F===r)return E.delegate=null,P==="throw"&&O.iterator.return&&(E.method="return",E.arg=r,S(O,E),E.method==="throw")||P!=="return"&&(E.method="throw",E.arg=new TypeError("The iterator does not provide a '"+P+"' method")),T;var B=C(F,O.iterator,E.arg);if(B.type==="throw")return E.method="throw",E.arg=B.arg,E.delegate=null,T;var z=B.arg;return z?z.done?(E[O.resultName]=z.value,E.next=O.nextLoc,E.method!=="return"&&(E.method="next",E.arg=r),E.delegate=null,T):z:(E.method="throw",E.arg=new TypeError("iterator result is not an object"),E.delegate=null,T)}function L(O){var E={tryLoc:O[0]};1 in O&&(E.catchLoc=O[1]),2 in O&&(E.finallyLoc=O[2],E.afterLoc=O[3]),this.tryEntries.push(E)}function k(O){var E=O.completion||{};E.type="normal",delete E.arg,O.completion=E}function _(O){this.tryEntries=[{tryLoc:"root"}],O.forEach(L,this),this.reset(!0)}function I(O){if(O||O===""){var E=O[o];if(E)return E.call(O);if(typeof O.next=="function")return O;if(!isNaN(O.length)){var P=-1,F=function B(){for(;++P<O.length;)if(n.call(O,P))return B.value=O[P],B.done=!1,B;return B.value=r,B.done=!0,B};return F.next=F}}throw new TypeError(typeof O+" is not iterable")}return b.prototype=y,i(c,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=h(y,d,"GeneratorFunction"),t.isGeneratorFunction=function(O){var E=typeof O=="function"&&O.constructor;return!!E&&(E===b||(E.displayName||E.name)==="GeneratorFunction")},t.mark=function(O){return Object.setPrototypeOf?Object.setPrototypeOf(O,y):(O.__proto__=y,h(O,d,"GeneratorFunction")),O.prototype=Object.create(c),O},t.awrap=function(O){return{__await:O}},s(v.prototype),h(v.prototype,u,function(){return this}),t.AsyncIterator=v,t.async=function(O,E,P,F,B){B===void 0&&(B=Promise);var z=new v(m(O,E,P,F),B);return t.isGeneratorFunction(E)?z:z.next().then(function(Y){return Y.done?Y.value:z.next()})},s(c),h(c,d,"Generator"),h(c,o,function(){return this}),h(c,"toString",function(){return"[object Generator]"}),t.keys=function(O){var E=Object(O),P=[];for(var F in E)P.push(F);return P.reverse(),function B(){for(;P.length;){var z=P.pop();if(z in E)return B.value=z,B.done=!1,B}return B.done=!0,B}},t.values=I,_.prototype={constructor:_,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(k),!O)for(var E in this)E.charAt(0)==="t"&&n.call(this,E)&&!isNaN(+E.slice(1))&&(this[E]=r)},stop:function(){this.done=!0;var O=this.tryEntries[0].completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var E=this;function P(D,N){return z.type="throw",z.arg=O,E.next=D,N&&(E.method="next",E.arg=r),!!N}for(var F=this.tryEntries.length-1;F>=0;--F){var B=this.tryEntries[F],z=B.completion;if(B.tryLoc==="root")return P("end");if(B.tryLoc<=this.prev){var Y=n.call(B,"catchLoc"),$=n.call(B,"finallyLoc");if(Y&&$){if(this.prev<B.catchLoc)return P(B.catchLoc,!0);if(this.prev<B.finallyLoc)return P(B.finallyLoc)}else if(Y){if(this.prev<B.catchLoc)return P(B.catchLoc,!0)}else{if(!$)throw Error("try statement without catch or finally");if(this.prev<B.finallyLoc)return P(B.finallyLoc)}}}},abrupt:function(O,E){for(var P=this.tryEntries.length-1;P>=0;--P){var F=this.tryEntries[P];if(F.tryLoc<=this.prev&&n.call(F,"finallyLoc")&&this.prev<F.finallyLoc){var B=F;break}}B&&(O==="break"||O==="continue")&&B.tryLoc<=E&&E<=B.finallyLoc&&(B=null);var z=B?B.completion:{};return z.type=O,z.arg=E,B?(this.method="next",this.next=B.finallyLoc,T):this.complete(z)},complete:function(O,E){if(O.type==="throw")throw O.arg;return O.type==="break"||O.type==="continue"?this.next=O.arg:O.type==="return"?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):O.type==="normal"&&E&&(this.next=E),T},finish:function(O){for(var E=this.tryEntries.length-1;E>=0;--E){var P=this.tryEntries[E];if(P.finallyLoc===O)return this.complete(P.completion,P.afterLoc),k(P),T}},catch:function(O){for(var E=this.tryEntries.length-1;E>=0;--E){var P=this.tryEntries[E];if(P.tryLoc===O){var F=P.completion;if(F.type==="throw"){var B=F.arg;k(P)}return B}}throw Error("illegal catch attempt")},delegateYield:function(O,E,P){return this.delegate={iterator:I(O),resultName:E,nextLoc:P},this.method==="next"&&(this.arg=r),T}},t}function gr(r,t){return gr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},gr(r,t)}function xs(r,t){for(;!{}.hasOwnProperty.call(r,t)&&(r=xt(r))!==null;);return r}function Is(r,t,e,n){var i=pr(xt(r.prototype),t,e);return typeof i=="function"?function(a){return i.apply(e,a)}:i}function Ds(r,t){if(typeof r!="object"||!r)return r;var e=r[Symbol.toPrimitive];if(e!==void 0){var n=e.call(r,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function _s(r){var t=Ds(r,"string");return typeof t=="symbol"?t:t+""}function $t(r){"@babel/helpers - typeof";return $t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(r)}var _n=function(){function r(){be(this,r)}return Ce(r,[{key:"listenForWhisper",value:function(e,n){return this.listen(".client-"+e,n)}},{key:"notification",value:function(e){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",e)}},{key:"stopListeningForWhisper",value:function(e,n){return this.stopListening(".client-"+e,n)}}])}();function yn(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e}function bn(r,t,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function u(m){try{h(n.next(m))}catch(C){o(C)}}function d(m){try{h(n.throw(m))}catch(C){o(C)}}function h(m){m.done?a(m.value):i(m.value).then(u,d)}h((n=n.apply(r,[])).next())})}var Ar=function(){function r(t){be(this,r),this.namespace=t}return Ce(r,[{key:"format",value:function(e){return[".","\\"].includes(e.charAt(0))?e.substring(1):(this.namespace&&(e=this.namespace+"."+e),e.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(e){this.namespace=e}}])}(),Er=function(r){function t(e,n,i){var a,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return be(this,t),a=Ie(this,t),a._alertErrorListeners=function(u){u&&a.errorListeners.forEach(function(d){return d(u)})},a.name=n,a.ably=e,a.options=i,a.eventFormatter=new Ar(a.options.namespace),a.subscribedListeners=[],a.errorListeners=[],a.channel=e.channels.get(n),a.callbacks=new Map,o&&a.subscribe(),a}return De(t,r),Ce(t,[{key:"subscribe",value:function(){var n=this;this.channel.on(function(i){var a=i.previous,o=i.current,u=i.reason;a!=="attached"&&o=="attached"?n.subscribedListeners.forEach(function(d){return d()}):u&&n._alertErrorListeners(i)}),this.channel.attach(this._alertErrorListeners)}},{key:"unsubscribe",value:function(){this.channel.unsubscribe(),this.callbacks.clear(),this.unregisterError(),this.unregisterSubscribed(),this.channel.off(),this.channel.detach()}},{key:"listen",value:function(n,i){return this.callbacks.set(i,function(a){var o=a.data,u=yn(a,["data"]);return i(o,u)}),this.channel.subscribe(this.eventFormatter.format(n),this.callbacks.get(i)),this}},{key:"listenToAll",value:function(n){var i=this;return this.callbacks.set(n,function(a){var o=a.name,u=a.data,d=yn(a,["name","data"]),h=i.options.namespace.replace(/\./g,"\\"),m=o.startsWith(h)?o.substring(h.length+1):"."+o;n(m,u,d)}),this.channel.subscribe(this.callbacks.get(n)),this}},{key:"stopListening",value:function(n,i){return i?(this.channel.unsubscribe(this.eventFormatter.format(n),this.callbacks.get(i)),this.callbacks.delete(i)):this.channel.unsubscribe(this.eventFormatter.format(n)),this}},{key:"stopListeningToAll",value:function(n){return n?(this.channel.unsubscribe(this.callbacks.get(n)),this.callbacks.delete(n)):this.channel.unsubscribe(),this}},{key:"subscribed",value:function(n){return this.subscribedListeners.push(n),this}},{key:"error",value:function(n){return this.errorListeners.push(n),this}},{key:"unregisterSubscribed",value:function(n){return n?this.subscribedListeners=this.subscribedListeners.filter(function(i){return i!=n}):this.subscribedListeners=[],this}},{key:"unregisterError",value:function(n){return n?this.errorListeners=this.errorListeners.filter(function(i){return i!=n}):this.errorListeners=[],this}}])}(_n),Ps=function(r){function t(e,n,i,a){var o;return be(this,t),o=Ie(this,t,[e,n,i,!1]),o.channel.on("failed",a.onChannelFailed(o)),o.subscribe(),o}return De(t,r),Ce(t,[{key:"whisper",value:function(n,i,a){return a?this.channel.publish("client-".concat(n),i,a):this.channel.publish("client-".concat(n),i),this}}])}(Er),Ji=function(r){function t(e,n,i,a){var o;return be(this,t),o=Ie(this,t,[e,n,i,!1]),o.channel.on("failed",a.onChannelFailed(o)),o.channel.on("attached",function(){return o.enter(o.presenceData,o._alertErrorListeners)}),o.subscribe(),o}return De(t,r),Ce(t,[{key:"unsubscribe",value:function(){this.leave(this.presenceData,this._alertErrorListeners),this.channel.presence.unsubscribe(),Is(t,"unsubscribe",this)([])}},{key:"here",value:function(n){var i=this;return this.channel.presence.subscribe(["enter","update","leave"],function(){return i.channel.presence.get(function(a,o){return n(o.map(function(u){var d=u.data;return d}),a)})}),this}},{key:"joining",value:function(n){return this.channel.presence.subscribe(["enter","update"],function(i){var a=i.data,o=yn(i,["data"]);n(a,o)}),this}},{key:"leaving",value:function(n){return this.channel.presence.subscribe("leave",function(i){var a=i.data,o=yn(i,["data"]);n(a,o)}),this}},{key:"enter",value:function(n,i){return this.channel.presence.enter(n,i),this}},{key:"leave",value:function(n,i){return this.channel.presence.leave(n,i),this}},{key:"update",value:function(n,i){return this.channel.presence.update(n,i),this}},{key:"whisper",value:function(n,i,a){return a?this.channel.publish("client-".concat(n),i,a):this.channel.publish("client-".concat(n),i),this}}])}(Er),ks=function(t){return t==null||t===void 0},qi=function(t){var e=t.split(".")[0],n=e.replace("-","+").replace("_","/"),i=JSON.parse(Wr(n)),a=t.split(".")[1],o=a.replace("-","+").replace("_","/"),u=JSON.parse(Wr(o));return{header:i,payload:u}},Vn=function(t){var e=qi(t),n=e.payload;return{clientId:n["x-ably-clientId"],expires:n.exp*1e3,issued:n.iat*1e3,token:t}},Pn=(typeof window>"u"?"undefined":$t(window))==="object",Wr=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/"),n=t.length%4===0?"":"=".repeat(4-t.length%4),i=e+n;return Pn?atob(i):Buffer.from(i,"base64").toString()},Ls=function(t){var e="";return Pn?e=btoa(t):e=Buffer.from(t).toString("base64"),e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},Ns=function(t){return t&&t.indexOf("http://")===0||t.indexOf("https://")===0},Fs=function(t){var e,n,i;if(!Ns(t)&&typeof window<"u"){var a=(e=window==null?void 0:window.location)===null||e===void 0?void 0:e.hostname,o=(n=window==null?void 0:window.location)===null||n===void 0?void 0:n.port,u=(i=window==null?void 0:window.location)===null||i===void 0?void 0:i.protocol.replace(":","");if(a&&o&&u)return u+"://"+a+":"+o+t}return t},zn;function js(r,t){zn||(zn=new Ably.Rest.Platform.Http),Pn?delete r.headers["Content-Length"]:r.method=r.method.toLowerCase(),zn.doUri(r.method,null,r.uri,r.headers,r.body,r.paramsIfNoHeaders||{},t)}var Us=function(t){return new Promise(function(e,n){js(t,function(i,a){if(i)n(i);else if(typeof a=="string")e(JSON.parse(a));else if(!Pn&&Buffer.isBuffer(a))try{e(JSON.parse(a.toString()))}catch{e(a)}else e(a)})})},Vr=!1,Bs=function(t,e){var n=t.channels.get("dummy");if(n.__proto__.authorizeChannel=e,Vr)return;var i=n.__proto__._attach;if(ks(i)){console.warn("Failed to enable authorize for pre-attach, please check for right library version");return}function a(o,u,d){var h=this;if(!this.authorizing){this.authorizing=!0;var m=i.bind(this);this.authorizeChannel(this,function(C){if(h.authorizing=!1,C){d?d(C):console.error("channel ".concat(h.name," auth error => ").concat(C));return}else m(o,u,d)})}}n.__proto__._attach=a,Vr=!0},Hs=Ce(function r(){var t=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;be(this,r),this.execute=function(i){return new Promise(function(a,o){t.queue.run(function(){return bn(t,void 0,void 0,ot().mark(function u(){var d,h,m;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,w.next=3,i(this.cachedToken);case 3:d=w.sent,h=d.token,m=d.info,this.cachedToken=h,a({token:h,info:m}),w.next=13;break;case 10:w.prev=10,w.t0=w.catch(0),o(w.t0);case 13:case"end":return w.stop()}},u,this,[[0,10]])}))})})},this.request=function(i){return t.execute(function(a){return t.requestTokenFn(i,a)})},this.cachedToken=e,this.requestTokenFn=n,this.queue=new Gs}),Gs=Ce(function r(){var t=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;be(this,r),this.canRunNext=function(){return t.running.length<t.count&&t.todo.length},this.run=function(i){return bn(t,void 0,void 0,ot().mark(function a(){var o;return ot().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:i&&this.todo.push(i);case 1:if(!this.canRunNext()){d.next=9;break}return o=this.todo.shift(),this.running.push(o),d.next=6,o();case 6:this.running.shift(),d.next=1;break;case 9:case"end":return d.stop()}},a,this)}))},this.total=e.length,this.todo=e,this.running=[],this.count=n}),$s=Ce(function r(t,e){var n=this;be(this,r),this.expiredAuthChannels=new Set,this.setExpired=function(d){return n.expiredAuthChannels.add(d)},this.isExpired=function(d){return n.expiredAuthChannels.has(d)},this.removeExpired=function(d){return n.expiredAuthChannels.delete(d)},this.options={queryTime:!0,useTokenAuth:!0,authCallback:function(h,m){return bn(n,void 0,void 0,ot().mark(function C(){var w,M,l;return ot().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,T.next=3,this.authRequestExecuter.request(null);case 3:w=T.sent,M=w.token,l=Vn(M),m(null,l),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(0),m(T.t0,null);case 12:case"end":return T.stop()}},C,this,[[0,9]])}))},echoMessages:!1},this.requestToken=function(d,h){return bn(n,void 0,void 0,ot().mark(function m(){var C,w;return ot().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return C=JSON.stringify({channel_name:d,token:h}),w={uri:this.authEndpoint,method:"POST",headers:Qe({Accept:"application/json","Content-Type":"application/json","Content-Length":C.length},this.authHeaders),body:C},l.next=4,Us(w);case 4:return l.abrupt("return",l.sent);case 5:case"end":return l.stop()}},m,this)}))},this.ablyClient=function(){return n.ablyConnector.ably},this.existingToken=function(){return n.ablyClient().auth.tokenDetails},this.getChannel=function(d){return n.ablyConnector.channels[d]},this.enableAuthorizeBeforeChannelAttach=function(){var d=n.ablyClient();d.auth.getTimestamp(n.options.queryTime,function(){}),Bs(d,function(h,m){var C=h.name;if(C.startsWith("public:")){m(null);return}var w=n.existingToken();if(w&&!n.isExpired(C)){var M=qi(w.token).payload["x-ably-capability"],l=M.includes("".concat(C,'"'));if(l&&w.expires>d.auth.getTimestampUsingOffset()){m(null);return}}n.authRequestExecuter.request(C).then(function(A){var T=A.token,x=A.info,b=n.getChannel(C);n.setPresenceInfo(b,x),n.tryAuthorizeOnSameConnection(Qe(Qe({},n.options),{token:Vn(T)}),function(y,R){y?m(y):(n.removeExpired(C),m(null))})}).catch(function(A){return m(A)})})},this.allowReconnectOnUserLogin=function(){var d=n.ablyClient().connection,h=function(C){C.reason.code==40102&&(d.off(h),console.warn("User login detected, re-connecting again!"),n.onClientIdChanged())};d.on("failed",h)},this.onClientIdChanged=function(){n.ablyClient().connect();for(var d=0,h=Object.values(n.ablyConnector.channels);d<h.length;d++){var m=h[d];m.channel.attach(m._alertErrorListeners)}},this.tryAuthorizeOnSameConnection=function(d,h){n.ablyClient().auth.authorize(null,d,h)},this.onChannelFailed=function(d){return function(h){var m;((m=h.reason)===null||m===void 0?void 0:m.code)==40160&&n.handleChannelAuthError(d)}},this.handleChannelAuthError=function(d){if(!d.skipAuth){var h=d.name;n.authRequestExecuter.request(h).then(function(m){var C=m.token,w=m.info;n.setPresenceInfo(d,w),n.tryAuthorizeOnSameConnection(Qe(Qe({},n.options),{token:Vn(C)}),function(M,l){M?d._alertErrorListeners(M):(d.skipAuth=!0,d.channel.once("attached",function(){d.skipAuth=!1}),d.channel.attach(d._alertErrorListeners))})}).catch(function(m){return d._alertErrorListeners(m)})}},this.setPresenceInfo=function(d,h){d instanceof Ji&&(d.presenceData=h)},this.ablyConnector=t;var i=e.authEndpoint,a=e.auth.headers,o=e.token,u=e.requestTokenFn;this.authEndpoint=Fs(i),this.authHeaders=a,this.authRequestExecuter=new Hs(o,u??this.requestToken)}),kn=function(r){function t(e,n,i){var a;return be(this,t),a=Ie(this,t),a.name=n,a.pusher=e,a.options=i,a.eventFormatter=new Ar(a.options.namespace),a.subscribe(),a}return De(t,r),Ce(t,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(n,i){return this.on(this.eventFormatter.format(n),i),this}},{key:"listenToAll",value:function(n){var i=this;return this.subscription.bind_global(function(a,o){if(!a.startsWith("pusher:")){var u=i.options.namespace.replace(/\./g,"\\"),d=a.startsWith(u)?a.substring(u.length+1):"."+a;n(d,o)}}),this}},{key:"stopListening",value:function(n,i){return i?this.subscription.unbind(this.eventFormatter.format(n),i):this.subscription.unbind(this.eventFormatter.format(n)),this}},{key:"stopListeningToAll",value:function(n){return n?this.subscription.unbind_global(n):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(n){return this.on("pusher:subscription_succeeded",function(){n()}),this}},{key:"error",value:function(n){return this.on("pusher:subscription_error",function(i){n(i)}),this}},{key:"on",value:function(n,i){return this.subscription.bind(n,i),this}}])}(_n),Ws=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"whisper",value:function(n,i){return this.pusher.channels.channels[this.name].trigger("client-".concat(n),i),this}}])}(kn),Vs=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"whisper",value:function(n,i){return this.pusher.channels.channels[this.name].trigger("client-".concat(n),i),this}}])}(kn),zs=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"here",value:function(n){return this.on("pusher:subscription_succeeded",function(i){n(Object.keys(i.members).map(function(a){return i.members[a]}))}),this}},{key:"joining",value:function(n){return this.on("pusher:member_added",function(i){n(i.info)}),this}},{key:"whisper",value:function(n,i){return this.pusher.channels.channels[this.name].trigger("client-".concat(n),i),this}},{key:"leaving",value:function(n){return this.on("pusher:member_removed",function(i){n(i.info)}),this}}])}(kn),Qi=function(r){function t(e,n,i){var a;return be(this,t),a=Ie(this,t),a.events={},a.listeners={},a.name=n,a.socket=e,a.options=i,a.eventFormatter=new Ar(a.options.namespace),a.subscribe(),a}return De(t,r),Ce(t,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(n,i){return this.on(this.eventFormatter.format(n),i),this}},{key:"stopListening",value:function(n,i){return this.unbindEvent(this.eventFormatter.format(n),i),this}},{key:"subscribed",value:function(n){return this.on("connect",function(i){n(i)}),this}},{key:"error",value:function(n){return this}},{key:"on",value:function(n,i){var a=this;return this.listeners[n]=this.listeners[n]||[],this.events[n]||(this.events[n]=function(o,u){a.name===o&&a.listeners[n]&&a.listeners[n].forEach(function(d){return d(u)})},this.socket.on(n,this.events[n])),this.listeners[n].push(i),this}},{key:"unbind",value:function(){var n=this;Object.keys(this.events).forEach(function(i){n.unbindEvent(i)})}},{key:"unbindEvent",value:function(n,i){this.listeners[n]=this.listeners[n]||[],i&&(this.listeners[n]=this.listeners[n].filter(function(a){return a!==i})),(!i||this.listeners[n].length===0)&&(this.events[n]&&(this.socket.removeListener(n,this.events[n]),delete this.events[n]),delete this.listeners[n])}}])}(_n),Xi=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"whisper",value:function(n,i){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(n),data:i}),this}}])}(Qi),Ys=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"here",value:function(n){return this.on("presence:subscribed",function(i){n(i.map(function(a){return a.user_info}))}),this}},{key:"joining",value:function(n){return this.on("presence:joining",function(i){return n(i.user_info)}),this}},{key:"whisper",value:function(n,i){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(n),data:i}),this}},{key:"leaving",value:function(n){return this.on("presence:leaving",function(i){return n(i.user_info)}),this}}])}(Xi),Cn=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(n,i){return this}},{key:"listenToAll",value:function(n){return this}},{key:"stopListening",value:function(n,i){return this}},{key:"subscribed",value:function(n){return this}},{key:"error",value:function(n){return this}},{key:"on",value:function(n,i){return this}}])}(_n),zr=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"whisper",value:function(n,i){return this}}])}(Cn),Ks=function(r){function t(){return be(this,t),Ie(this,t,arguments)}return De(t,r),Ce(t,[{key:"here",value:function(n){return this}},{key:"joining",value:function(n){return this}},{key:"whisper",value:function(n,i){return this}},{key:"leaving",value:function(n){return this}}])}(Cn),Ln=function(){function r(t){be(this,r),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(t),this.connect()}return Ce(r,[{key:"setOptions",value:function(e){this.options=Qe(this._defaultOptions,e);var n=this.csrfToken();return n&&(this.options.auth.headers["X-CSRF-TOKEN"]=n,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=n),n=this.options.bearerToken,n&&(this.options.auth.headers.Authorization="Bearer "+n,this.options.userAuthentication.headers.Authorization="Bearer "+n),e}},{key:"csrfToken",value:function(){var e;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(e=document.querySelector('meta[name="csrf-token"]'))?e.getAttribute("content"):null}}])}(),Yr=function(r){function t(){var e;return be(this,t),e=Ie(this,t,arguments),e.channels={},e}return De(t,r),Ce(t,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(n,i,a){return this.channel(n).listen(i,a)}},{key:"channel",value:function(n){return this.channels[n]||(this.channels[n]=new kn(this.pusher,n,this.options)),this.channels[n]}},{key:"privateChannel",value:function(n){return this.channels["private-"+n]||(this.channels["private-"+n]=new Ws(this.pusher,"private-"+n,this.options)),this.channels["private-"+n]}},{key:"encryptedPrivateChannel",value:function(n){return this.channels["private-encrypted-"+n]||(this.channels["private-encrypted-"+n]=new Vs(this.pusher,"private-encrypted-"+n,this.options)),this.channels["private-encrypted-"+n]}},{key:"presenceChannel",value:function(n){return this.channels["presence-"+n]||(this.channels["presence-"+n]=new zs(this.pusher,"presence-"+n,this.options)),this.channels["presence-"+n]}},{key:"leave",value:function(n){var i=this,a=[n,"private-"+n,"private-encrypted-"+n,"presence-"+n];a.forEach(function(o,u){i.leaveChannel(o)})}},{key:"leaveChannel",value:function(n){this.channels[n]&&(this.channels[n].unsubscribe(),delete this.channels[n])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}])}(Ln),Js=function(r){function t(){var e;return be(this,t),e=Ie(this,t,arguments),e.channels={},e}return De(t,r),Ce(t,[{key:"connect",value:function(){var n=this,i=this.getSocketIO();return this.socket=i(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(n.channels).forEach(function(a){a.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(n,i,a){return this.channel(n).listen(i,a)}},{key:"channel",value:function(n){return this.channels[n]||(this.channels[n]=new Qi(this.socket,n,this.options)),this.channels[n]}},{key:"privateChannel",value:function(n){return this.channels["private-"+n]||(this.channels["private-"+n]=new Xi(this.socket,"private-"+n,this.options)),this.channels["private-"+n]}},{key:"presenceChannel",value:function(n){return this.channels["presence-"+n]||(this.channels["presence-"+n]=new Ys(this.socket,"presence-"+n,this.options)),this.channels["presence-"+n]}},{key:"leave",value:function(n){var i=this,a=[n,"private-"+n,"presence-"+n];a.forEach(function(o){i.leaveChannel(o)})}},{key:"leaveChannel",value:function(n){this.channels[n]&&(this.channels[n].unsubscribe(),delete this.channels[n])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}])}(Ln),qs=function(r){function t(){var e;return be(this,t),e=Ie(this,t,arguments),e.channels={},e}return De(t,r),Ce(t,[{key:"connect",value:function(){}},{key:"listen",value:function(n,i,a){return new Cn}},{key:"channel",value:function(n){return new Cn}},{key:"privateChannel",value:function(n){return new zr}},{key:"encryptedPrivateChannel",value:function(n){return new zr}},{key:"presenceChannel",value:function(n){return new Ks}},{key:"leave",value:function(n){}},{key:"leaveChannel",value:function(n){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}])}(Ln),Zi=function(r){function t(){var e;return be(this,t),e=Ie(this,t,arguments),e.channels={},e}return De(t,r),Ce(t,[{key:"connect",value:function(){typeof this.options.client<"u"?this.ably=this.options.client:(this.ablyAuth=new $s(this,this.options),this.options.agents||(this.options.agents={}),this.options.agents["laravel-echo"]=t.LIB_VERSION,this.ably=new Ably.Realtime(Qe(Qe({},this.ablyAuth.options),this.options)),this.ablyAuth.enableAuthorizeBeforeChannelAttach(),this.ablyAuth.allowReconnectOnUserLogin())}},{key:"listen",value:function(n,i,a){return this.channel(n).listen(i,a)}},{key:"channel",value:function(n){var i="public:".concat(n);return this.channels[i]||(this.channels[i]=new Er(this.ably,i,this.options)),this.channels[i]}},{key:"privateChannel",value:function(n){var i="private:".concat(n);return this.channels[i]||(this.channels[i]=new Ps(this.ably,i,this.options,this.ablyAuth)),this.channels[i]}},{key:"presenceChannel",value:function(n){var i="presence:".concat(n);return this.channels[i]||(this.channels[i]=new Ji(this.ably,i,this.options,this.ablyAuth)),this.channels[i]}},{key:"leave",value:function(n){var i=this,a=["public:".concat(n),"private:".concat(n),"presence:".concat(n)];a.forEach(function(o,u){i.leaveChannel(o)})}},{key:"leaveChannel",value:function(n){if(n.indexOf("public:")!==0&&n.indexOf("private:")!==0&&n.indexOf("presence:")!==0)throw new Error("Error leaving ".concat(n,', name should be prefixed with either "public:", "private:" or "presence:"'));this.channels[n]&&(this.channels[n].unsubscribe(),this.ablyAuth.setExpired(n),delete this.channels[n])}},{key:"socketId",value:function(){var n,i={connectionKey:this.ably.connection.key,clientId:(n=this.ably.auth.clientId)!==null&&n!==void 0?n:null};return Ls(JSON.stringify(i))}},{key:"disconnect",value:function(){this.ably.close()}}])}(Ln);Zi.LIB_VERSION="1.0.6";var sf=function(){function r(t){be(this,r),this.options=t,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return Ce(r,[{key:"channel",value:function(e){return this.connector.channel(e)}},{key:"connect",value:function(){if(this.options.broadcaster=="ably")this.connector=new Zi(this.options);else if(this.options.broadcaster=="reverb")this.connector=new Yr(Qe(Qe({},this.options),{cluster:""}));else if(this.options.broadcaster=="pusher")this.connector=new Yr(this.options);else if(this.options.broadcaster=="socket.io")this.connector=new Js(this.options);else if(this.options.broadcaster=="null")this.connector=new qs(this.options);else if(typeof this.options.broadcaster=="function")this.connector=new this.options.broadcaster(this.options);else throw new Error("Broadcaster ".concat($t(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(e){return this.connector.presenceChannel(e)}},{key:"leave",value:function(e){this.connector.leave(e)}},{key:"leaveChannel",value:function(e){this.connector.leaveChannel(e)}},{key:"leaveAllChannels",value:function(){for(var e in this.connector.channels)this.leaveChannel(e)}},{key:"listen",value:function(e,n,i){return this.connector.listen(e,n,i)}},{key:"private",value:function(e){return this.connector.privateChannel(e)}},{key:"encryptedPrivate",value:function(e){return this.connector.encryptedPrivateChannel(e)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":$t(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var e=this;Vue.http.interceptors.push(function(n,i){e.socketId()&&n.headers.set("X-Socket-ID",e.socketId()),i()})}},{key:"registerAxiosRequestInterceptor",value:function(){var e=this;axios.interceptors.request.use(function(n){return e.socketId()&&(n.headers["X-Socket-Id"]=e.socketId()),n})}},{key:"registerjQueryAjaxSetup",value:function(){var e=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(n,i,a){e.socketId()&&a.setRequestHeader("X-Socket-Id",e.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var e=this;document.addEventListener("turbo:before-fetch-request",function(n){n.detail.fetchOptions.headers["X-Socket-Id"]=e.socketId()})}}])}(),Kt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tr(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var eo={exports:{}};/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.50
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */(function(r,t){(function(n,i){r.exports=i()})(window,function(){return function(e){var n={};function i(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=n,i.d=function(a,o,u){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(o&1&&(a=i(a)),o&8||o&4&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),o&2&&typeof a!="string")for(var d in a)i.d(u,d,(function(h){return a[h]}).bind(null,d));return u},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=42)}([function(e,n,i){i.r(n),i.d(n,"__extends",function(){return o}),i.d(n,"__assign",function(){return u}),i.d(n,"__rest",function(){return d}),i.d(n,"__decorate",function(){return h}),i.d(n,"__param",function(){return m}),i.d(n,"__metadata",function(){return C}),i.d(n,"__awaiter",function(){return w}),i.d(n,"__generator",function(){return M}),i.d(n,"__createBinding",function(){return l}),i.d(n,"__exportStar",function(){return A}),i.d(n,"__values",function(){return T}),i.d(n,"__read",function(){return x}),i.d(n,"__spread",function(){return b}),i.d(n,"__spreadArrays",function(){return y}),i.d(n,"__spreadArray",function(){return R}),i.d(n,"__await",function(){return p}),i.d(n,"__asyncGenerator",function(){return f}),i.d(n,"__asyncDelegator",function(){return c}),i.d(n,"__asyncValues",function(){return s}),i.d(n,"__makeTemplateObject",function(){return v}),i.d(n,"__importStar",function(){return S}),i.d(n,"__importDefault",function(){return L}),i.d(n,"__classPrivateFieldGet",function(){return k}),i.d(n,"__classPrivateFieldSet",function(){return _});/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var a=function(I,O){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,P){E.__proto__=P}||function(E,P){for(var F in P)Object.prototype.hasOwnProperty.call(P,F)&&(E[F]=P[F])},a(I,O)};function o(I,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");a(I,O);function E(){this.constructor=I}I.prototype=O===null?Object.create(O):(E.prototype=O.prototype,new E)}var u=function(){return u=Object.assign||function(O){for(var E,P=1,F=arguments.length;P<F;P++){E=arguments[P];for(var B in E)Object.prototype.hasOwnProperty.call(E,B)&&(O[B]=E[B])}return O},u.apply(this,arguments)};function d(I,O){var E={};for(var P in I)Object.prototype.hasOwnProperty.call(I,P)&&O.indexOf(P)<0&&(E[P]=I[P]);if(I!=null&&typeof Object.getOwnPropertySymbols=="function")for(var F=0,P=Object.getOwnPropertySymbols(I);F<P.length;F++)O.indexOf(P[F])<0&&Object.prototype.propertyIsEnumerable.call(I,P[F])&&(E[P[F]]=I[P[F]]);return E}function h(I,O,E,P){var F=arguments.length,B=F<3?O:P===null?P=Object.getOwnPropertyDescriptor(O,E):P,z;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(I,O,E,P);else for(var Y=I.length-1;Y>=0;Y--)(z=I[Y])&&(B=(F<3?z(B):F>3?z(O,E,B):z(O,E))||B);return F>3&&B&&Object.defineProperty(O,E,B),B}function m(I,O){return function(E,P){O(E,P,I)}}function C(I,O){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,O)}function w(I,O,E,P){function F(B){return B instanceof E?B:new E(function(z){z(B)})}return new(E||(E=Promise))(function(B,z){function Y(N){try{D(P.next(N))}catch(j){z(j)}}function $(N){try{D(P.throw(N))}catch(j){z(j)}}function D(N){N.done?B(N.value):F(N.value).then(Y,$)}D((P=P.apply(I,O||[])).next())})}function M(I,O){var E={label:0,sent:function(){if(B[0]&1)throw B[1];return B[1]},trys:[],ops:[]},P,F,B,z;return z={next:Y(0),throw:Y(1),return:Y(2)},typeof Symbol=="function"&&(z[Symbol.iterator]=function(){return this}),z;function Y(D){return function(N){return $([D,N])}}function $(D){if(P)throw new TypeError("Generator is already executing.");for(;E;)try{if(P=1,F&&(B=D[0]&2?F.return:D[0]?F.throw||((B=F.return)&&B.call(F),0):F.next)&&!(B=B.call(F,D[1])).done)return B;switch(F=0,B&&(D=[D[0]&2,B.value]),D[0]){case 0:case 1:B=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,F=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(B=E.trys,!(B=B.length>0&&B[B.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){E.label=D[1];break}if(D[0]===6&&E.label<B[1]){E.label=B[1],B=D;break}if(B&&E.label<B[2]){E.label=B[2],E.ops.push(D);break}B[2]&&E.ops.pop(),E.trys.pop();continue}D=O.call(I,E)}catch(N){D=[6,N],F=0}finally{P=B=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}}var l=Object.create?function(I,O,E,P){P===void 0&&(P=E),Object.defineProperty(I,P,{enumerable:!0,get:function(){return O[E]}})}:function(I,O,E,P){P===void 0&&(P=E),I[P]=O[E]};function A(I,O){for(var E in I)E!=="default"&&!Object.prototype.hasOwnProperty.call(O,E)&&l(O,I,E)}function T(I){var O=typeof Symbol=="function"&&Symbol.iterator,E=O&&I[O],P=0;if(E)return E.call(I);if(I&&typeof I.length=="number")return{next:function(){return I&&P>=I.length&&(I=void 0),{value:I&&I[P++],done:!I}}};throw new TypeError(O?"Object is not iterable.":"Symbol.iterator is not defined.")}function x(I,O){var E=typeof Symbol=="function"&&I[Symbol.iterator];if(!E)return I;var P=E.call(I),F,B=[],z;try{for(;(O===void 0||O-- >0)&&!(F=P.next()).done;)B.push(F.value)}catch(Y){z={error:Y}}finally{try{F&&!F.done&&(E=P.return)&&E.call(P)}finally{if(z)throw z.error}}return B}function b(){for(var I=[],O=0;O<arguments.length;O++)I=I.concat(x(arguments[O]));return I}function y(){for(var I=0,O=0,E=arguments.length;O<E;O++)I+=arguments[O].length;for(var P=Array(I),F=0,O=0;O<E;O++)for(var B=arguments[O],z=0,Y=B.length;z<Y;z++,F++)P[F]=B[z];return P}function R(I,O,E){if(E||arguments.length===2)for(var P=0,F=O.length,B;P<F;P++)(B||!(P in O))&&(B||(B=Array.prototype.slice.call(O,0,P)),B[P]=O[P]);return I.concat(B||Array.prototype.slice.call(O))}function p(I){return this instanceof p?(this.v=I,this):new p(I)}function f(I,O,E){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var P=E.apply(I,O||[]),F,B=[];return F={},z("next"),z("throw"),z("return"),F[Symbol.asyncIterator]=function(){return this},F;function z(G){P[G]&&(F[G]=function(K){return new Promise(function(Z,ee){B.push([G,K,Z,ee])>1||Y(G,K)})})}function Y(G,K){try{$(P[G](K))}catch(Z){j(B[0][3],Z)}}function $(G){G.value instanceof p?Promise.resolve(G.value.v).then(D,N):j(B[0][2],G)}function D(G){Y("next",G)}function N(G){Y("throw",G)}function j(G,K){G(K),B.shift(),B.length&&Y(B[0][0],B[0][1])}}function c(I){var O,E;return O={},P("next"),P("throw",function(F){throw F}),P("return"),O[Symbol.iterator]=function(){return this},O;function P(F,B){O[F]=I[F]?function(z){return(E=!E)?{value:p(I[F](z)),done:F==="return"}:B?B(z):z}:B}}function s(I){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var O=I[Symbol.asyncIterator],E;return O?O.call(I):(I=typeof T=="function"?T(I):I[Symbol.iterator](),E={},P("next"),P("throw"),P("return"),E[Symbol.asyncIterator]=function(){return this},E);function P(B){E[B]=I[B]&&function(z){return new Promise(function(Y,$){z=I[B](z),F(Y,$,z.done,z.value)})}}function F(B,z,Y,$){Promise.resolve($).then(function(D){B({value:D,done:Y})},z)}}function v(I,O){return Object.defineProperty?Object.defineProperty(I,"raw",{value:O}):I.raw=O,I}var g=Object.create?function(I,O){Object.defineProperty(I,"default",{enumerable:!0,value:O})}:function(I,O){I.default=O};function S(I){if(I&&I.__esModule)return I;var O={};if(I!=null)for(var E in I)E!=="default"&&Object.prototype.hasOwnProperty.call(I,E)&&l(O,I,E);return g(O,I),O}function L(I){return I&&I.__esModule?I:{default:I}}function k(I,O,E,P){if(E==="a"&&!P)throw new TypeError("Private accessor was defined without a getter");if(typeof O=="function"?I!==O||!P:!O.has(I))throw new TypeError("Cannot read private member from an object whose class did not declare it");return E==="m"?P:E==="a"?P.call(I):P?P.value:O.get(I)}function _(I,O,E,P,F){if(P==="m")throw new TypeError("Private method is not writable");if(P==="a"&&!F)throw new TypeError("Private accessor was defined without a setter");if(typeof O=="function"?I!==O||!F:!O.has(I))throw new TypeError("Cannot write private member to an object whose class did not declare it");return P==="a"?F.call(I,E):F?F.value=E:O.set(I,E),E}},function(e,n,i){(function(a){Object.defineProperty(n,"__esModule",{value:!0}),n.allToUpperCase=n.allToLowerCase=n.encodeBody=n.decodeBody=n.Format=n.promisify=n.trim=n.arrChooseN=n.randomHexString=n.randomString=n.cheapRandStr=n.dataSizeBytes=n.inspectBody=n.inspectError=n.isErrorInfoOrPartialErrorInfo=n.now=n.parseQueryString=n.toQueryString=n.arrPopRandomElement=n.defaultPostHeaders=n.defaultGetHeaders=n.allSame=n.arrEvery=n.arrFilter=n.arrMap=n.safeArrForEach=n.arrForEach=n.forInOwnNonNullProperties=n.valuesArray=n.keysArray=n.arrWithoutValue=n.arrDeleteValue=n.arrIn=n.arrIndexOf=n.arrSubtract=n.arrIntersectOb=n.arrIntersect=n.intersect=n.containsValue=n.inherits=n.prototypicalClone=n.shallowClone=n.isEmptyArg=n.isOnlyPropIn=n.isEmpty=n.isObject=n.ensureArray=n.isArray=n.copy=n.mixin=void 0,n.arrEquals=n.toBase64=n.matchDerivedChannel=n.shallowEquals=n.getGlobalObject=n.getRetryTime=n.getJitterCoefficient=n.getBackoffCoefficient=void 0;var o=i(0),u=o.__importDefault(i(3)),d=o.__importStar(i(8)),h=o.__importDefault(i(4)),m=i(11),C=i(31);function w(W){return Math.floor(Math.random()*W.length)}function M(W){for(var Q=[],X=1;X<arguments.length;X++)Q[X-1]=arguments[X];for(var oe=0;oe<Q.length;oe++){var de=Q[oe];if(!de)break;var _e=Object.prototype.hasOwnProperty;for(var ht in de)(!_e||_e.call(de,ht))&&(W[ht]=de[ht])}return W}n.mixin=M;function l(W){return M({},W)}n.copy=l,n.isArray=Array.isArray||function(W){return Object.prototype.toString.call(W)=="[object Array]"};function A(W){return y(W)?[]:(0,n.isArray)(W)?W:[W]}n.ensureArray=A;function T(W){return Object.prototype.toString.call(W)=="[object Object]"}n.isObject=T;function x(W){for(var Q in W)return!1;return!0}n.isEmpty=x;function b(W,Q){for(var X in W)if(X!==Q)return!1;return!0}n.isOnlyPropIn=b;function y(W){return W==null}n.isEmptyArg=y;function R(W){var Q=new Object;for(var X in W)Q[X]=W[X];return Q}n.shallowClone=R;function p(W,Q){var X=function(){function de(){}return de}();X.prototype=W;var oe=new X;return Q&&M(oe,Q),oe}n.prototypicalClone=p;var f=function(W,Q){if(u.default.Config.inherits){u.default.Config.inherits(W,Q);return}W.super_=Q,W.prototype=p(Q.prototype,{constructor:W})};n.inherits=f;function c(W,Q){for(var X in W)if(W[X]==Q)return!0;return!1}n.containsValue=c;function s(W,Q){return(0,n.isArray)(Q)?v(W,Q):g(W,Q)}n.intersect=s;function v(W,Q){for(var X=[],oe=0;oe<W.length;oe++){var de=W[oe];(0,n.arrIndexOf)(Q,de)!=-1&&X.push(de)}return X}n.arrIntersect=v;function g(W,Q){for(var X=[],oe=0;oe<W.length;oe++){var de=W[oe];de in Q&&X.push(de)}return X}n.arrIntersectOb=g;function S(W,Q){for(var X=[],oe=0;oe<W.length;oe++){var de=W[oe];(0,n.arrIndexOf)(Q,de)==-1&&X.push(de)}return X}n.arrSubtract=S,n.arrIndexOf=Array.prototype.indexOf?function(W,Q,X){return W.indexOf(Q,X)}:function(W,Q,X){X=X||0;for(var oe=W.length;X<oe;X++)if(W[X]===Q)return X;return-1};function L(W,Q){return(0,n.arrIndexOf)(W,Q)!==-1}n.arrIn=L;function k(W,Q){var X=(0,n.arrIndexOf)(W,Q),oe=X!=-1;return oe&&W.splice(X,1),oe}n.arrDeleteValue=k;function _(W,Q){var X=W.slice();return k(X,Q),X}n.arrWithoutValue=_;function I(W,Q){var X=[];for(var oe in W)Q&&!Object.prototype.hasOwnProperty.call(W,oe)||X.push(oe);return X}n.keysArray=I;function O(W,Q){var X=[];for(var oe in W)Q&&!Object.prototype.hasOwnProperty.call(W,oe)||X.push(W[oe]);return X}n.valuesArray=O;function E(W,Q){for(var X in W)Object.prototype.hasOwnProperty.call(W,X)&&W[X]&&Q(X)}n.forInOwnNonNullProperties=E,n.arrForEach=Array.prototype.forEach?function(W,Q){W.forEach(Q)}:function(W,Q){for(var X=W.length,oe=0;oe<X;oe++)Q(W[oe],oe,W)};function P(W,Q){return(0,n.arrForEach)(W.slice(),Q)}n.safeArrForEach=P,n.arrMap=Array.prototype.map?function(W,Q){return W.map(Q)}:function(W,Q){for(var X=[],oe=W.length,de=0;de<oe;de++)X.push(Q(W[de],de,W));return X},n.arrFilter=Array.prototype.filter?function(W,Q){return W.filter(Q)}:function(W,Q){for(var X=[],oe=W.length,de=0;de<oe;de++)Q(W[de])&&X.push(W[de]);return X},n.arrEvery=Array.prototype.every?function(W,Q){return W.every(Q)}:function(W,Q){for(var X=W.length,oe=0;oe<X;oe++)if(!Q(W[oe],oe,W))return!1;return!0};function F(W,Q){if(W.length===0)return!0;var X=W[0][Q];return(0,n.arrEvery)(W,function(oe){return oe[Q]===X})}n.allSame=F;var B={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function z(W,Q){var X=B[Q||me.json];return{accept:X,"X-Ably-Version":d.default.protocolVersion.toString(),"Ably-Agent":(0,d.getAgentString)(W)}}n.defaultGetHeaders=z;function Y(W,Q){var X,oe=X=B[Q||me.json];return{accept:oe,"content-type":X,"X-Ably-Version":d.default.protocolVersion.toString(),"Ably-Agent":(0,d.getAgentString)(W)}}n.defaultPostHeaders=Y;function $(W){return W.splice(w(W),1)[0]}n.arrPopRandomElement=$;function D(W){var Q=[];if(W)for(var X in W)Q.push(encodeURIComponent(X)+"="+encodeURIComponent(W[X]));return Q.length?"?"+Q.join("&"):""}n.toQueryString=D;function N(W){for(var Q,X=/([^?&=]+)=?([^&]*)/g,oe={};Q=X.exec(W);)oe[decodeURIComponent(Q[1])]=decodeURIComponent(Q[2]);return oe}n.parseQueryString=N,n.now=Date.now||function(){return new Date().getTime()};function j(W){return typeof W=="object"&&W!==null&&(W.constructor.name=="ErrorInfo"||W.constructor.name=="PartialErrorInfo")}n.isErrorInfoOrPartialErrorInfo=j;function G(W){var Q,X;return W instanceof Error||((Q=W==null?void 0:W.constructor)===null||Q===void 0?void 0:Q.name)==="ErrorInfo"||((X=W==null?void 0:W.constructor)===null||X===void 0?void 0:X.name)==="PartialErrorInfo"?W.toString():u.default.Config.inspect(W)}n.inspectError=G;function K(W){return u.default.BufferUtils.isBuffer(W)?W.toString():typeof W=="string"?W:u.default.Config.inspect(W)}n.inspectBody=K;function Z(W){if(u.default.BufferUtils.isBuffer(W))return u.default.BufferUtils.byteLength(W);if(typeof W=="string")return u.default.Config.stringByteSize(W);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+typeof W)}n.dataSizeBytes=Z;function ee(){return String(Math.random()).substr(2)}n.cheapRandStr=ee;var ie=function(W){if(u.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Q=new Uint8Array(W);return u.default.Config.getRandomValues(Q),u.default.BufferUtils.base64Encode(Q)}for(var X=u.default.BufferUtils.base64CharSet,oe=Math.round(W*4/3),de="",_e=0;_e<oe;_e++)de+=X[w(X)];return de};n.randomString=ie;var ue=function(W){if(u.default.Config.getRandomValues&&typeof Uint8Array<"u"){var Q=new Uint8Array(W);return u.default.Config.getRandomValues(Q),u.default.BufferUtils.hexEncode(Q)}for(var X=u.default.BufferUtils.hexCharSet,oe=W*2,de="",_e=0;_e<oe;_e++)de+=X[w(X)];return de};n.randomHexString=ue;function pe(W,Q){for(var X=Math.min(Q,W.length),oe=W.slice(),de=[],_e=0;_e<X;_e++)de.push($(oe));return de}n.arrChooseN=pe,n.trim=String.prototype.trim?function(W){return W.trim()}:function(W){return W.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function ne(W,Q,X){return new Promise(function(oe,de){W[Q].apply(W,o.__spreadArray(o.__spreadArray([],X,!1),[function(_e,ht){_e?de(_e):oe(ht)}],!1))})}n.promisify=ne;var me;(function(W){W.msgpack="msgpack",W.json="json"})(me=n.Format||(n.Format={}));function Te(W,Q){return Q=="msgpack"?u.default.Config.msgpack.decode(W):JSON.parse(String(W))}n.decodeBody=Te;function Me(W,Q){return Q=="msgpack"?u.default.Config.msgpack.encode(W,!0):JSON.stringify(W)}n.encodeBody=Me;function we(W){return W.map(function(Q){return Q&&Q.toLowerCase()})}n.allToLowerCase=we;function Fe(W){return W.map(function(Q){return Q&&Q.toUpperCase()})}n.allToUpperCase=Fe;function Ot(W){return Math.min((W+2)/3,2)}n.getBackoffCoefficient=Ot;function $e(){return 1-Math.random()*.2}n.getJitterCoefficient=$e;function ft(W,Q){return W*Ot(Q)*$e()}n.getRetryTime=ft;function dt(){return a||(typeof window<"u"?window:self)}n.getGlobalObject=dt;function wt(W,Q){return Object.keys(W).every(function(X){return W[X]===Q[X]})&&Object.keys(Q).every(function(X){return Q[X]===W[X]})}n.shallowEquals=wt;function St(W){var Q=/^(\[([^?]*)(?:(.*))\])?(.+)$/,X=W.match(Q);if(!X||!X.length||X.length<5)throw new h.default("regex match failed",400,40010);if(X[2])throw new h.default("cannot use a derived option with a ".concat(X[2]," channel"),400,40010);return{qualifierParam:X[3]||"",channelName:X[4]}}n.matchDerivedChannel=St;function Fn(W){return u.default.Config.createHmac?Buffer.from(W,"ascii").toString("base64"):(0,m.stringify)((0,C.parse)(W))}n.toBase64=Fn;function qt(W,Q){return W.length===Q.length&&(0,n.arrEvery)(W,function(X,oe){return X===Q[oe]})}n.arrEquals=qt}).call(this,i(13))},function(e,n,i){(function(a){Object.defineProperty(n,"__esModule",{value:!0});var o=i(0),u=o.__importDefault(i(3)),d=a||(typeof window<"u"?window:self),h;(function(l){l[l.None=0]="None",l[l.Error=1]="Error",l[l.Major=2]="Major",l[l.Minor=3]="Minor",l[l.Micro=4]="Micro"})(h||(h={}));function m(l,A){return"".concat(l).padStart(A?3:2,"0")}function C(l){return u.default.Config.logTimestamps?function(A){var T=new Date;l(m(T.getHours())+":"+m(T.getMinutes())+":"+m(T.getSeconds())+"."+m(T.getMilliseconds(),1)+" "+A)}:l}var w=function(){var l,A,T,x;return typeof Window>"u"&&typeof WorkerGlobalScope>"u"||typeof((A=(l=d==null?void 0:d.console)===null||l===void 0?void 0:l.log)===null||A===void 0?void 0:A.apply)=="function"?(T=function(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];console.log.apply(console,b)},x=console.warn?function(){for(var b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];console.warn.apply(console,b)}:T):d!=null&&d.console.log?T=x=function(){Function.prototype.apply.call(console.log,console,arguments)}:T=x=function(){},[T,x].map(C)},M=function(){function l(){l.logLevel=l.LOG_DEFAULT}return l.initLogHandlers=function(){var A=w(),T=A[0],x=A[1];this.logHandler=T,this.logErrorHandler=x},l.renamedClientOption=function(A,T){l.deprecationWarning("The `".concat(A,"` client option has been renamed to `").concat(T,"`. Please update your code to use `").concat(T,"` instead. `").concat(A,"` will be removed in a future version."))},l.renamedMethod=function(A,T,x){l.deprecationWarning("`".concat(A,"`’s `").concat(T,"` method has been renamed to `").concat(x,"`. Please update your code to use `").concat(x,"` instead. `").concat(T,"` will be removed in a future version."))},l.deprecationWarning=function(A){l.shouldLog(h.Error)&&l.logErrorHandler("Ably: Deprecation warning - ".concat(A))},l.logLevel=h.Error,l.LOG_NONE=h.None,l.LOG_ERROR=h.Error,l.LOG_MAJOR=h.Major,l.LOG_MINOR=h.Minor,l.LOG_MICRO=h.Micro,l.LOG_DEFAULT=h.Error,l.LOG_DEBUG=h.Micro,l.logAction=function(A,T,x){l.shouldLog(A)&&(A===h.Error?l.logErrorHandler:l.logHandler)("Ably: "+T+": "+x)},l.deprecated=function(A,T){l.deprecationWarning("".concat(A," is deprecated and will be removed in a future version. ").concat(T))},l.shouldLog=function(A){return A<=l.logLevel},l.setLog=function(A,T){A!==void 0&&(l.logLevel=A),T!==void 0&&(l.logHandler=l.logErrorHandler=T)},l}();n.default=M}).call(this,i(13))},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function o(){}return o}();n.default=a},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PartialErrorInfo=void 0;var a=i(0),o=a.__importDefault(i(3)),u=a.__importStar(i(1));function d(C){var w="["+C.constructor.name;return C.message&&(w+=": "+C.message),C.statusCode&&(w+="; statusCode="+C.statusCode),C.code&&(w+="; code="+C.code),C.cause&&(w+="; cause="+u.inspectError(C.cause)),C.href&&!(C.message&&C.message.indexOf("help.ably.io")>-1)&&(w+="; see "+C.href+" "),w+="]",w}var h=function(C){a.__extends(w,C);function w(M,l,A,T){var x=C.call(this,M)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(x,w.prototype),x.code=l,x.statusCode=A,x.cause=T,x}return w.prototype.toString=function(){return d(this)},w.fromValues=function(M){var l=M,A=l.message,T=l.code,x=l.statusCode;if(typeof A!="string"||typeof T!="number"||typeof x!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+o.default.Config.inspect(M));var b=Object.assign(new w(A,T,x),M);return b.code&&!b.href&&(b.href="https://help.ably.io/error/"+b.code),b},w}(Error);n.default=h;var m=function(C){a.__extends(w,C);function w(M,l,A,T){var x=C.call(this,M)||this;return typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(x,w.prototype),x.code=l,x.statusCode=A,x.cause=T,x}return w.prototype.toString=function(){return d(this)},w}(Error);n.PartialErrorInfo=m},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(){if(typeof ArrayBuffer=="function"){var o=a,u=o.lib,d=u.WordArray,h=d.init,m=d.init=function(C){if(C instanceof ArrayBuffer&&(C=new Uint8Array(C)),(C instanceof Int8Array||typeof Uint8ClampedArray<"u"&&C instanceof Uint8ClampedArray||C instanceof Int16Array||C instanceof Uint16Array||C instanceof Int32Array||C instanceof Uint32Array||C instanceof Float32Array||C instanceof Float64Array)&&(C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength)),C instanceof Uint8Array){for(var w=C.byteLength,M=[],l=0;l<w;l++)M[l>>>2]|=C[l]<<24-l%4*8;h.call(this,M,w)}else h.apply(this,arguments)};m.prototype=d}}(),a.lib.WordArray})},function(e,n,i){(function(a){(function(o,u){e.exports=u()})(this,function(){var o=o||function(u,d){var h;if(typeof window<"u"&&window.crypto&&(h=window.crypto),!h&&typeof window<"u"&&window.msCrypto&&(h=window.msCrypto),!h&&typeof a<"u"&&a.crypto&&(h=a.crypto),!h)try{h=i(44)}catch{}var m=function(){if(h){if(typeof h.getRandomValues=="function")try{return h.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof h.randomBytes=="function")try{return h.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function f(){}return function(c){var s;return f.prototype=c,s=new f,f.prototype=null,s}}(),w={},M=w.lib={},l=M.Base=function(){return{extend:function(f){var c=C(this);return f&&c.mixIn(f),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var f=this.extend();return f.init.apply(f,arguments),f},init:function(){},mixIn:function(f){for(var c in f)f.hasOwnProperty(c)&&(this[c]=f[c]);f.hasOwnProperty("toString")&&(this.toString=f.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),A=M.WordArray=l.extend({init:function(f,c){f=this.words=f||[],c!=d?this.sigBytes=c:this.sigBytes=f.length*4},toString:function(f){return(f||x).stringify(this)},concat:function(f){var c=this.words,s=f.words,v=this.sigBytes,g=f.sigBytes;if(this.clamp(),v%4)for(var S=0;S<g;S++){var L=s[S>>>2]>>>24-S%4*8&255;c[v+S>>>2]|=L<<24-(v+S)%4*8}else for(var S=0;S<g;S+=4)c[v+S>>>2]=s[S>>>2];return this.sigBytes+=g,this},clamp:function(){var f=this.words,c=this.sigBytes;f[c>>>2]&=4294967295<<32-c%4*8,f.length=u.ceil(c/4)},clone:function(){var f=l.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var c=[],s=0;s<f;s+=4)c.push(m());return new A.init(c,f)}}),T=w.enc={},x=T.Hex={stringify:function(f){for(var c=f.words,s=f.sigBytes,v=[],g=0;g<s;g++){var S=c[g>>>2]>>>24-g%4*8&255;v.push((S>>>4).toString(16)),v.push((S&15).toString(16))}return v.join("")},parse:function(f){for(var c=f.length,s=[],v=0;v<c;v+=2)s[v>>>3]|=parseInt(f.substr(v,2),16)<<24-v%8*4;return new A.init(s,c/2)}},b=T.Latin1={stringify:function(f){for(var c=f.words,s=f.sigBytes,v=[],g=0;g<s;g++){var S=c[g>>>2]>>>24-g%4*8&255;v.push(String.fromCharCode(S))}return v.join("")},parse:function(f){for(var c=f.length,s=[],v=0;v<c;v++)s[v>>>2]|=(f.charCodeAt(v)&255)<<24-v%4*8;return new A.init(s,c)}},y=T.Utf8={stringify:function(f){try{return decodeURIComponent(escape(b.stringify(f)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(f){return b.parse(unescape(encodeURIComponent(f)))}},R=M.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new A.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=y.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var c,s=this._data,v=s.words,g=s.sigBytes,S=this.blockSize,L=S*4,k=g/L;f?k=u.ceil(k):k=u.max((k|0)-this._minBufferSize,0);var _=k*S,I=u.min(_*4,g);if(_){for(var O=0;O<_;O+=S)this._doProcessBlock(v,O);c=v.splice(0,_),s.sigBytes-=I}return new A.init(c,I)},clone:function(){var f=l.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0});M.Hasher=R.extend({cfg:l.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){f&&this._append(f);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(f){return function(c,s){return new f.init(s).finalize(c)}},_createHmacHelper:function(f){return function(c,s){return new p.HMAC.init(f,s).finalize(c)}}});var p=w.algo={};return w}(Math);return o})}).call(this,i(13))},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(2)),d=a.__importDefault(i(3));function h(w,M,l){try{M.apply(w,l)}catch(A){u.default.logAction(u.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+A+"; stack = "+(A&&A.stack))}}function m(w,M,l){for(var A,T,x,b=0;b<w.length;b++)if(A=w[b],l&&(A=A[l]),o.isArray(A)){for(;(T=o.arrIndexOf(A,M))!==-1;)A.splice(T,1);l&&A.length===0&&delete w[b][l]}else if(o.isObject(A))for(x in A)Object.prototype.hasOwnProperty.call(A,x)&&o.isArray(A[x])&&m([A],M,x)}var C=function(){function w(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return w.prototype.on=function(){for(var M=this,l=[],A=0;A<arguments.length;A++)l[A]=arguments[A];if(l.length===1){var T=l[0];if(typeof T=="function")this.any.push(T);else throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(l))}if(l.length===2){var x=l[0],b=l[1];if(typeof b!="function")throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(l));if(o.isEmptyArg(x))this.any.push(b);else if(o.isArray(x))x.forEach(function(R){M.on(R,b)});else{if(typeof x!="string")throw new Error("EventListener.on(): Invalid arguments: "+d.default.Config.inspect(l));var y=this.events[x]||(this.events[x]=[]);y.push(b)}}},w.prototype.off=function(){for(var M,l=this,A=[],T=0;T<arguments.length;T++)A[T]=arguments[T];if(A.length==0||o.isEmptyArg(A[0])&&o.isEmptyArg(A[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}var x=A[0],b=A[1],y=null,R=null;if(A.length===1||!b)typeof x=="function"?y=x:R=x;else{if(typeof b!="function")throw new Error("EventEmitter.off(): invalid arguments:"+d.default.Config.inspect(A));M=[x,b],R=M[0],y=M[1]}if(y&&o.isEmptyArg(R)){m([this.any,this.events,this.anyOnce,this.eventsOnce],y);return}if(o.isArray(R)){R.forEach(function(p){l.off(p,y)});return}if(typeof R!="string")throw new Error("EventEmitter.off(): invalid arguments:"+d.default.Config.inspect(A));y?m([this.events,this.eventsOnce],y,R):(delete this.events[R],delete this.eventsOnce[R])},w.prototype.listeners=function(M){if(M){var l=this.events[M]||[];return this.eventsOnce[M]&&Array.prototype.push.apply(l,this.eventsOnce[M]),l.length?l:null}return this.any.length?this.any:null},w.prototype.emit=function(M){for(var l=[],A=1;A<arguments.length;A++)l[A-1]=arguments[A];var T={event:M},x=[];this.anyOnce.length&&(Array.prototype.push.apply(x,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(x,this.any);var b=this.eventsOnce[M];b&&(Array.prototype.push.apply(x,b),delete this.eventsOnce[M]);var y=this.events[M];y&&Array.prototype.push.apply(x,y),o.arrForEach(x,function(R){h(T,R,l)})},w.prototype.once=function(){for(var M=this,l=[],A=0;A<arguments.length;A++)l[A]=arguments[A];var T=l.length;if((T===0||T===1&&typeof l[0]!="function")&&d.default.Config.Promise){var x=l[0];return new d.default.Config.Promise(function(c){M.once(x,c)})}var b=l[0],y=l[1];if(l.length===1&&typeof b=="function")this.anyOnce.push(b);else if(o.isEmptyArg(b)){if(typeof y!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(l));this.anyOnce.push(y)}else if(o.isArray(b)){var R=this,p=function(){var c=Array.prototype.slice.call(arguments);if(o.arrForEach(b,function(s){R.off(s,p)}),typeof y!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(l));y.apply(this,c)};o.arrForEach(b,function(c){R.on(c,p)})}else{if(typeof b!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(l));var f=this.eventsOnce[b]||(this.eventsOnce[b]=[]);if(y){if(typeof y!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+d.default.Config.inspect(l));f.push(y)}}},w.prototype.whenState=function(M,l,A){for(var T=this,x=[],b=3;b<arguments.length;b++)x[b-3]=arguments[b];var y={event:M};if(typeof M!="string"||typeof l!="string")throw"whenState requires a valid event String argument";if(typeof A!="function"&&d.default.Config.Promise)return new d.default.Config.Promise(function(R){w.prototype.whenState.apply(T,[M,l,R].concat(x))});M===l?h(y,A,x):this.once(M,A)},w}();n.default=C},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaults=n.normaliseOptions=n.objectifyOptions=n.getAgentString=n.getHosts=n.getFallbackHosts=n.environmentFallbackHosts=n.getHttpScheme=n.getPort=n.getHost=void 0;var a=i(0),o=a.__importDefault(i(3)),u=a.__importStar(i(1)),d=a.__importDefault(i(2)),h=a.__importDefault(i(4)),m=i(43),C="ably-js/"+m.version,w={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:m.version,protocolVersion:2,agent:C,getHost:M,getPort:l,getHttpScheme:A,environmentFallbackHosts:T,getFallbackHosts:x,getHosts:b,checkHost:y,objectifyOptions:c,normaliseOptions:s};function M(g,S,L){return L?S=S==g.restHost&&g.realtimeHost||S||g.realtimeHost:S=S||g.restHost,S}n.getHost=M;function l(g,S){return S||g.tls?g.tlsPort:g.port}n.getPort=l;function A(g){return g.tls?"https://":"http://"}n.getHttpScheme=A;function T(g){return[g+"-a-fallback.ably-realtime.com",g+"-b-fallback.ably-realtime.com",g+"-c-fallback.ably-realtime.com",g+"-d-fallback.ably-realtime.com",g+"-e-fallback.ably-realtime.com"]}n.environmentFallbackHosts=T;function x(g){var S=g.fallbackHosts,L=typeof g.httpMaxRetryCount<"u"?g.httpMaxRetryCount:w.httpMaxRetryCount;return S?u.arrChooseN(S,L):[]}n.getFallbackHosts=x;function b(g){return[g.restHost].concat(x(g))}n.getHosts=b;function y(g){if(typeof g!="string")throw new h.default("host must be a string; was a "+typeof g,4e4,400);if(!g.length)throw new h.default("host must not be zero-length",4e4,400)}function R(g,S,L){return g.realtimeHost?g.realtimeHost:g.restHost?(d.default.logAction(d.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+g.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+g.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),g.restHost):S?w.REALTIME_HOST:L+"-"+w.REALTIME_HOST}function p(g){var S={};for(var L in w.TIMEOUTS)S[L]=g[L]||w.TIMEOUTS[L];return S}function f(g){var S=w.agent;if(g.agents)for(var L in g.agents)S+=" "+L+"/"+g.agents[L];return S}n.getAgentString=f;function c(g){return typeof g=="string"?g.indexOf(":")==-1?{token:g}:{key:g}:g}n.objectifyOptions=c;function s(g){if(g.host&&(d.default.renamedClientOption("host","restHost"),g.restHost=g.host),g.wsHost&&(d.default.renamedClientOption("wsHost","realtimeHost"),g.realtimeHost=g.wsHost),g.queueEvents&&(d.default.renamedClientOption("queueEvents","queueMessages"),g.queueMessages=g.queueEvents),g.headers&&d.default.deprecated("the `headers` client option",""),g.fallbackHostsUseDefault){if(g.fallbackHosts){var S="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions",S),new h.default(S,4e4,400)}if(g.port||g.tlsPort){var S="fallbackHostsUseDefault cannot be set when port or tlsPort are set";throw d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions",S),new h.default(S,4e4,400)}g.environment?d.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’ve set the `environment` client option, then this is no longer necessary: remove your usage of the `fallbackHostsUseDefault` client option and the library will then automatically choose the correct fallback hosts to use for the specified environment."):d.default.deprecated("The `fallbackHostsUseDefault` client option","If you’re using this client option to force the library to make use of fallback hosts even though you’re not using the primary Ably environment, then stop using `fallbackHostsUseDefault`, and update your code to either pass the `environment` client option (in which case the library will automatically choose the correct fallback hosts to use for the specified environment), or to pass the `fallbackHosts` client option to specify a custom list of fallback hosts to use (for example, if you’re using a custom CNAME, in which case Ably will have provided you with an explicit list of fallback hosts)."),g.fallbackHosts=w.FALLBACK_HOSTS}g.recover===!0&&(d.default.deprecated("The ability to use a boolean value for the `recover` client option","If you wish for the connection to always be recovered, replace `{ recover: true }` with a function that always passes `true` to its callback: `{ recover: function(lastConnectionDetails, cb) { cb(true); } }`"),g.recover=function($,D){D(!0)}),typeof g.recover=="function"&&g.closeOnUnload===!0&&(d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),g.recover=void 0),"closeOnUnload"in g||(g.closeOnUnload=!g.recover),g.transports&&u.arrIn(g.transports,"xhr")&&(d.default.deprecationWarning('The "xhr" transport has been renamed to "xhr_streaming". Please update your client options code to use `transports: ["xhr_streaming"]` instead. The ability to use `transports: ["xhr"]` will be removed in a future version.'),u.arrDeleteValue(g.transports,"xhr"),g.transports.push("xhr_streaming")),"queueMessages"in g||(g.queueMessages=!0);var L=g.environment&&String(g.environment).toLowerCase()||w.ENVIRONMENT,k=!L||L==="production";!g.fallbackHosts&&!g.restHost&&!g.realtimeHost&&!g.port&&!g.tlsPort&&(g.fallbackHosts=k?w.FALLBACK_HOSTS:T(L));var _=g.restHost||(k?w.REST_HOST:L+"-"+w.REST_HOST),I=R(g,k,L);u.arrForEach((g.fallbackHosts||[]).concat(_,I),y),g.port=g.port||w.PORT,g.tlsPort=g.tlsPort||w.TLS_PORT,"tls"in g||(g.tls=!0);var O=p(g);if("useBinaryProtocol"in g?g.useBinaryProtocol=o.default.Config.supportsBinary&&g.useBinaryProtocol:g.useBinaryProtocol=o.default.Config.preferBinary,g.clientId){var E=g.headers=g.headers||{};E["X-Ably-ClientId"]=o.default.BufferUtils.base64Encode(o.default.BufferUtils.utf8Encode(g.clientId))}"idempotentRestPublishing"in g||(g.idempotentRestPublishing=!0),g.promises&&!o.default.Config.Promise&&(d.default.logAction(d.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),g.promises=!1);var P=null,F=g.connectivityCheckUrl;if(g.connectivityCheckUrl){var B=g.connectivityCheckUrl.split("?"),z=B[0],Y=B[1];P=Y?u.parseQueryString(Y):{},z.indexOf("://")===-1&&(z="https://"+z),F=z}return a.__assign(a.__assign({},g),{useBinaryProtocol:"useBinaryProtocol"in g?o.default.Config.supportsBinary&&g.useBinaryProtocol:o.default.Config.preferBinary,realtimeHost:I,restHost:_,maxMessageSize:g.maxMessageSize||w.maxMessageSize,timeouts:O,connectivityCheckParams:P,connectivityCheckUrl:F})}n.normaliseOptions=s,n.default=w;function v(g){return Object.assign(w,g)}n.getDefaults=v},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(3)),u=a.__importDefault(i(2)),d=a.__importDefault(i(4)),h=a.__importStar(i(1));function m(l){return!l||!l.channelOptions?{channelOptions:l,plugins:{},baseEncodedPreviousPayload:void 0}:l}function C(l){if(l&&l.cipher){if(!o.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var A=o.default.Crypto.getCipher(l.cipher);return{cipher:A.cipherParams,channelCipher:A.cipher}}return l??{}}function w(l){var A=0;return l.name&&(A+=l.name.length),l.clientId&&(A+=l.clientId.length),l.extras&&(A+=JSON.stringify(l.extras).length),l.data&&(A+=h.dataSizeBytes(l.data)),A}var M=function(){function l(){}return l.prototype.toJSON=function(){var A=this.encoding,T=this.data;return T&&o.default.BufferUtils.isBuffer(T)&&(arguments.length>0?(A=A?A+"/base64":"base64",T=o.default.BufferUtils.base64Encode(T)):T=o.default.BufferUtils.toBuffer(T)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:A,data:T}},l.prototype.toString=function(){var A="[Message";return this.name&&(A+="; name="+this.name),this.id&&(A+="; id="+this.id),this.timestamp&&(A+="; timestamp="+this.timestamp),this.clientId&&(A+="; clientId="+this.clientId),this.connectionId&&(A+="; connectionId="+this.connectionId),this.encoding&&(A+="; encoding="+this.encoding),this.extras&&(A+="; extras ="+JSON.stringify(this.extras)),this.data&&(typeof this.data=="string"?A+="; data="+this.data:o.default.BufferUtils.isBuffer(this.data)?A+="; data (buffer)="+o.default.BufferUtils.base64Encode(this.data):A+="; data (json)="+JSON.stringify(this.data)),this.extras&&(A+="; extras="+JSON.stringify(this.extras)),A+="]",A},l.encrypt=function(A,T,x){var b=A.data,y=A.encoding,R=T.channelCipher;y=y?y+"/":"",o.default.BufferUtils.isBuffer(b)||(b=o.default.BufferUtils.utf8Encode(String(b)),y=y+"utf-8/"),R.encrypt(b,function(p,f){if(p){x(p);return}A.data=f,A.encoding=y+"cipher+"+R.algorithm,x(null,A)})},l.encode=function(A,T,x){var b=A.data,y=typeof b=="string"||o.default.BufferUtils.isBuffer(b)||b===null||b===void 0;if(!y)if(h.isObject(b)||h.isArray(b))A.data=JSON.stringify(b),A.encoding=A.encoding?A.encoding+"/json":"json";else throw new d.default("Data type is unsupported",40013,400);T!=null&&T.cipher?l.encrypt(A,T,x):x(null,A)},l.encodeArray=function(A,T,x){for(var b=0,y=0;y<A.length;y++)l.encode(A[y],T,function(R){if(R){x(R);return}b++,b==A.length&&x(null,A)})},l.decode=function(A,T){var x=m(T),b=A.data,y=A.encoding;if(y){var R=y.split("/"),p=void 0,f=R.length,c=A.data,s="";try{for(;(p=f)>0;){var v=R[--f].match(/([-\w]+)(\+([\w-]+))?/);if(!v)break;switch(s=v[1],s){case"base64":c=o.default.BufferUtils.base64Decode(String(c)),p==R.length&&(b=c);continue;case"utf-8":c=o.default.BufferUtils.utf8Decode(c);continue;case"json":c=JSON.parse(c);continue;case"cipher":if(x.channelOptions!=null&&x.channelOptions.cipher&&x.channelOptions.channelCipher){var g=v[3],S=x.channelOptions.channelCipher;if(g!=S.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");c=S.decrypt(c);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!x.plugins||!x.plugins.vcdiff)throw new d.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new d.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var L=x.baseEncodedPreviousPayload;typeof L=="string"&&(L=o.default.BufferUtils.utf8Encode(L)),L=o.default.BufferUtils.toBuffer(L),c=o.default.BufferUtils.toBuffer(c),c=o.default.BufferUtils.typedArrayToBuffer(x.plugins.vcdiff.decode(c,L)),b=c}catch(_){throw new d.default("Vcdiff delta decode failed with "+_,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(_){var k=_;throw new d.default("Error processing the "+s+" encoding, decoder returned ‘"+k.message+"’",k.code||40013,400)}finally{A.encoding=p<=0?null:R.slice(0,p).join("/"),A.data=c}}x.baseEncodedPreviousPayload=b},l.fromResponseBody=function(A,T,x){x&&(A=h.decodeBody(A,x));for(var b=0;b<A.length;b++){var y=A[b]=l.fromValues(A[b]);try{l.decode(y,T)}catch(R){u.default.logAction(u.default.LOG_ERROR,"Message.fromResponseBody()",R.toString())}}return A},l.fromValues=function(A){return Object.assign(new l,A)},l.fromValuesArray=function(A){for(var T=A.length,x=new Array(T),b=0;b<T;b++)x[b]=l.fromValues(A[b]);return x},l.fromEncoded=function(A,T){var x=l.fromValues(A),b=C(T??null);try{l.decode(x,b)}catch(y){u.default.logAction(u.default.LOG_ERROR,"Message.fromEncoded()",y.toString())}return x},l.fromEncodedArray=function(A,T){return A.map(function(x){return l.fromEncoded(x,T)})},l.getMessagesSize=function(A){for(var T,x=0,b=0;b<A.length;b++)T=A[b],x+=T.size||(T.size=w(T));return x},l.serialize=h.encodeBody,l}();n.default=M},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(4)),d=a.__importDefault(i(9)),h=a.__importDefault(i(16)),m={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},C=[];Object.keys(m).forEach(function(x){C[m[x]]=x});var w={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},M=Object.keys(w);w.MODE_ALL=w.PRESENCE|w.PUBLISH|w.SUBSCRIBE|w.PRESENCE_SUBSCRIBE;function l(x){var b=[];if(x)for(var y=0;y<x.length;y++)b.push(x[y].toString());return"[ "+b.join(", ")+" ]"}var A="id channel channelSerial connectionId count msgSerial timestamp".split(" "),T=function(){function x(){var b=this;this.hasFlag=function(y){return(b.flags&w[y])>0}}return x.prototype.setFlag=function(b){return this.flags=this.flags|w[b]},x.prototype.getMode=function(){return this.flags&&this.flags&w.MODE_ALL},x.prototype.encodeModesToFlags=function(b){var y=this;b.forEach(function(R){return y.setFlag(R)})},x.prototype.decodeModesFromFlags=function(){var b=this,y=[];return x.channelModes.forEach(function(R){b.hasFlag(R)&&y.push(R)}),y.length>0?y:void 0},x.fromValues=function(b){return Object.assign(new x,b)},x.Action=m,x.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],x.ActionName=C,x.serialize=o.encodeBody,x.deserialize=function(b,y){var R=o.decodeBody(b,y);return x.fromDeserialized(R)},x.fromDeserialized=function(b){var y=b.error;y&&(b.error=u.default.fromValues(y));var R=b.messages;if(R)for(var p=0;p<R.length;p++)R[p]=d.default.fromValues(R[p]);var f=b.presence;if(f)for(var p=0;p<f.length;p++)f[p]=h.default.fromValues(f[p],!0);return Object.assign(new x,b)},x.stringify=function(b){var y="[ProtocolMessage";b.action!==void 0&&(y+="; action="+x.ActionName[b.action]||!1);for(var R,p=0;p<A.length;p++)R=A[p],b[R]!==void 0&&(y+="; "+R+"="+b[R]);if(b.messages&&(y+="; messages="+l(d.default.fromValuesArray(b.messages))),b.presence&&(y+="; presence="+l(h.default.fromValuesArray(b.presence))),b.error&&(y+="; error="+u.default.fromValues(b.error).toString()),b.auth&&b.auth.accessToken&&(y+="; token="+b.auth.accessToken),b.flags&&(y+="; flags="+M.filter(b.hasFlag).join(",")),b.params){var f="";o.forInOwnNonNullProperties(b.params,function(c){f.length>0&&(f+="; "),f+=c+"="+b.params[c]}),f.length>0&&(y+="; params=["+f+"]")}return y+="]",y},x}();n.default=T},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(){var o=a,u=o.lib,d=u.WordArray,h=o.enc;h.Base64={stringify:function(C){var w=C.words,M=C.sigBytes,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";C.clamp();for(var A=[],T=0;T<M;T+=3)for(var x=w[T>>>2]>>>24-T%4*8&255,b=w[T+1>>>2]>>>24-(T+1)%4*8&255,y=w[T+2>>>2]>>>24-(T+2)%4*8&255,R=x<<16|b<<8|y,p=0;p<4&&T+p*.75<M;p++)A.push(l.charAt(R>>>6*(3-p)&63));var f=l.charAt(64);if(f)for(;A.length%4;)A.push(f);return A.join("")},parse:function(C){var w=C.length,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var A=0;A<M.length;A++)l[M.charCodeAt(A)]=A}var T=M.charAt(64);if(T){var x=C.indexOf(T);x!==-1&&(w=x)}return m(C,w,l)}};function m(C,w,M){for(var l=[],A=0,T=0;T<w;T++)if(T%4){var x=M[C.charCodeAt(T-1)]<<T%4*2,b=M[C.charCodeAt(T)]>>>6-T%4*2,y=x|b;l[A>>>2]|=y<<24-A%4*8,A++}return d.create(l,A)}}(),a.enc.Base64})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(10)),d=a.__importDefault(i(26)),h=a.__importDefault(i(2)),m=a.__importDefault(i(8)),C=a.__importDefault(i(21)),w=a.__importDefault(i(18)),M=a.__importDefault(i(4)),l=a.__importDefault(i(22)),A=a.__importDefault(i(3));function T(y){var R=[80015,80017,80030];return y.code?w.default.isTokenErr(y)?!1:o.arrIn(R,y.code)?!0:y.code>=4e4&&y.code<5e4:!1}function x(y){return T(y)?[u.default.fromValues({action:u.default.Action.ERROR,error:y})]:[u.default.fromValues({action:u.default.Action.DISCONNECTED,error:y})]}var b=function(y){a.__extends(R,y);function R(p,f,c){var s=y.call(this,p,f,c,!0)||this;return s.onAuthUpdated=function(v){s.authParams={access_token:v.token}},s.stream="stream"in c?c.stream:!0,s.sendRequest=null,s.recvRequest=null,s.pendingCallback=null,s.pendingItems=null,s}return R.prototype.connect=function(){var p=this;h.default.logAction(h.default.LOG_MINOR,"CometTransport.connect()","starting"),d.default.prototype.connect.call(this);var f=this.params,c=f.options,s=m.default.getHost(c,f.host),v=m.default.getPort(c),g=c.tls?"https://":"http://";this.baseUri=g+s+":"+v+"/comet/";var S=this.baseUri+"connect";h.default.logAction(h.default.LOG_MINOR,"CometTransport.connect()","uri: "+S),this.auth.getAuthParams(function(L,k){if(L){p.disconnect(L);return}if(!p.isDisposed){p.authParams=k;var _=p.params.getConnectParams(k);"stream"in _&&(p.stream=_.stream),h.default.logAction(h.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+o.toQueryString(_));var I=!1,O=p.recvRequest=p.createRequest(S,null,_,null,p.stream?l.default.REQ_RECV_STREAM:l.default.REQ_RECV);O.on("data",function(E){p.recvRequest&&(I||(I=!0,p.emit("preconnect")),p.onData(E))}),O.on("complete",function(E){if(p.recvRequest||(E=E||new M.default("Request cancelled",80003,400)),p.recvRequest=null,!I&&!E&&(I=!0,p.emit("preconnect")),p.onActivity(),E){E.code?p.onData(x(E)):p.disconnect(E);return}A.default.Config.nextTick(function(){p.recv()})}),O.exec()}})},R.prototype.requestClose=function(){h.default.logAction(h.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},R.prototype.requestDisconnect=function(){h.default.logAction(h.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},R.prototype._requestCloseOrDisconnect=function(p){var f=this,c=p?this.closeUri:this.disconnectUri;if(c){var s=this.createRequest(c,null,this.authParams,null,l.default.REQ_SEND);s.on("complete",function(v){v&&(h.default.logAction(h.default.LOG_ERROR,"CometTransport.request"+(p?"Close()":"Disconnect()"),"request returned err = "+o.inspectError(v)),f.finish("disconnected",v))}),s.exec()}},R.prototype.dispose=function(){var p=this;h.default.logAction(h.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.default.logAction(h.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",C.default.disconnected()),A.default.Config.nextTick(function(){p.emit("disposed")}))},R.prototype.onConnect=function(p){var f;if(!this.isDisposed){var c=(f=p.connectionDetails)===null||f===void 0?void 0:f.connectionKey;d.default.prototype.onConnect.call(this,p);var s=this.baseUri+c;h.default.logAction(h.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+s),this.sendUri=s+"/send",this.recvUri=s+"/recv",this.closeUri=s+"/close",this.disconnectUri=s+"/disconnect"}},R.prototype.send=function(p){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(p);return}var f=this.pendingItems||[];f.push(p),this.pendingItems=null,this.sendItems(f)},R.prototype.sendAnyPending=function(){var p=this.pendingItems;p&&(this.pendingItems=null,this.sendItems(p))},R.prototype.sendItems=function(p){var f=this,c=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(p),l.default.REQ_SEND);c.on("complete",function(s,v){if(s&&h.default.logAction(h.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+o.inspectError(s)),f.sendRequest=null,s){s.code?f.onData(x(s)):f.disconnect(s);return}v&&f.onData(v),f.pendingItems&&A.default.Config.nextTick(function(){f.sendRequest||f.sendAnyPending()})}),c.exec()},R.prototype.recv=function(){var p=this;if(!this.recvRequest&&this.isConnected){var f=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?l.default.REQ_RECV_STREAM:l.default.REQ_RECV_POLL);f.on("data",function(c){p.onData(c)}),f.on("complete",function(c){if(p.recvRequest=null,p.onActivity(),c){c.code?p.onData(x(c)):p.disconnect(c);return}A.default.Config.nextTick(function(){p.recv()})}),f.exec()}},R.prototype.onData=function(p){try{var f=this.decodeResponse(p);if(f&&f.length)for(var c=0;c<f.length;c++)this.onProtocolMessage(u.default.fromDeserialized(f[c]))}catch(s){h.default.logAction(h.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+s.stack)}},R.prototype.encodeRequest=function(p){return JSON.stringify(p)},R.prototype.decodeResponse=function(p){return typeof p=="string"?JSON.parse(p):p},R}(d.default);n.default=b},function(e,n){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}e.exports=i},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.isSuccessCode=void 0;var a;(function(u){u[u.Success=200]="Success",u[u.NoContent=204]="NoContent",u[u.BadRequest=400]="BadRequest",u[u.Unauthorized=401]="Unauthorized",u[u.Forbidden=403]="Forbidden",u[u.RequestTimeout=408]="RequestTimeout",u[u.InternalServerError=500]="InternalServerError"})(a||(a={}));function o(u){return u>=a.Success&&u<a.BadRequest}n.isSuccessCode=o,n.default=a},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(3)),u=a.__importStar(i(1)),d=a.__importDefault(i(2)),h=a.__importDefault(i(18)),m=a.__importDefault(i(19)),C=i(4),w=a.__importDefault(i(14));function M(y,R,p,f,c){y.http.supportsAuthHeaders?y.auth.getAuthHeaders(function(s,v){s?f(s):c(u.mixin(v,R),p)}):y.auth.getAuthParams(function(s,v){s?f(s):c(R,u.mixin(v,p))})}function l(y,R){return function(p,f,c,s,v){if(p&&!f){y(p);return}if(v===w.default.NoContent){y(p,[],c,!0,v);return}if(!s)try{f=u.decodeBody(f,R)}catch(I){u.isErrorInfoOrPartialErrorInfo(I)?y(I):y(new C.PartialErrorInfo(u.inspectError(I),null));return}if(!f){y(new C.PartialErrorInfo("unenvelope(): Response body is missing",null));return}var g=f,S=g.statusCode,L=g.response,k=g.headers;if(S===void 0){y(p,f,c,!0,v);return}if(S<200||S>=300){var _=L&&L.error||p;_||(_=new Error("Error in unenveloping "+f),_.statusCode=S),y(_,L,k,!0,S);return}y(p,L,k,!0,S)}}function A(y){var R=[];if(y)for(var p in y)R.push(p+"="+y[p]);return R.join("&")}function T(y,R){return y+(R?"?":"")+A(R)}function x(y,R,p,f){return function(c,s,v,g,S){c?d.default.logAction(d.default.LOG_MICRO,"Resource."+R+"()","Received Error; "+T(p,f)+"; Error: "+u.inspectError(c)):d.default.logAction(d.default.LOG_MICRO,"Resource."+R+"()","Received; "+T(p,f)+"; Headers: "+A(v)+"; StatusCode: "+S+"; Body: "+(o.default.BufferUtils.isBuffer(s)?s.toString():s)),y&&y(c,s,v,g,S)}}var b=function(){function y(){}return y.get=function(R,p,f,c,s,v){y.do(m.default.Get,R,p,null,f,c,s,v)},y.delete=function(R,p,f,c,s,v){y.do(m.default.Delete,R,p,null,f,c,s,v)},y.post=function(R,p,f,c,s,v,g){y.do(m.default.Post,R,p,f,c,s,v,g)},y.patch=function(R,p,f,c,s,v,g){y.do(m.default.Patch,R,p,f,c,s,v,g)},y.put=function(R,p,f,c,s,v,g){y.do(m.default.Put,R,p,f,c,s,v,g)},y.do=function(R,p,f,c,s,v,g,S){d.default.shouldLog(d.default.LOG_MICRO)&&(S=x(S,R,f,v)),g&&(S=S&&l(S,g),(v=v||{}).envelope=g);function L(k,_){var I;if(d.default.shouldLog(d.default.LOG_MICRO)&&d.default.logAction(d.default.LOG_MICRO,"Resource."+R+"()","Sending; "+T(f,_)),d.default.shouldLog(d.default.LOG_MICRO)){var O=c;if(((I=k["content-type"])===null||I===void 0?void 0:I.indexOf("msgpack"))>0)try{O=o.default.Config.msgpack.decode(c)}catch(E){d.default.logAction(d.default.LOG_MICRO,"Resource."+R+"()","Sending MsgPack Decoding Error: "+u.inspectError(E))}d.default.logAction(d.default.LOG_MICRO,"Resource."+R+"()","Sending; "+T(f,_)+"; Body: "+O)}p.http.do(R,p,f,k,c,_,function(E,P,F,B,z){if(E&&h.default.isTokenErr(E)){p.auth.authorize(null,null,function(Y){if(Y){S(Y);return}M(p,k,_,S,L)});return}S(E,P,F,B,z)})}M(p,s,v,S,L)},y}();n.default=b},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(2)),u=a.__importDefault(i(3)),d=a.__importDefault(i(9)),h=a.__importStar(i(1));function m(w){return C.Actions.indexOf(w)}var C=function(){function w(){}return w.prototype.isSynthesized=function(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId},w.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var M=this.id.split(":");return{connectionId:M[0],msgSerial:parseInt(M[1],10),index:parseInt(M[2],10)}},w.prototype.toJSON=function(){var M=this.data,l=this.encoding;return M&&u.default.BufferUtils.isBuffer(M)&&(arguments.length>0?(l=l?l+"/base64":"base64",M=u.default.BufferUtils.base64Encode(M)):M=u.default.BufferUtils.toBuffer(M)),{id:this.id,clientId:this.clientId,action:m(this.action),data:M,encoding:l,extras:this.extras}},w.prototype.toString=function(){var M="[PresenceMessage";return M+="; action="+this.action,this.id&&(M+="; id="+this.id),this.timestamp&&(M+="; timestamp="+this.timestamp),this.clientId&&(M+="; clientId="+this.clientId),this.connectionId&&(M+="; connectionId="+this.connectionId),this.encoding&&(M+="; encoding="+this.encoding),this.data&&(typeof this.data=="string"?M+="; data="+this.data:u.default.BufferUtils.isBuffer(this.data)?M+="; data (buffer)="+u.default.BufferUtils.base64Encode(this.data):M+="; data (json)="+JSON.stringify(this.data)),this.extras&&(M+="; extras="+JSON.stringify(this.extras)),M+="]",M},w.fromResponseBody=function(M,l,A){var T=[];A&&(M=h.decodeBody(M,A));for(var x=0;x<M.length;x++){var b=T[x]=w.fromValues(M[x],!0);try{w.decode(b,l)}catch(y){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",y.toString())}}return T},w.fromValues=function(M,l){return l&&(M.action=w.Actions[M.action]),Object.assign(new w,M)},w.fromValuesArray=function(M){for(var l=M.length,A=new Array(l),T=0;T<l;T++)A[T]=w.fromValues(M[T]);return A},w.fromEncoded=function(M,l){var A=w.fromValues(M,!0);try{w.decode(A,l??{})}catch(T){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromEncoded()",T.toString())}return A},w.fromEncodedArray=function(M,l){return M.map(function(A){return w.fromEncoded(A,l)})},w.fromData=function(M){return M instanceof w?M:w.fromValues({data:M})},w.Actions=["absent","present","enter","leave","update"],w.encode=d.default.encode,w.decode=d.default.decode,w.getMessagesSize=d.default.getMessagesSize,w}();n.default=C},function(e,n,i){(function(a){Object.defineProperty(n,"__esModule",{value:!0});var o=i(0),u=o.__importStar(i(1)),d=o.__importDefault(i(7)),h=o.__importStar(i(4)),m=o.__importDefault(i(2)),C=o.__importDefault(i(8)),w=o.__importDefault(i(22)),M=o.__importDefault(i(3));function l(g,S){return u.arrIn(u.allToLowerCase(u.keysArray(S)),"x-ably-errorcode")}function A(g,S){if(l(g,S))return g.error&&h.default.fromValues(g.error)}var T=function(){},x=0,b={},y=typeof a<"u"&&a.XDomainRequest;function R(){var g=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/);return g&&Number(g[1])}function p(){var g;return y&&(g=R())&&g===10}function f(g,S){return g.getResponseHeader&&g.getResponseHeader(S)}function c(g){return g.getResponseHeader&&(g.getResponseHeader("transfer-encoding")||!g.getResponseHeader("content-length"))}function s(g){for(var S=u.trim(g.getAllResponseHeaders()).split(`\r
`),L={},k=0;k<S.length;k++){var _=S[k].split(":").map(u.trim);L[_[0].toLowerCase()]=_[1]}return L}var v=function(g){o.__extends(S,g);function S(L,k,_,I,O,E,P){var F=g.call(this)||this;return _=_||{},_.rnd=u.cheapRandStr(),p()&&!_.envelope&&(_.envelope="json"),F.uri=L+u.toQueryString(_),F.headers=k||{},F.body=I,F.method=P?P.toUpperCase():u.isEmptyArg(I)?"GET":"POST",F.requestMode=O,F.timeouts=E,F.timedOut=!1,F.requestComplete=!1,F.id=String(++x),b[F.id]=F,F}return S.createRequest=function(L,k,_,I,O,E,P){var F=E||C.default.TIMEOUTS;return new S(L,k,u.copy(_),I,O,F,P)},S.prototype.complete=function(L,k,_,I,O){this.requestComplete||(this.requestComplete=!0,!L&&k&&this.emit("data",k),this.emit("complete",L,k,_,I,O),this.dispose())},S.prototype.abort=function(){this.dispose()},S.prototype.exec=function(){var L=this,k=this.headers,_=this.requestMode==w.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,I=this.timer=setTimeout(function(){L.timedOut=!0,E.abort()},_),O=this.method,E=this.xhr=new XMLHttpRequest,P=k.accept,F=this.body,B="text";if(P?P.indexOf("application/x-msgpack")===0&&(B="arraybuffer"):k.accept="application/json",F){var z=k["content-type"]||(k["content-type"]="application/json");z.indexOf("application/json")>-1&&typeof F!="string"&&(F=JSON.stringify(F))}E.open(O,this.uri,!0),E.responseType=B,"authorization"in k&&(E.withCredentials=!0);for(var Y in k)E.setRequestHeader(Y,k[Y]);var $=function(ne,me,Te,Me){var we,Fe=me+" (event type: "+ne.type+")";!((we=L==null?void 0:L.xhr)===null||we===void 0)&&we.statusText&&(Fe+=", current statusText is "+L.xhr.statusText),m.default.logAction(m.default.LOG_ERROR,"Request.on"+ne.type+"()",Fe),L.complete(new h.PartialErrorInfo(Fe,Te,Me))};E.onerror=function(ne){$(ne,"XHR error occurred",null,400)},E.onabort=function(ne){L.timedOut?$(ne,"Request aborted due to request timeout expiring",null,408):$(ne,"Request cancelled",null,400)},E.ontimeout=function(ne){$(ne,"Request timed out",null,408)};var D,N,j,G=0,K=!1,Z=function(){if(clearTimeout(I),j=N<400,N==204){L.complete(null,null,null,null,N);return}D=L.requestMode==w.default.REQ_RECV_STREAM&&j&&c(E)},ee=function(){var ne;try{var me=f(E,"content-type"),Te=me?me.indexOf("application/json")>=0:E.responseType=="text";if(Te){var Me=E.responseType==="arraybuffer"?M.default.BufferUtils.utf8Decode(E.response):String(E.responseText);Me.length?ne=JSON.parse(Me):ne=Me,K=!0}else ne=E.response;ne.response!==void 0?(N=ne.statusCode,j=N<400,k=ne.headers,ne=ne.response):k=s(E)}catch(Fe){L.complete(new h.PartialErrorInfo("Malformed response body from server: "+Fe.message,null,400));return}if(j||u.isArray(ne)){L.complete(null,ne,k,K,N);return}var we=A(ne,k);we||(we=new h.PartialErrorInfo("Error response received from server: "+N+" body was: "+M.default.Config.inspect(ne),null,N)),L.complete(we,ne,k,K,N)};function ie(){for(var ne=E.responseText,me=ne.length-1,Te,Me;G<me&&(Te=ne.indexOf(`
`,G))>-1;)Me=ne.slice(G,Te),G=Te+1,ue(Me)}var ue=function(ne){try{ne=JSON.parse(ne)}catch(me){L.complete(new h.PartialErrorInfo("Malformed response body from server: "+me.message,null,400));return}L.emit("data",ne)},pe=function(){ie(),L.streamComplete=!0,M.default.Config.nextTick(function(){L.complete()})};E.onreadystatechange=function(){var ne=E.readyState;ne<3||E.status!==0&&(N===void 0&&(N=E.status,N===1223&&(N=204),Z()),ne==3&&D?ie():ne==4&&(D?pe():ee()))},E.send(F)},S.prototype.dispose=function(){var L=this.xhr;if(L){L.onreadystatechange=L.onerror=L.onabort=L.ontimeout=T,this.xhr=null;var k=this.timer;k&&(clearTimeout(k),this.timer=null),this.requestComplete||L.abort()}delete b[this.id]},S}(d.default);n.default=v}).call(this,i(13))},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(2)),u=a.__importStar(i(1)),d=a.__importDefault(i(24)),h=a.__importDefault(i(4)),m=a.__importDefault(i(45)),C=i(11),w=a.__importDefault(i(19)),M=a.__importDefault(i(14)),l=a.__importDefault(i(3)),A=a.__importDefault(i(15)),T=Math.pow(2,17);function x(){}function b(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function y(_){return!!_.connection}function R(_){return u.isErrorInfoOrPartialErrorInfo(_)?(_.code||(_.statusCode===403?_.code=40300:(_.code=40170,_.statusCode=401)),_):new h.default(u.inspectError(_),_.code||40170,_.statusCode||401)}var p=function(_,I){if(l.default.Config.createHmac){var O=l.default.Config.createHmac("SHA256",I);return O.update(_),O.digest("base64")}return(0,C.stringify)((0,m.default)(_,I))};function f(_){if(!_)return"";typeof _=="string"&&(_=JSON.parse(_));var I=Object.create(null),O=u.keysArray(_,!0);if(!O)return"";O.sort();for(var E=0;E<O.length;E++)I[O[E]]=_[O[E]].sort();return JSON.stringify(I)}function c(_){if(_.authCallback)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(_.authUrl)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(_.key)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(_.tokenDetails)o.default.logAction(o.default.LOG_MINOR,"Auth()","using token auth with supplied token only");else{var I="authOptions must include valid authentication parameters";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",I),new Error(I)}}function s(_){return"useTokenAuth"in _&&!_.useTokenAuth}function v(_){return _.useTokenAuth||!s(_)&&(_.authCallback||_.authUrl||_.token||_.tokenDetails)}function g(_){return!_.key&&!_.authCallback&&!_.authUrl}var S=0;function L(){return S++}var k=function(){function _(I,O){if(this.authOptions={},this.client=I,this.tokenParams=O.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,v(O)){if(O.key&&!p){var E="client-side token request signing not supported";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",E),new Error(E)}g(O)&&o.default.logAction(o.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(O.defaultTokenParams,O),c(this.authOptions)}else{if(!O.key){var E="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw o.default.logAction(o.default.LOG_ERROR,"Auth()",E),new h.default(E,40160,401)}o.default.logAction(o.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(O)}}return _.prototype.authorize=function(I,O,E){var P=this,F;if(typeof I=="function"&&!E?(E=I,F=I=null):typeof O=="function"&&!E?(E=O,F=null):F=O,!E&&this.client.options.promises)return u.promisify(this,"authorize",arguments);if(F&&F.key&&this.authOptions.key!==F.key)throw new h.default("Unable to update auth options with incompatible key",40102,401);F&&"force"in F&&(o.default.deprecated("The `force` auth option","If you’re using this option to force `authorize()` to fetch a new token even if the current token has not expired, this is no longer necessary, as `authorize()` now always fetches a new token. Update your code to no longer pass the `force` auth option. Note that, in general, passing an auth options argument to `authorize()` will overwrite the library’s stored auth options, which may not be what you want. The library currently contains a special case behavior where passing an auth options object which only contains `{ force: true }` will _not_ overwrite the stored options. This special case behavior will be removed alongside support for the `force` option, so if you’re currently passing `authorize()` an auth options object which only contains `{ force: true }`, you should stop passing it an auth options object entirely."),u.isOnlyPropIn(F,"force")&&(F=null)),this._forceNewToken(I,F,function(B,z){if(B){P.client.connection&&B.statusCode===M.default.Forbidden&&P.client.connection.connectionManager.actOnErrorFromAuthorize(B),E==null||E(B);return}y(P.client)?P.client.connection.connectionManager.onAuthUpdated(z,E||x):E==null||E(null,z)})},_.prototype.authorise=function(I,O,E){o.default.renamedMethod("Auth","authorise","authorize"),this.authorize(I,O,E)},_.prototype._forceNewToken=function(I,O,E){var P=this;this.tokenDetails=null,this._saveTokenOptions(I,O),c(this.authOptions),this._ensureValidAuthCredentials(!0,function(F,B){delete P.tokenParams.timestamp,delete P.authOptions.queryTime,E(F,B)})},_.prototype.requestToken=function(I,O,E){var P=this;if(typeof I=="function"&&!E?(E=I,O=I=null):typeof O=="function"&&!E&&(E=O,O=null),!E&&this.client.options.promises)return u.promisify(this,"requestToken",arguments);O=O||this.authOptions,I=I||u.copy(this.tokenParams);var F=E||x,B,z=this.client;if(O.authCallback)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),B=O.authCallback;else if(O.authUrl)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),B=function(G,K){var Z=u.mixin({accept:"application/json, text/plain"},O.authHeaders),ee=O.authMethod&&O.authMethod.toLowerCase()==="post",ie,ue=O.authUrl.indexOf("?");ue>-1&&(ie=u.parseQueryString(O.authUrl.slice(ue)),O.authUrl=O.authUrl.slice(0,ue),ee||(O.authParams=u.mixin(ie,O.authParams)));var pe=u.mixin({},O.authParams||{},G),ne=function(Me,we,Fe,Ot){var $e;if(Me?o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+u.inspectError(Me)):($e=Fe["content-type"],o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+$e+"; body: "+u.inspectBody(we))),Me||Ot)return K(Me,we);if(l.default.BufferUtils.isBuffer(we)&&(we=we.toString()),!$e){K(new h.default("authUrl response is missing a content-type header",40170,401));return}var ft=$e.indexOf("application/json")>-1,dt=$e.indexOf("text/plain")>-1||$e.indexOf("application/jwt")>-1;if(!ft&&!dt){K(new h.default("authUrl responded with unacceptable content-type "+$e+", should be either text/plain, application/jwt or application/json",40170,401));return}if(ft){if(we.length>T){K(new h.default("authUrl response exceeded max permitted length",40170,401));return}try{we=JSON.parse(we)}catch(wt){K(new h.default("Unexpected error processing authURL response; err = "+wt.message,40170,401));return}}K(null,we,$e)};if(o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+O.authUrl+"; Params: "+JSON.stringify(pe)+"; method: "+(ee?"POST":"GET")),ee){var me=Z||{};me["content-type"]="application/x-www-form-urlencoded";var Te=u.toQueryString(pe).slice(1);P.client.http.doUri(w.default.Post,z,O.authUrl,me,Te,ie,ne)}else P.client.http.doUri(w.default.Get,z,O.authUrl,Z||{},null,pe,ne)};else if(O.key)o.default.logAction(o.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),B=function(G,K){P.createTokenRequest(G,O,K)};else{var Y="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";o.default.logAction(o.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),F(new h.default(Y,40171,403));return}"capability"in I&&(I.capability=f(I.capability));var $=function(G,K){var Z=G.keyName,ee="/keys/"+Z+"/requestToken",ie=function(pe){return z.baseUri(pe)+ee},ue=u.defaultPostHeaders(P.client.options);O.requestHeaders&&u.mixin(ue,O.requestHeaders),o.default.logAction(o.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+ee+"; Token params: "+JSON.stringify(G)),P.client.http.do(w.default.Post,z,ie,ue,JSON.stringify(G),null,K)},D=!1,N=this.client.options.timeouts.realtimeRequestTimeout,j=setTimeout(function(){D=!0;var G="Token request callback timed out after "+N/1e3+" seconds";o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",G),F(new h.default(G,40170,401))},N);B(I,function(G,K,Z){if(!D){if(clearTimeout(j),G){o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+u.inspectError(G)),F(R(G));return}if(typeof K=="string"){K.length===0?F(new h.default("Token string is empty",40170,401)):K.length>T?F(new h.default("Token string exceeded max permitted length (was "+K.length+" bytes)",40170,401)):K==="undefined"||K==="null"?F(new h.default("Token string was literal null/undefined",40170,401)):K[0]==="{"&&!(Z&&Z.indexOf("application/jwt")>-1)?F(new h.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):F(null,{token:K});return}if(typeof K!="object"){var ee="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof K;o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",ee),F(new h.default(ee,40170,401));return}var ie=JSON.stringify(K).length;if(ie>T&&!O.suppressMaxLengthCheck){F(new h.default("Token request/details object exceeded max permitted stringified size (was "+ie+" bytes)",40170,401));return}if("issued"in K){F(null,K);return}if(!("keyName"in K)){var ee="Expected token request callback to call back with a token string, token request object, or token details object";o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()",ee),F(new h.default(ee,40170,401));return}$(K,function(ue,pe,ne,me){if(ue){o.default.logAction(o.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+u.inspectError(ue)),F(R(ue));return}me||(pe=JSON.parse(pe)),o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","token received"),F(null,pe)})}})},_.prototype.createTokenRequest=function(I,O,E){var P=this;if(typeof I=="function"&&!E?(E=I,O=I=null):typeof O=="function"&&!E&&(E=O,O=null),!E&&this.client.options.promises)return u.promisify(this,"createTokenRequest",arguments);O=O||this.authOptions,I=I||u.copy(this.tokenParams);var F=O.key;if(!F){E(new h.default("No key specified",40101,403));return}var B=F.split(":"),z=B[0],Y=B[1];if(!Y){E(new h.default("Invalid key specified",40101,403));return}if(I.clientId===""){E(new h.default("clientId can’t be an empty string",40012,400));return}"capability"in I&&(I.capability=f(I.capability));var $=u.mixin({keyName:z},I),D=I.clientId||"",N=I.ttl||"",j=I.capability||"";(function(G){if($.timestamp){G();return}P.getTimestamp(O&&O.queryTime,function(K,Z){if(K){E(K);return}$.timestamp=Z,G()})})(function(){var G=$.nonce||($.nonce=b()),K=$.timestamp,Z=$.keyName+`
`+N+`
`+j+`
`+D+`
`+K+`
`+G+`
`;$.mac=$.mac||p(Z,Y),o.default.logAction(o.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),E(null,$)})},_.prototype.getAuthParams=function(I){this.method=="basic"?I(null,{key:this.key}):this._ensureValidAuthCredentials(!1,function(O,E){if(O){I(O);return}if(!E)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");I(null,{access_token:E.token})})},_.prototype.getAuthHeaders=function(I){this.method=="basic"?I(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,function(O,E){if(O){I(O);return}if(!E)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");I(null,{authorization:"Bearer "+u.toBase64(E.token)})})},_.prototype.getTimestamp=function(I,O){!this.isTimeOffsetSet()&&(I||this.authOptions.queryTime)?this.client.time(O):O(null,this.getTimestampUsingOffset())},_.prototype.getTimestampUsingOffset=function(){return u.now()+(this.client.serverTimeOffset||0)},_.prototype.isTimeOffsetSet=function(){return this.client.serverTimeOffset!==null},_.prototype._saveBasicOptions=function(I){this.method="basic",this.key=I.key,this.basicKey=u.toBase64(I.key),this.authOptions=I||{},"clientId"in I&&this._userSetClientId(I.clientId)},_.prototype._saveTokenOptions=function(I,O){this.method="token",I&&(this.tokenParams=I),O&&(O.token&&(O.tokenDetails=typeof O.token=="string"?{token:O.token}:O.token),O.tokenDetails&&(this.tokenDetails=O.tokenDetails),"clientId"in O&&this._userSetClientId(O.clientId),this.authOptions=O)},_.prototype._ensureValidAuthCredentials=function(I,O){var E=this,P=this.tokenDetails;if(P){if(this._tokenClientIdMismatch(P.clientId)){O(new h.default("Mismatch between clientId in token ("+P.clientId+") and current clientId ("+this.clientId+")",40102,403));return}if(!this.isTimeOffsetSet()||!P.expires||P.expires>=this.getTimestampUsingOffset()){o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+P.expires),O(null,P);return}o.default.logAction(o.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=d.default.create())).push(O),!(this.currentTokenRequestId!==null&&!I)){var F=this.currentTokenRequestId=L();this.requestToken(this.tokenParams,this.authOptions,function(B,z){if(E.currentTokenRequestId>F){o.default.logAction(o.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");return}E.currentTokenRequestId=null;var Y=E.waitingForTokenRequest||x;if(E.waitingForTokenRequest=null,B){Y(B);return}Y(null,E.tokenDetails=z)})}},_.prototype._userSetClientId=function(I){if(typeof I=="string"||I===null){if(I==="*")throw new h.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var O=this._uncheckedSetClientId(I);if(O)throw O}else throw new h.default("clientId must be either a string or null",40012,400)},_.prototype._uncheckedSetClientId=function(I){if(this._tokenClientIdMismatch(I)){var O="Unexpected clientId mismatch: client has "+this.clientId+", requested "+I,E=new h.default(O,40102,401);return o.default.logAction(o.default.LOG_ERROR,"Auth._uncheckedSetClientId()",O),E}else return this.clientId=this.tokenParams.clientId=I,null},_.prototype._tokenClientIdMismatch=function(I){return!!(this.clientId&&this.clientId!=="*"&&I&&I!=="*"&&this.clientId!==I)},_.isTokenErr=function(I){return I.code&&I.code>=40140&&I.code<40150},_.prototype.revokeTokens=function(I,O,E){if(v(this.client.options))throw new h.default("Cannot revoke tokens when using token auth",40162,401);var P=this.client.options.keyName,F;if(typeof O=="function"?(E=O,F={}):F=O??{},E===void 0){if(this.client.options.promises)return u.promisify(this,"revokeTokens",[I,F]);E=x}var B=E,z=a.__assign({targets:I.map(function(N){return"".concat(N.type,":").concat(N.value)})},F),Y=this.client.options.useBinaryProtocol?u.Format.msgpack:u.Format.json,$=u.defaultPostHeaders(this.client.options,Y);this.client.options.headers&&u.mixin($,this.client.options.headers);var D=u.encodeBody(z,Y);A.default.post(this.client,"/keys/".concat(P,"/revokeTokens"),D,$,{newBatchResponse:"true"},null,function(N,j,G,K){if(N){B(N);return}var Z=K?j:u.decodeBody(j,Y);B(null,Z)})},_}();n.default=k},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a;(function(o){o.Get="get",o.Delete="delete",o.Post="post",o.Put="put",o.Patch="patch"})(a||(a={})),n.default=a},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.HttpPaginatedResponse=n.PaginatedResult=void 0;var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(2)),d=a.__importDefault(i(15)),h=a.__importDefault(i(14));function m(T){var x=T.match(/^\.\/(\w+)\?(.*)$/);return x&&x[2]&&o.parseQueryString(x[2])}function C(T){typeof T=="string"&&(T=T.split(","));for(var x={},b=0;b<T.length;b++){var y=T[b].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(y){var R=m(y[1]);R&&(x[y[2]]=R)}}return x}function w(T,x,b){return!(b&&(x||typeof T.code=="number"))}var M=function(){function T(x,b,y,R,p,f){this.rest=x,this.path=b,this.headers=y,this.envelope=R??null,this.bodyHandler=p,this.useHttpPaginatedResponse=f||!1}return T.prototype.get=function(x,b){var y=this;d.default.get(this.rest,this.path,this.headers,x,this.envelope,function(R,p,f,c,s){y.handlePage(R,p,f,c,s,b)})},T.prototype.delete=function(x,b){var y=this;d.default.delete(this.rest,this.path,this.headers,x,this.envelope,function(R,p,f,c,s){y.handlePage(R,p,f,c,s,b)})},T.prototype.post=function(x,b,y){var R=this;d.default.post(this.rest,this.path,b,this.headers,x,this.envelope,function(p,f,c,s,v){y&&R.handlePage(p,f,c,s,v,y)})},T.prototype.put=function(x,b,y){var R=this;d.default.put(this.rest,this.path,b,this.headers,x,this.envelope,function(p,f,c,s,v){y&&R.handlePage(p,f,c,s,v,y)})},T.prototype.patch=function(x,b,y){var R=this;d.default.patch(this.rest,this.path,b,this.headers,x,this.envelope,function(p,f,c,s,v){y&&R.handlePage(p,f,c,s,v,y)})},T.prototype.handlePage=function(x,b,y,R,p,f){if(x&&w(x,b,this.useHttpPaginatedResponse)){u.default.logAction(u.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+o.inspectError(x)),f==null||f(x);return}var c,s,v;try{c=p==h.default.NoContent?[]:this.bodyHandler(b,y||{},R)}catch(g){f==null||f(x||g);return}y&&(s=y.Link||y.link)&&(v=C(s)),this.useHttpPaginatedResponse?f(null,new A(this,c,y||{},p,v,x)):f(null,new l(this,c,v))},T}(),l=function(){function T(x,b,y){var R=this;this.resource=x,this.items=b;var p=this;y&&("first"in y&&(this.first=function(f){if(!f&&p.resource.rest.options.promises)return o.promisify(p,"first",[]);p.get(y.first,f)}),"current"in y&&(this.current=function(f){if(!f&&p.resource.rest.options.promises)return o.promisify(p,"current",[]);p.get(y.current,f)}),this.next=function(f){if(!f&&p.resource.rest.options.promises)return o.promisify(p,"next",[]);"next"in y?p.get(y.next,f):f(null,null)},this.hasNext=function(){return"next"in y},this.isLast=function(){var f;return!(!((f=R.hasNext)===null||f===void 0)&&f.call(R))})}return T.prototype.get=function(x,b){var y=this.resource;d.default.get(y.rest,y.path,y.headers,x,y.envelope,function(R,p,f,c,s){y.handlePage(R,p,f,c,s,b)})},T}();n.PaginatedResult=l;var A=function(T){a.__extends(x,T);function x(b,y,R,p,f,c){var s=T.call(this,b,y,f)||this;return s.statusCode=p,s.success=p<300&&p>=200,s.headers=R,s.errorCode=c&&c.code,s.errorMessage=c&&c.message,s}return x.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},x}(l);n.HttpPaginatedResponse=A,n.default=M},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.isRetriable=void 0;var a=i(0),o=a.__importDefault(i(4)),u={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},d={disconnected:function(){return o.default.fromValues({statusCode:400,code:u.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return o.default.fromValues({statusCode:400,code:u.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return o.default.fromValues({statusCode:400,code:u.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return o.default.fromValues({statusCode:400,code:u.CLOSING,message:"Connection closing"})},closed:function(){return o.default.fromValues({statusCode:400,code:u.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return o.default.fromValues({statusCode:500,code:u.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return o.default.fromValues({statusCode:500,code:u.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};function h(m){return!m.statusCode||!m.code||m.statusCode>=500?!0:Object.values(u).includes(m.code)}n.isRetriable=h,n.default=d},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a;(function(o){o[o.REQ_SEND=0]="REQ_SEND",o[o.REQ_RECV=1]="REQ_RECV",o[o.REQ_RECV_POLL=2]="REQ_RECV_POLL",o[o.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"})(a||(a={})),n.default=a},function(e,n,i){(function(a,o){e.exports=o(i(6),i(5),i(58),i(11),i(40),i(32),i(25),i(27),i(28),i(59),i(60))})(this,function(a){return a})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(2)),u=function(){function d(h){this.members=h||[]}return d.prototype.call=function(){for(var h=[],m=0;m<arguments.length;m++)h[m]=arguments[m];for(var C=0,w=this.members;C<w.length;C++){var M=w[C];if(M)try{M.apply(void 0,h)}catch(l){o.default.logAction(o.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+l+"; stack = "+l.stack)}}},d.prototype.push=function(){for(var h,m=[],C=0;C<arguments.length;C++)m[C]=arguments[C];(h=this.members).push.apply(h,m)},d.create=function(h){var m=new d(h);return Object.assign(function(){for(var C=[],w=0;w<arguments.length;w++)C[w]=arguments[w];return m.call.apply(m,C)},{push:function(C){return m.push(C)}})},d}();n.default=u},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){(function(){var o=a,u=o.lib,d=u.Base,h=o.enc,m=h.Utf8,C=o.algo;C.HMAC=d.extend({init:function(w,M){w=this._hasher=new w.init,typeof M=="string"&&(M=m.parse(M));var l=w.blockSize,A=l*4;M.sigBytes>A&&(M=w.finalize(M)),M.clamp();for(var T=this._oKey=M.clone(),x=this._iKey=M.clone(),b=T.words,y=x.words,R=0;R<l;R++)b[R]^=1549556828,y[R]^=909522486;T.sigBytes=x.sigBytes=A,this.reset()},reset:function(){var w=this._hasher;w.reset(),w.update(this._iKey)},update:function(w){return this._hasher.update(w),this},finalize:function(w){var M=this._hasher,l=M.finalize(w);M.reset();var A=M.finalize(this._oKey.clone().concat(l));return A}})})()})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(10)),u=a.__importStar(i(1)),d=a.__importDefault(i(7)),h=a.__importDefault(i(2)),m=a.__importDefault(i(21)),C=a.__importDefault(i(4)),w=a.__importDefault(i(3)),M=o.default.Action,l=o.default.fromValues({action:M.CLOSE}),A=o.default.fromValues({action:M.DISCONNECT}),T=function(x){a.__extends(b,x);function b(y,R,p,f){var c=x.call(this)||this;return f&&(p.format=void 0,p.heartbeats=!0),c.connectionManager=y,y.registerProposedTransport(c),c.auth=R,c.params=p,c.timeouts=p.options.timeouts,c.format=p.format,c.isConnected=!1,c.isFinished=!1,c.isDisposed=!1,c.maxIdleInterval=null,c.idleTimer=null,c.lastActivity=null,c}return b.prototype.connect=function(){},b.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",m.default.closed())},b.prototype.disconnect=function(y){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",y||m.default.disconnected())},b.prototype.fail=function(y){this.isConnected&&this.requestDisconnect(),this.finish("failed",y||m.default.failed())},b.prototype.finish=function(y,R){var p;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((p=this.idleTimer)!==null&&p!==void 0?p:void 0),this.idleTimer=null,this.emit(y,R),this.dispose())},b.prototype.onProtocolMessage=function(y){switch(h.default.shouldLog(h.default.LOG_MICRO)&&h.default.logAction(h.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+o.default.stringify(y)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),y.action){case M.HEARTBEAT:h.default.logAction(h.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",y.id);break;case M.CONNECTED:this.onConnect(y),this.emit("connected",y.error,y.connectionId,y.connectionDetails,y);break;case M.CLOSED:this.onClose(y);break;case M.DISCONNECTED:this.onDisconnect(y);break;case M.ACK:this.emit("ack",y.msgSerial,y.count);break;case M.NACK:this.emit("nack",y.msgSerial,y.count,y.error);break;case M.SYNC:this.connectionManager.onChannelMessage(y,this);break;case M.ACTIVATE:break;case M.AUTH:this.auth.authorize(function(R){R&&h.default.logAction(h.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+u.inspectError(R))});break;case M.ERROR:if(h.default.logAction(h.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+w.default.Config.inspect(y.error)+(y.channel?", channel: "+y.channel:"")),y.channel===void 0){this.onFatalError(y);break}this.connectionManager.onChannelMessage(y,this);break;default:this.connectionManager.onChannelMessage(y,this)}},b.prototype.onConnect=function(y){if(this.isConnected=!0,!y.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var R=y.connectionDetails.maxIdleInterval;R&&(this.maxIdleInterval=R+this.timeouts.realtimeRequestTimeout,this.onActivity())},b.prototype.onDisconnect=function(y){var R=y&&y.error;h.default.logAction(h.default.LOG_MINOR,"Transport.onDisconnect()","err = "+u.inspectError(R)),this.finish("disconnected",R)},b.prototype.onFatalError=function(y){var R=y&&y.error;h.default.logAction(h.default.LOG_MINOR,"Transport.onFatalError()","err = "+u.inspectError(R)),this.finish("failed",R)},b.prototype.onClose=function(y){var R=y&&y.error;h.default.logAction(h.default.LOG_MINOR,"Transport.onClose()","err = "+u.inspectError(R)),this.finish("closed",R)},b.prototype.requestClose=function(){h.default.logAction(h.default.LOG_MINOR,"Transport.requestClose()",""),this.send(l)},b.prototype.requestDisconnect=function(){h.default.logAction(h.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(A)},b.prototype.ping=function(y){var R={action:o.default.Action.HEARTBEAT};y&&(R.id=y),this.send(o.default.fromValues(R))},b.prototype.dispose=function(){h.default.logAction(h.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},b.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=u.now(),this.setIdleTimer(this.maxIdleInterval+100))},b.prototype.setIdleTimer=function(y){var R=this;this.idleTimer||(this.idleTimer=setTimeout(function(){R.onIdleTimerExpire()},y))},b.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var y=u.now()-this.lastActivity,R=this.maxIdleInterval-y;if(R<=0){var p="No activity seen from realtime in "+y+"ms; assuming connection has dropped";h.default.logAction(h.default.LOG_ERROR,"Transport.onIdleTimerExpire()",p),this.disconnect(new C.default(p,80003,408))}else this.setIdleTimer(R+100)},b.tryConnect=function(y,R,p,f,c){var s=new y(R,p,f),v,g=function(L){clearTimeout(v),c({event:this.event,error:L})},S=R.options.timeouts.realtimeRequestTimeout;v=setTimeout(function(){s.off(["preconnect","disconnected","failed"]),s.dispose(),g.call({event:"disconnected"},new C.default("Timeout waiting for transport to indicate itself viable",5e4,500))},S),s.on(["failed","disconnected"],g),s.on("preconnect",function(){h.default.logAction(h.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+s),clearTimeout(v),s.off(["failed","disconnected"],g),c(null,s)}),s.connect()},b}(d.default);n.default=T},function(e,n,i){(function(a,o){e.exports=o(i(6),i(40),i(25))})(this,function(a){return function(){var o=a,u=o.lib,d=u.Base,h=u.WordArray,m=o.algo,C=m.MD5,w=m.EvpKDF=d.extend({cfg:d.extend({keySize:128/32,hasher:C,iterations:1}),init:function(M){this.cfg=this.cfg.extend(M)},compute:function(M,l){for(var A,T=this.cfg,x=T.hasher.create(),b=h.create(),y=b.words,R=T.keySize,p=T.iterations;y.length<R;){A&&x.update(A),A=x.update(M).finalize(l),x.reset();for(var f=1;f<p;f++)A=x.finalize(A),x.reset();b.concat(A)}return b.sigBytes=R*4,b}});o.EvpKDF=function(M,l,A){return w.create(A).compute(M,l)}}(),a.EvpKDF})},function(e,n,i){(function(a,o){e.exports=o(i(6),i(27))})(this,function(a){a.lib.Cipher||function(o){var u=a,d=u.lib,h=d.Base,m=d.WordArray,C=d.BufferedBlockAlgorithm,w=u.enc;w.Utf8;var M=w.Base64,l=u.algo,A=l.EvpKDF,T=d.Cipher=C.extend({cfg:h.extend(),createEncryptor:function(k,_){return this.create(this._ENC_XFORM_MODE,k,_)},createDecryptor:function(k,_){return this.create(this._DEC_XFORM_MODE,k,_)},init:function(k,_,I){this.cfg=this.cfg.extend(I),this._xformMode=k,this._key=_,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(k){return this._append(k),this._process()},finalize:function(k){k&&this._append(k);var _=this._doFinalize();return _},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function k(_){return typeof _=="string"?L:v}return function(_){return{encrypt:function(I,O,E){return k(O).encrypt(_,I,O,E)},decrypt:function(I,O,E){return k(O).decrypt(_,I,O,E)}}}}()});d.StreamCipher=T.extend({_doFinalize:function(){var k=this._process(!0);return k},blockSize:1});var x=u.mode={},b=d.BlockCipherMode=h.extend({createEncryptor:function(k,_){return this.Encryptor.create(k,_)},createDecryptor:function(k,_){return this.Decryptor.create(k,_)},init:function(k,_){this._cipher=k,this._iv=_}}),y=x.CBC=function(){var k=b.extend();k.Encryptor=k.extend({processBlock:function(I,O){var E=this._cipher,P=E.blockSize;_.call(this,I,O,P),E.encryptBlock(I,O),this._prevBlock=I.slice(O,O+P)}}),k.Decryptor=k.extend({processBlock:function(I,O){var E=this._cipher,P=E.blockSize,F=I.slice(O,O+P);E.decryptBlock(I,O),_.call(this,I,O,P),this._prevBlock=F}});function _(I,O,E){var P,F=this._iv;F?(P=F,this._iv=o):P=this._prevBlock;for(var B=0;B<E;B++)I[O+B]^=P[B]}return k}(),R=u.pad={},p=R.Pkcs7={pad:function(k,_){for(var I=_*4,O=I-k.sigBytes%I,E=O<<24|O<<16|O<<8|O,P=[],F=0;F<O;F+=4)P.push(E);var B=m.create(P,O);k.concat(B)},unpad:function(k){var _=k.words[k.sigBytes-1>>>2]&255;k.sigBytes-=_}};d.BlockCipher=T.extend({cfg:T.cfg.extend({mode:y,padding:p}),reset:function(){var k;T.reset.call(this);var _=this.cfg,I=_.iv,O=_.mode;this._xformMode==this._ENC_XFORM_MODE?k=O.createEncryptor:(k=O.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==k?this._mode.init(this,I&&I.words):(this._mode=k.call(O,this,I&&I.words),this._mode.__creator=k)},_doProcessBlock:function(k,_){this._mode.processBlock(k,_)},_doFinalize:function(){var k,_=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(_.pad(this._data,this.blockSize),k=this._process(!0)):(k=this._process(!0),_.unpad(k)),k},blockSize:128/32});var f=d.CipherParams=h.extend({init:function(k){this.mixIn(k)},toString:function(k){return(k||this.formatter).stringify(this)}}),c=u.format={},s=c.OpenSSL={stringify:function(k){var _,I=k.ciphertext,O=k.salt;return O?_=m.create([1398893684,1701076831]).concat(O).concat(I):_=I,_.toString(M)},parse:function(k){var _,I=M.parse(k),O=I.words;return O[0]==1398893684&&O[1]==1701076831&&(_=m.create(O.slice(2,4)),O.splice(0,4),I.sigBytes-=16),f.create({ciphertext:I,salt:_})}},v=d.SerializableCipher=h.extend({cfg:h.extend({format:s}),encrypt:function(k,_,I,O){O=this.cfg.extend(O);var E=k.createEncryptor(I,O),P=E.finalize(_),F=E.cfg;return f.create({ciphertext:P,key:I,iv:F.iv,algorithm:k,mode:F.mode,padding:F.padding,blockSize:k.blockSize,formatter:O.format})},decrypt:function(k,_,I,O){O=this.cfg.extend(O),_=this._parse(_,O.format);var E=k.createDecryptor(I,O).finalize(_.ciphertext);return E},_parse:function(k,_){return typeof k=="string"?_.parse(k,this):k}}),g=u.kdf={},S=g.OpenSSL={execute:function(k,_,I,O){O||(O=m.random(64/8));var E=A.create({keySize:_+I}).compute(k,O),P=m.create(E.words.slice(_),I*4);return E.sigBytes=_*4,f.create({key:E,iv:P,salt:O})}},L=d.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:S}),encrypt:function(k,_,I,O){O=this.cfg.extend(O);var E=O.kdf.execute(I,k.keySize,k.ivSize);O.iv=E.iv;var P=v.encrypt.call(this,k,_,E.key,O);return P.mixIn(E),P},decrypt:function(k,_,I,O){O=this.cfg.extend(O),_=this._parse(_,O.format);var E=O.kdf.execute(I,k.keySize,k.ivSize,_.salt);O.iv=E.iv;var P=v.decrypt.call(this,k,_,E.key,O);return P}})}()})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.Request=n.createRequest=void 0;var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(12)),d=a.__importDefault(i(3)),h=a.__importDefault(i(7)),m=i(4),C=a.__importDefault(i(8)),w=a.__importDefault(i(2)),M=a.__importDefault(i(22)),l=o.getGlobalObject(),A=function(){},T=l._ablyjs_jsonp={};T._=function(c){return T["_"+c]||A};var x=1,b="jsonp";function y(c,s,v,g,S,L,k){return L=L||C.default.TIMEOUTS,new p(void 0,c,s,o.copy(v),g,S,L,k)}n.createRequest=y;var R=function(c){a.__extends(s,c);function s(v,g,S){var L=c.call(this,v,g,S)||this;return L.shortName=b,S.stream=!1,L}return s.isAvailable=function(){return d.default.Config.jsonpSupported&&d.default.Config.allowComet},s.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},s.prototype.createRequest=function(v,g,S,L,k,_,I){return _=(this===null||this===void 0?void 0:this.timeouts)||_||C.default.TIMEOUTS,y(v,g,S,L,k,_,I)},s}(u.default),p=function(c){a.__extends(s,c);function s(v,g,S,L,k,_,I,O){var E=c.call(this)||this;return v===void 0&&(v=x++),E.id=v,E.uri=g,E.params=L||{},E.params.rnd=o.cheapRandStr(),S&&(S["X-Ably-Version"]&&(E.params.v=S["X-Ably-Version"]),S["X-Ably-Lib"]&&(E.params.lib=S["X-Ably-Lib"])),E.body=k,E.method=O,E.requestMode=_,E.timeouts=I,E.requestComplete=!1,E}return s.prototype.exec=function(){var v=this,g=this.id,S=this.body,L=this.method,k=this.uri,_=this.params;_.callback="_ablyjs_jsonp._("+g+")",_.envelope="jsonp",S&&(_.body=S),L&&L!=="get"&&(_.method=L);var I=this.script=document.createElement("script"),O=k+o.toQueryString(_);I.src=O,I.src.split("/").slice(-1)[0]!==O.split("/").slice(-1)[0]&&w.default.logAction(w.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),I.async=!0,I.type="text/javascript",I.charset="UTF-8",I.onerror=function(F){v.complete(new m.PartialErrorInfo("JSONP script error (event: "+d.default.Config.inspect(F)+")",null,400))},T["_"+g]=function(F){if(F.statusCode){var B=F.response;if(F.statusCode==204)v.complete(null,null,null,F.statusCode);else if(!B)v.complete(new m.PartialErrorInfo("Invalid server response: no envelope detected",null,500));else if(F.statusCode<400||o.isArray(B))v.complete(null,B,F.headers,F.statusCode);else{var z=B.error||new m.PartialErrorInfo("Error response received from server",null,F.statusCode);v.complete(z)}}else v.complete(null,F)};var E=this.requestMode==M.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),E);var P=document.getElementsByTagName("head")[0];P.insertBefore(I,P.firstChild)},s.prototype.complete=function(v,g,S,L){if(S=S||{},!this.requestComplete){this.requestComplete=!0;var k=void 0;g&&(k=typeof g=="string"?"text/plain":"application/json",S["content-type"]=k,this.emit("data",g)),this.emit("complete",v,g,S,!0,L),this.dispose()}},s.prototype.abort=function(){this.dispose()},s.prototype.dispose=function(){var v=this.timer;v&&(clearTimeout(v),this.timer=null);var g=this.script;g.parentNode&&g.parentNode.removeChild(g),delete T[this.id],this.emit("disposed")},s}(h.default);n.Request=p;function f(c){return l.JSONPTransport=R,R.isAvailable()&&(c.supportedTransports[b]=R),R}n.default=f},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(2)),d=a.__importDefault(i(8)),h=a.__importDefault(i(18)),m=a.__importDefault(i(46)),C=a.__importDefault(i(20)),w=a.__importDefault(i(33)),M=a.__importDefault(i(4)),l=a.__importDefault(i(49)),A=a.__importDefault(i(19)),T=a.__importDefault(i(3)),x=a.__importDefault(i(9)),b=a.__importDefault(i(16)),y=a.__importDefault(i(15)),R=function(){},p=function(){function c(s){if(!s){var v="no options provided";throw u.default.logAction(u.default.LOG_ERROR,"Rest()",v),new Error(v)}var g=d.default.objectifyOptions(s);g.log?(u.default.setLog(g.log.level,g.log.handler),u.default.deprecated("The `log` client option","Equivalent functionality is provided by the `logLevel` and `logHandler` client options. Update your client options code of the form `{ log: { level: logLevel, handler: logHandler } }` to instead be `{ logLevel, logHandler }`.")):u.default.setLog(g.logLevel,g.logHandler),u.default.logAction(u.default.LOG_MICRO,"Rest()","initialized with clientOptions "+T.default.Config.inspect(s));var S=this.options=d.default.normaliseOptions(g);if(S.key){var L=S.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!L){var v="invalid key parameter";throw u.default.logAction(u.default.LOG_ERROR,"Rest()",v),new M.default(v,40400,404)}S.keyName=L[1],S.keySecret=L[2]}if("clientId"in S)if(typeof S.clientId=="string"||S.clientId===null){if(S.clientId==="*")throw new M.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new M.default("clientId must be either a string or null",40012,400);u.default.logAction(u.default.LOG_MINOR,"Rest()","started; version = "+d.default.version),this.baseUri=this.authority=function(k){return d.default.getHttpScheme(S)+k+":"+d.default.getPort(S,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new T.default.Http(S),this.auth=new h.default(this,S),this.channels=new f(this),this.push=new m.default(this)}return c.prototype.stats=function(s,v){if(v===void 0)if(typeof s=="function")v=s,s=null;else{if(this.options.promises)return o.promisify(this,"stats",[s]);v=R}var g=o.defaultGetHeaders(this.options),S=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,L=this.http.supportsLinkHeaders?void 0:S;this.options.headers&&o.mixin(g,this.options.headers),new C.default(this,"/stats",g,L,function(k,_,I){for(var O=I?k:JSON.parse(k),E=0;E<O.length;E++)O[E]=l.default.fromValues(O[E]);return O}).get(s,v)},c.prototype.time=function(s,v){var g=this;if(v===void 0){if(typeof s=="function")v=s,s=null;else if(this.options.promises)return o.promisify(this,"time",[s])}var S=v||R,L=o.defaultGetHeaders(this.options);this.options.headers&&o.mixin(L,this.options.headers);var k=function(_){return g.authority(_)+"/time"};this.http.do(A.default.Get,this,k,L,null,s,function(_,I,O,E){if(_){S(_);return}E||(I=JSON.parse(I));var P=I[0];if(!P){S(new M.default("Internal error (unexpected result type from GET /time)",5e4,500));return}g.serverTimeOffset=P-o.now(),S(null,P)})},c.prototype.request=function(s,v,g,S,L,k){var _=this.options.useBinaryProtocol,I=_?T.default.Config.msgpack.encode:JSON.stringify,O=_?T.default.Config.msgpack.decode:JSON.parse,E=_?o.Format.msgpack:o.Format.json,P=this.http.supportsLinkHeaders?void 0:E;g=g||{};var F=s.toLowerCase(),B=F=="get"?o.defaultGetHeaders(this.options,E):o.defaultPostHeaders(this.options,E);if(k===void 0){if(this.options.promises)return o.promisify(this,"request",[s,v,g,S,L]);k=R}typeof S!="string"&&(S=I(S)),this.options.headers&&o.mixin(B,this.options.headers),L&&o.mixin(B,L);var z=new C.default(this,v,B,P,function(Y,$,D){return o.ensureArray(D?Y:O(Y))},!0);if(!o.arrIn(T.default.Http.methods,F))throw new M.default("Unsupported method "+F,40500,405);o.arrIn(T.default.Http.methodsWithBody,F)?z[F](g,S,k):z[F](g,k)},c.prototype.batchPublish=function(s,v){if(v===void 0){if(this.options.promises)return o.promisify(this,"batchPublish",[s]);v=R}var g=v,S,L;o.isArray(s)?(S=s,L=!1):(S=[s],L=!0);var k=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,_=o.defaultPostHeaders(this.options,k);this.options.headers&&o.mixin(_,this.options.headers);var I=o.encodeBody(S,k);y.default.post(this,"/messages",I,_,{newBatchResponse:"true"},null,function(O,E,P,F){if(O){g(O);return}var B=F?E:o.decodeBody(E,k);L?g(null,B[0]):g(null,B)})},c.prototype.batchPresence=function(s,v){if(v===void 0){if(this.options.promises)return o.promisify(this,"batchPresence",[s]);v=R}var g=v,S=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,L=o.defaultPostHeaders(this.options,S);this.options.headers&&o.mixin(L,this.options.headers);var k=s.join(",");y.default.get(this,"/presence",L,{newBatchResponse:"true",channels:k},null,function(_,I,O,E){if(_){g(_);return}var P=E?I:o.decodeBody(I,S);g(null,P)})},c.prototype.setLog=function(s){u.default.setLog(s.level,s.handler)},c.Promise=function(s){return s=d.default.objectifyOptions(s),s.promises=!0,new c(s)},c.Callbacks=c,c.Platform=T.default,c.Message=x.default,c.PresenceMessage=b.default,c}(),f=function(){function c(s){this.rest=s,this.all=Object.create(null)}return c.prototype.get=function(s,v){s=String(s);var g=this.all[s];return g?v&&g.setOptions(v):this.all[s]=g=new w.default(this.rest,s,v),g},c.prototype.release=function(s){delete this.all[String(s)]},c}();n.default=p},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return a.enc.Utf8})},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(o){var u=a,d=u.lib,h=d.WordArray,m=d.Hasher,C=u.algo,w=[],M=[];(function(){function T(R){for(var p=o.sqrt(R),f=2;f<=p;f++)if(!(R%f))return!1;return!0}function x(R){return(R-(R|0))*4294967296|0}for(var b=2,y=0;y<64;)T(b)&&(y<8&&(w[y]=x(o.pow(b,1/2))),M[y]=x(o.pow(b,1/3)),y++),b++})();var l=[],A=C.SHA256=m.extend({_doReset:function(){this._hash=new h.init(w.slice(0))},_doProcessBlock:function(T,x){for(var b=this._hash.words,y=b[0],R=b[1],p=b[2],f=b[3],c=b[4],s=b[5],v=b[6],g=b[7],S=0;S<64;S++){if(S<16)l[S]=T[x+S]|0;else{var L=l[S-15],k=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,_=l[S-2],I=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;l[S]=k+l[S-7]+I+l[S-16]}var O=c&s^~c&v,E=y&R^y&p^R&p,P=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),F=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),B=g+F+O+M[S]+l[S],z=P+E;g=v,v=s,s=c,c=f+B|0,f=p,p=R,R=y,y=B+z|0}b[0]=b[0]+y|0,b[1]=b[1]+R|0,b[2]=b[2]+p|0,b[3]=b[3]+f|0,b[4]=b[4]+c|0,b[5]=b[5]+s|0,b[6]=b[6]+v|0,b[7]=b[7]+g|0},_doFinalize:function(){var T=this._data,x=T.words,b=this._nDataBytes*8,y=T.sigBytes*8;return x[y>>>5]|=128<<24-y%32,x[(y+64>>>9<<4)+14]=o.floor(b/4294967296),x[(y+64>>>9<<4)+15]=b,T.sigBytes=x.length*4,this._process(),this._hash},clone:function(){var T=m.clone.call(this);return T._hash=this._hash.clone(),T}});u.SHA256=m._createHelper(A),u.HmacSHA256=m._createHmacHelper(A)}(Math),a.SHA256})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(7)),d=a.__importDefault(i(2)),h=a.__importDefault(i(34)),m=a.__importDefault(i(9)),C=a.__importDefault(i(4)),w=a.__importDefault(i(20)),M=a.__importDefault(i(15)),l=a.__importDefault(i(3));function A(){}var T=9;function x(R){return o.arrEvery(R,function(p){return!p.id})}function b(R){var p=R||{};if(p.cipher){if(!l.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var f=l.default.Crypto.getCipher(p.cipher);p.cipher=f.cipherParams,p.channelCipher=f.cipher}else"cipher"in p&&(p.cipher=void 0,p.channelCipher=null);return p}var y=function(R){a.__extends(p,R);function p(f,c,s){var v=R.call(this)||this;return d.default.logAction(d.default.LOG_MINOR,"Channel()","started; name = "+c),v.rest=f,v.name=c,v.basePath="/channels/"+encodeURIComponent(c),v.presence=new h.default(v),v.channelOptions=b(s),v}return p.prototype.setOptions=function(f){this.channelOptions=b(f)},p.prototype.history=function(f,c){if(d.default.logAction(d.default.LOG_MICRO,"Channel.history()","channel = "+this.name),c===void 0)if(typeof f=="function")c=f,f=null;else{if(this.rest.options.promises)return o.promisify(this,"history",arguments);c=A}this._history(f,c)},p.prototype._history=function(f,c){var s=this.rest,v=s.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,g=this.rest.http.supportsLinkHeaders?void 0:v,S=o.defaultGetHeaders(s.options,v);s.options.headers&&o.mixin(S,s.options.headers);var L=this.channelOptions;new w.default(s,this.basePath+"/messages",S,g,function(k,_,I){return m.default.fromResponseBody(k,L,I?void 0:v)}).get(f,c)},p.prototype.publish=function(){var f=this,c=arguments.length,s=arguments[0],v=arguments[1],g=arguments[c-1],S,L;if(typeof g!="function"){if(this.rest.options.promises)return o.promisify(this,"publish",arguments);g=A}if(typeof s=="string"||s===null)S=[m.default.fromValues({name:s,data:v})],L=arguments[2];else if(o.isObject(s))S=[m.default.fromValues(s)],L=arguments[1];else if(o.isArray(s))S=m.default.fromValuesArray(s),L=arguments[1];else throw new C.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);(typeof L!="object"||!L)&&(L={});var k=this.rest,_=k.options,I=_.useBinaryProtocol?o.Format.msgpack:o.Format.json,O=k.options.idempotentRestPublishing,E=o.defaultPostHeaders(k.options,I);if(_.headers&&o.mixin(E,_.headers),O&&x(S)){var P=o.randomString(T);o.arrForEach(S,function(F,B){F.id=P+":"+B.toString()})}m.default.encodeArray(S,this.channelOptions,function(F){if(F){g(F);return}var B=m.default.getMessagesSize(S),z=_.maxMessageSize;if(B>z){g(new C.default("Maximum size of messages that can be published at once exceeded ( was "+B+" bytes; limit is "+z+" bytes)",40009,400));return}f._publish(m.default.serialize(S,I),E,L,g)})},p.prototype._publish=function(f,c,s,v){M.default.post(this.rest,this.basePath+"/messages",f,c,s,null,v)},p.prototype.status=function(f){if(typeof f!="function"&&this.rest.options.promises)return o.promisify(this,"status",[]);var c=this.rest.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,s=o.defaultPostHeaders(this.rest.options,c);M.default.get(this.rest,this.basePath,s,{},c,f||A)},p}(u.default);n.default=y},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(7)),d=a.__importDefault(i(2)),h=a.__importDefault(i(20)),m=a.__importDefault(i(16));function C(){}var w=function(M){a.__extends(l,M);function l(A){var T=M.call(this)||this;return T.channel=A,T.basePath=A.basePath+"/presence",T}return l.prototype.get=function(A,T){if(d.default.logAction(d.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"get",arguments);T=C}var x=this.channel.rest,b=x.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=this.channel.rest.http.supportsLinkHeaders?void 0:b,R=o.defaultGetHeaders(x.options,b);x.options.headers&&o.mixin(R,x.options.headers);var p=this.channel.channelOptions;new h.default(x,this.basePath,R,y,function(f,c,s){return m.default.fromResponseBody(f,p,s?void 0:b)}).get(A,T)},l.prototype.history=function(A,T){return d.default.logAction(d.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(A,T)},l.prototype._history=function(A,T){if(T===void 0)if(typeof A=="function")T=A,A=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"_history",[A]);T=C}var x=this.channel.rest,b=x.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,y=this.channel.rest.http.supportsLinkHeaders?void 0:b,R=o.defaultGetHeaders(x.options,b);x.options.headers&&o.mixin(R,x.options.headers);var p=this.channel.channelOptions;new h.default(x,this.basePath+"/history",R,y,function(f,c,s){return m.default.fromResponseBody(f,p,s?void 0:b)}).get(A,T)},l}(u.default);n.default=w},function(e,n,i){(function(a){Object.defineProperty(n,"__esModule",{value:!0}),n.TransportParams=void 0;var o=i(0),u=o.__importDefault(i(10)),d=o.__importStar(i(1)),h=o.__importStar(i(52)),m=o.__importStar(i(8)),C=o.__importDefault(i(3)),w=o.__importDefault(i(7)),M=o.__importDefault(i(36)),l=o.__importDefault(i(2)),A=o.__importDefault(i(37)),T=o.__importStar(i(21)),x=o.__importStar(i(4)),b=o.__importDefault(i(18)),y=o.__importDefault(i(9)),R=o.__importDefault(i(24)),p=o.__importDefault(i(53)),f=o.__importDefault(i(26)),c=o.__importDefault(i(14)),s=function(){var Y;return typeof C.default.WebStorage<"u"&&((Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.localSupported)},v=function(){var Y;return typeof C.default.WebStorage<"u"&&((Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.sessionSupported)},g=u.default.Action,S=function(){},L="ably-transport-preference",k="ably-connection-recovery";function _(){var Y,$;return v()&&(($=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.getSession)===null||$===void 0?void 0:$.call(Y,k))}function I(Y){var $,D;return v()&&((D=($=C.default.WebStorage)===null||$===void 0?void 0:$.setSession)===null||D===void 0?void 0:D.call($,k,Y))}function O(){var Y,$;return v()&&(($=(Y=C.default.WebStorage)===null||Y===void 0?void 0:Y.removeSession)===null||$===void 0?void 0:$.call(Y,k))}function E(Y,$){return d.arrIndexOf(C.default.Defaults.transportPreferenceOrder,Y.shortName)>d.arrIndexOf(C.default.Defaults.transportPreferenceOrder,$.shortName)}function P(Y,$,D){var N;if(Y.channel!==$.channel||(N=Y.action)!==g.PRESENCE&&N!==g.MESSAGE||N!==$.action)return!1;var j=N===g.PRESENCE?"presence":"messages",G=Y[j].concat($[j]),K=y.default.getMessagesSize(G);return K>D||!d.allSame(G,"clientId")||!d.arrEvery(G,function(Z){return!Z.id})?!1:(Y[j]=G,!0)}function F(Y){try{return JSON.parse(Y)}catch{return null}}var B=function(){function Y($,D,N,j){this.options=$,this.host=D,this.mode=N,this.connectionKey=j,this.format=$.useBinaryProtocol?d.Format.msgpack:d.Format.json}return Y.prototype.getConnectParams=function($){var D=$?d.copy($):{},N=this.options;switch(this.mode){case"upgrade":D.upgrade=this.connectionKey;break;case"resume":D.resume=this.connectionKey;break;case"recover":{var j=F(N.recover);j&&(D.recover=j.connectionKey);break}}return N.clientId!==void 0&&(D.clientId=N.clientId),N.echoMessages===!1&&(D.echo="false"),this.format!==void 0&&(D.format=this.format),this.stream!==void 0&&(D.stream=this.stream),this.heartbeats!==void 0&&(D.heartbeats=this.heartbeats),D.v=m.default.protocolVersion,D.agent=(0,m.getAgentString)(this.options),N.transportParams!==void 0&&d.mixin(D,N.transportParams),D},Y.prototype.toString=function(){var $="[mode="+this.mode;return this.host&&($+=",host="+this.host),this.connectionKey&&($+=",connectionKey="+this.connectionKey),this.format&&($+=",format="+this.format),$+="]",$},Y}();n.TransportParams=B;var z=function(Y){o.__extends($,Y);function $(D,N){var j=Y.call(this)||this;j.disconnectedRetryCount=0,$.initTransports(),j.realtime=D,j.options=N;var G=N.timeouts,K=G.preferenceConnectTimeout+G.realtimeRequestTimeout;if(j.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:K,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:G.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:G.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:G.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},j.state=j.states.initialized,j.errorReason=null,j.queuedMessages=new M.default,j.msgSerial=0,j.connectionDetails=void 0,j.connectionId=void 0,j.connectionKey=void 0,j.connectionStateTtl=G.connectionStateTtl,j.maxIdleInterval=null,j.transports=d.intersect(N.transports||m.default.defaultTransports,$.supportedTransports),j.baseTransport=d.intersect(m.default.baseTransportOrder,j.transports)[0],j.upgradeTransports=d.intersect(j.transports,m.default.upgradeTransports),j.transportPreference=null,j.httpHosts=m.default.getHosts(N),j.activeProtocol=null,j.proposedTransports=[],j.pendingTransports=[],j.host=null,j.lastAutoReconnectAttempt=null,j.lastActivity=null,j.forceFallbackHost=!1,j.connectCounter=0,l.default.logAction(l.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),l.default.logAction(l.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(N.transports||m.default.defaultTransports)+"]"),l.default.logAction(l.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+j.transports+"]"),l.default.logAction(l.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+j.httpHosts+"]"),!j.transports.length){var Z="no requested transports available";throw l.default.logAction(l.default.LOG_ERROR,"realtime.ConnectionManager()",Z),new Error(Z)}var ee=C.default.Config.addEventListener;return ee&&(v()&&typeof N.recover=="function"&&ee("beforeunload",j.persistConnection.bind(j)),N.closeOnUnload===!0&&ee("beforeunload",function(){l.default.logAction(l.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),j.requestState({state:"closing"})}),ee("online",function(){j.state==j.states.disconnected||j.state==j.states.suspended?(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),j.requestState({state:"connecting"})):j.state==j.states.connecting&&(j.pendingTransports.forEach(function(ie){ie.off()}),j.disconnectAllTransports(),j.startConnect())}),ee("offline",function(){j.state==j.states.connected&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),j.disconnectAllTransports())})),j}return $.initTransports=function(){(0,p.default)($),d.arrForEach(C.default.Transports,function(D){D($)})},$.prototype.createTransportParams=function(D,N){return new B(this.options,D,N,this.connectionKey)},$.prototype.getTransportParams=function(D){var N=this,j=function(G){if(N.connectionKey){G("resume");return}if(typeof N.options.recover=="string"){G("recover");return}var K=N.options.recover,Z=_();if(Z&&typeof K=="function"){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),K(Z,function(ee){ee?(N.options.recover=Z.recoveryKey,G("recover")):G("clean")});return}G("clean")};j(function(G){var K=N.createTransportParams(null,G);if(G==="recover"){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+N.options.recover);var Z=F(N.options.recover);Z&&(N.msgSerial=Z.msgSerial)}else l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+K.toString());D(K)})},$.prototype.tryATransport=function(D,N,j){var G=this;l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+N),f.default.tryConnect($.supportedTransports[N],this,this.realtime.auth,D,function(K,Z){var ee=G.state;if(ee==G.states.closing||ee==G.states.closed||ee==G.states.failed){Z&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+ee.state+" while we were attempting the transport; closing "+Z),Z.close()),j(!0);return}if(K){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+N+" "+K.event+", err: "+K.error.toString()),b.default.isTokenErr(K.error)&&!(G.errorReason&&b.default.isTokenErr(G.errorReason))?(G.errorReason=K.error,G.realtime.auth._forceNewToken(null,null,function(ie){if(ie){G.actOnErrorFromAuthorize(ie);return}G.tryATransport(D,N,j)})):K.event==="failed"?(G.notifyState({state:"failed",error:K.error}),j(!0)):K.event==="disconnected"&&((0,T.isRetriable)(K.error)?j(!1):(G.notifyState({state:G.states.connecting.failState,error:K.error}),j(!0)));return}l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+N+"; setting pending"),G.setTransportPending(Z,D),j(null,Z)})},$.prototype.setTransportPending=function(D,N){var j=this,G=N.mode;l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+D+"; mode = "+G),d.arrDeleteValue(this.proposedTransports,D),this.pendingTransports.push(D);var K=C.default.Defaults.transportPreferenceOrder[C.default.Defaults.transportPreferenceOrder.length-1];D.once("connected",function(ee,ie,ue){G=="upgrade"&&j.activeProtocol?D.shortName!==K&&d.arrIn(j.getUpgradePossibilities(),K)&&j.activeProtocol?setTimeout(function(){j.scheduleTransportActivation(ee,D,ie,ue)},j.options.timeouts.parallelUpgradeDelay):j.scheduleTransportActivation(ee,D,ie,ue):(j.activateTransport(ee,D,ie,ue),C.default.Config.nextTick(function(){j.connectImpl(N)})),G==="recover"&&j.options.recover&&(j.options.recover=null,j.unpersistConnection())});var Z=this;D.on(["disconnected","closed","failed"],function(ee){Z.deactivateTransport(D,this.event,ee)}),this.emit("transport.pending",D)},$.prototype.scheduleTransportActivation=function(D,N,j,G){var K=this,Z=this.activeProtocol&&this.activeProtocol.getTransport(),ee=function(){N.disconnect(),d.arrDeleteValue(K.pendingTransports,N)};if(this.state!==this.states.connected&&this.state!==this.states.connecting){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+N.shortName),ee();return}if(Z&&!E(N,Z)){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+N.shortName+" is no better than current active transport "+Z.shortName+" - abandoning upgrade"),ee();return}l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+N);var ie=null;if(!N.isConnected){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+N.shortName+"is no longer connected; abandoning upgrade"),ee();return}if(this.state===this.states.connected)l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,ie=this.activeProtocol;else if(this.state!==this.states.connecting){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+N.shortName),ee();return}l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+N);var ue=function(){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+N),N.send(u.default.fromValues({action:g.ACTIVATE})),K.activateTransport(D,N,j,G),K.state===K.states.synchronizing?(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+N),K.state=K.states.connected):l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+K.state.state+", so leaving unchanged"),K.state.sendEvents&&K.sendQueuedMessages()};ie?ie.onceIdle(ue):ue()},$.prototype.activateTransport=function(D,N,j,G){var K=this;l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+N),D&&l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+D),j&&l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+j),G&&l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(G)),this.persistTransportPreference(N);var Z=this.state,ee=this.states.connected.state;if(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+Z.state),Z.state==this.states.closing.state||Z.state==this.states.closed.state||Z.state==this.states.failed.state)return l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),N.disconnect(),!1;if(d.arrDeleteValue(this.pendingTransports,N),!N.isConnected)return l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+N+" since it appears to no longer be connected"),!1;var ie=this.activeProtocol;this.activeProtocol=new h.default(N),this.host=N.params.host;var ue=G.connectionKey;if(ue&&this.connectionKey!=ue&&this.setConnection(j,G,!!D),this.onConnectionDetailsUpdate(G,N),C.default.Config.nextTick(function(){N.on("connected",function(ne,me,Te){K.onConnectionDetailsUpdate(Te,N),K.emit("update",new A.default(ee,ee,null,ne))})}),Z.state===this.states.connected.state?D&&(this.errorReason=this.realtime.connection.errorReason=D,this.emit("update",new A.default(ee,ee,null,D))):(this.notifyState({state:"connected",error:D}),this.errorReason=this.realtime.connection.errorReason=D||null),this.emit("transport.active",N),ie)if(ie.messageQueue.count()>0&&l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+ie.transport.shortName+", new one is "+N.shortName+") finishing with "+ie.messageQueue.count()+" messages still pending"),ie.transport===N){var pe="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+N.shortName+"; stack = "+new Error().stack;l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.activateTransport()",pe)}else ie.finish();return d.safeArrForEach(this.pendingTransports,function(ne){if(ne===N){var me="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+N.shortName+"; stack = "+new Error().stack;l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.activateTransport()",me),d.arrDeleteValue(K.pendingTransports,N)}else ne.disconnect()}),d.safeArrForEach(this.proposedTransports,function(ne){ne===N?(l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+N.shortName+"; stack = "+new Error().stack),d.arrDeleteValue(K.proposedTransports,N)):ne.dispose()}),!0},$.prototype.deactivateTransport=function(D,N,j){var G=this.activeProtocol,K=G&&G.getTransport()===D,Z=d.arrDeleteValue(this.pendingTransports,D),ee=d.arrDeleteValue(this.proposedTransports,D),ie=this.noTransportsScheduledForActivation();if(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+D),l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+N+(K?"; was active":Z?"; was pending":ee?"; was proposed":"")+(ie?"":"; another transport is scheduled for activation")),j&&j.message&&l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+j.message),K&&(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(G.getPendingMessages()),C.default.Config.nextTick(function(){G.clearPendingMessages()}),this.activeProtocol=this.host=null),this.emit("transport.inactive",D),K&&ie||K&&N==="failed"||N==="closed"||G===null&&Z&&this.pendingTransports.length===0){if(N==="disconnected"&&j&&j.statusCode>500&&this.httpHosts.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:N,error:j,retryImmediately:!0});return}var ue=N==="failed"&&b.default.isTokenErr(j)?"disconnected":N;this.notifyState({state:ue,error:j});return}K&&N==="disconnected"&&this.state!==this.states.synchronizing&&(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:j}))},$.prototype.noTransportsScheduledForActivation=function(){return d.isEmpty(this.pendingTransports)||this.pendingTransports.every(function(D){return!D.isConnected})},$.prototype.setConnection=function(D,N,j){var G=this.connectionId,K=G&&G!==D,Z=!G&&j;(K||Z)&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==D&&l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=D,this.realtime.connection.key=this.connectionKey=N.connectionKey},$.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},$.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},$.prototype.checkConnectionStateFreshness=function(){if(!(!this.lastActivity||!this.connectionId)){var D=d.now()-this.lastActivity;D>this.connectionStateTtl+this.maxIdleInterval&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+D+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},$.prototype.persistConnection=function(){if(v()){var D=this.createRecoveryKey();D&&I({recoveryKey:D,disconnectedAt:d.now(),location:a.location,clientId:this.realtime.auth.clientId})}},$.prototype.unpersistConnection=function(){O()},$.prototype.getError=function(){return this.errorReason||this.getStateError()},$.prototype.getStateError=function(){var D,N;return(N=(D=T.default)[this.state.state])===null||N===void 0?void 0:N.call(D)},$.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},$.prototype.enactStateChange=function(D){var N=D.current==="failed"?l.default.LOG_ERROR:l.default.LOG_MAJOR;l.default.logAction(N,"Connection state",D.current+(D.reason?"; reason: "+D.reason:"")),l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+D.current+"; reason = "+(D.reason&&D.reason.message));var j=this.state=this.states[D.current];D.reason&&(this.errorReason=D.reason,this.realtime.connection.errorReason=D.reason),(j.terminal||j.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",D)},$.prototype.startTransitionTimer=function(D){var N=this;l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+D.state),this.transitionTimer&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(function(){N.transitionTimer&&(N.transitionTimer=null,l.default.logAction(l.default.LOG_MINOR,"ConnectionManager "+D.state+" timer expired","requesting new state: "+D.failState),N.notifyState({state:D.failState}))},D.retryDelay)},$.prototype.cancelTransitionTimer=function(){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},$.prototype.startSuspendTimer=function(){var D=this;this.suspendTimer||(this.suspendTimer=setTimeout(function(){D.suspendTimer&&(D.suspendTimer=null,l.default.logAction(l.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),D.states.connecting.failState="suspended",D.notifyState({state:"suspended"}))},this.connectionStateTtl))},$.prototype.checkSuspendTimer=function(D){D!=="disconnected"&&D!=="suspended"&&D!=="connecting"&&this.cancelSuspendTimer()},$.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},$.prototype.startRetryTimer=function(D){var N=this;this.retryTimer=setTimeout(function(){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),N.retryTimer=null,N.requestState({state:"connecting"})},D)},$.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},$.prototype.notifyState=function(D){var N=this,j,G,K=D.state,Z=K==="disconnected"&&(this.state===this.states.connected||this.state===this.states.synchronizing||D.retryImmediately||this.state===this.states.connecting&&D.error&&b.default.isTokenErr(D.error)&&!(this.errorReason&&b.default.isTokenErr(this.errorReason)));if(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+K+(Z?"; will retry connection immediately":"")),K!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(D.state),(K==="suspended"||K==="connected")&&(this.disconnectedRetryCount=0),!this.state.terminal)){var ee=this.states[D.state],ie=ee.retryDelay;ee.state==="disconnected"&&(this.disconnectedRetryCount++,ie=d.getRetryTime(ee.retryDelay,this.disconnectedRetryCount));var ue=new A.default(this.state.state,ee.state,ie,D.error||((G=(j=T.default)[ee.state])===null||G===void 0?void 0:G.call(j)));if(Z){var pe=function(){N.state===N.states.disconnected&&(N.lastAutoReconnectAttempt=d.now(),N.requestState({state:"connecting"}))},ne=this.lastAutoReconnectAttempt&&d.now()-this.lastAutoReconnectAttempt+1;ne&&ne<1e3?(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+ne+"ms ago, waiting another "+(1e3-ne)+"ms before trying again"),setTimeout(pe,1e3-ne)):C.default.Config.nextTick(pe)}else(K==="disconnected"||K==="suspended")&&this.startRetryTimer(ie);(K==="disconnected"&&!Z||K==="suspended"||ee.terminal)&&C.default.Config.nextTick(function(){N.disconnectAllTransports()}),K=="connected"&&!this.activeProtocol&&l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(ue),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(K,ue.reason),this.failQueuedMessages(ue.reason))}},$.prototype.requestState=function(D){var N=this,j,G,K=D.state;if(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+K+"; current state: "+this.state.state),K!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(K),!(K=="connecting"&&this.state.state=="connected")&&!(K=="closing"&&this.state.state=="closed"))){var Z=this.states[K],ee=new A.default(this.state.state,Z.state,null,D.error||((G=(j=T.default)[Z.state])===null||G===void 0?void 0:G.call(j)));this.enactStateChange(ee),K=="connecting"&&C.default.Config.nextTick(function(){N.startConnect()}),K=="closing"&&this.closeImpl()}},$.prototype.startConnect=function(){var D=this;if(this.state!==this.states.connecting){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}var N=this.realtime.auth,j=++this.connectCounter,G=function(){D.checkConnectionStateFreshness(),D.getTransportParams(function(Z){if(Z.mode==="recover"&&Z.options.recover){var ee=F(Z.options.recover);ee&&D.realtime.channels.recoverChannels(ee.channelSerials)}j===D.connectCounter&&D.connectImpl(Z,j)})};if(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),N.method==="basic")G();else{var K=function(Z){j===D.connectCounter&&(Z?D.actOnErrorFromAuthorize(Z):G())};this.errorReason&&b.default.isTokenErr(this.errorReason)?N._forceNewToken(null,null,K):N._ensureValidAuthCredentials(!1,K)}},$.prototype.connectImpl=function(D,N){var j=this.state.state;j!==this.states.connecting.state&&j!==this.states.connected.state?l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+j):this.pendingTransports.length?l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):j==this.states.connected.state?this.upgradeIfNeeded(D):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(D,N):this.connectBase(D,N)},$.prototype.connectPreference=function(D,N){var j=this,G=this.getTransportPreference(),K=!1;d.arrIn(this.transports,G)||(this.unpersistTransportPreference(),this.connectImpl(D,N)),l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+G);var Z=setTimeout(function(){K=!0,j.state.state!==j.states.connected.state&&(l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+G+" failed; clearing preference and trying from scratch"),j.disconnectAllTransports(),j.unpersistTransportPreference()),j.connectImpl(D,N)},this.options.timeouts.preferenceConnectTimeout);D.host=this.httpHosts[0],this.tryATransport(D,G,function(ee,ie){clearTimeout(Z),K&&ie?(ie.off(),ie.disconnect(),d.arrDeleteValue(j.pendingTransports,ie)):!ie&&!ee&&(j.unpersistTransportPreference(),j.connectImpl(D,N))})},$.prototype.connectBase=function(D,N){var j=this,G=function(ue){j.notifyState({state:j.states.connecting.failState,error:ue})},K=this.httpHosts.slice(),Z=function(ue,pe){N===j.connectCounter&&!pe&&!ue&&ie()};l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var ee=K.shift();if(!ee){G(new x.default("Unable to connect (no available host)",80003,404));return}D.host=ee;var ie=function(){if(!K.length){G(new x.default("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!j.realtime.http.checkConnectivity){G(new x.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500));return}j.realtime.http.checkConnectivity(function(ue,pe){if(N===j.connectCounter){if(ue){G(ue);return}if(!pe){G(new x.default("Unable to connect (network unreachable)",80003,404));return}D.host=d.arrPopRandomElement(K),j.tryATransport(D,j.baseTransport,Z)}})};if(this.forceFallbackHost&&K.length){this.forceFallbackHost=!1,ie();return}this.tryATransport(D,this.baseTransport,Z)},$.prototype.getUpgradePossibilities=function(){var D=this.activeProtocol.getTransport().shortName,N=d.arrIndexOf(this.upgradeTransports,D);return this.upgradeTransports.slice(N+1)},$.prototype.upgradeIfNeeded=function(D){var N=this,j=this.getUpgradePossibilities();l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+C.default.Config.inspect(j)),j.length&&d.arrForEach(j,function(G){var K=N.createTransportParams(D.host,"upgrade");N.tryATransport(K,G,S)})},$.prototype.closeImpl=function(){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),d.safeArrForEach(this.pendingTransports,function(D){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+D),D&&D.close()}),d.safeArrForEach(this.proposedTransports,function(D){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+D),D&&D.dispose()}),this.activeProtocol&&(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},$.prototype.onAuthUpdated=function(D,N){var j=this,G;switch(this.state.state){case"connected":{if(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var K=this.activeProtocol.getTransport().params;C.default.Config.nextTick(function(){j.state.state==="connected"&&j.upgradeIfNeeded(K)})}var Z=(G=this.activeProtocol)===null||G===void 0?void 0:G.getTransport();Z&&Z.onAuthUpdated&&Z.onAuthUpdated(D);var ee=u.default.fromValues({action:g.AUTH,auth:{accessToken:D.token}});this.send(ee);var ie=function(){j.off(ue),N(null,D)},ue=function(ne){ne.current==="failed"&&(j.off(ie),j.off(ue),N(ne.reason||j.getStateError()))};this.once("connectiondetails",ie),this.on("connectionstate",ue);break}case"connecting":l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");var pe=function(ne){switch(ne.current){case"connected":j.off(pe),N(null,D);break;case"failed":case"closed":case"suspended":j.off(pe),N(ne.reason||j.getStateError());break}};this.on("connectionstate",pe),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}},$.prototype.disconnectAllTransports=function(D){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(D?" except the active transport":"")),this.connectCounter++,d.safeArrForEach(this.pendingTransports,function(N){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+N),N&&N.disconnect()}),this.pendingTransports=[],d.safeArrForEach(this.proposedTransports,function(N){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+N),N&&N.dispose()}),this.proposedTransports=[],this.activeProtocol&&!D&&(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},$.prototype.send=function(D,N,j){j=j||S;var G=this.state;if(G.sendEvents){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new h.PendingMessage(D,j));return}var K=N&&G.queueEvents||G.forceQueueEvents;if(!K){var Z="rejecting event, queueEvent was "+N+", state was "+G.state;l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.send()",Z),j(this.errorReason||new x.default(Z,9e4,400));return}l.default.shouldLog(l.default.LOG_MICRO)&&l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+u.default.stringify(D)),this.queue(D,j)},$.prototype.sendImpl=function(D){var N=D.message;D.ackRequired&&!D.sendAttempted&&(N.msgSerial=this.msgSerial++);try{this.activeProtocol.send(D)}catch(j){l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+j.stack)}},$.prototype.queue=function(D,N){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var j=this.queuedMessages.last(),G=this.options.maxMessageSize;j&&!j.sendAttempted&&P(j.message,D,G)?(j.merged||(j.callback=R.default.create([j.callback]),j.merged=!0),j.callback.push(N)):this.queuedMessages.push(new h.PendingMessage(D,N))},$.prototype.sendQueuedMessages=function(){l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");for(var D;D=this.queuedMessages.shift();)this.sendImpl(D)},$.prototype.queuePendingMessages=function(D){D&&D.length&&(l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+D.length+" pending messages"),this.queuedMessages.prepend(D))},$.prototype.failQueuedMessages=function(D){var N=this.queuedMessages.count();N>0&&(l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+N+" queued messages, err = "+d.inspectError(D)),this.queuedMessages.completeAllMessages(D))},$.prototype.onChannelMessage=function(D,N){var j=this.activeProtocol&&N===this.activeProtocol.getTransport(),G=d.arrIn(this.pendingTransports,N)&&this.state==this.states.synchronizing;j||G?this.realtime.channels.onChannelMessage(D):d.arrIndexOf([g.ACK,g.NACK,g.ERROR],D.action)>-1?this.realtime.channels.onChannelMessage(D):l.default.logAction(l.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(D)+"on defunct transport; discarding")},$.prototype.ping=function(D,N){var j=this;if(D){l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+D);var G=function(){D.off("heartbeat",ee),N(new x.default("Timeout waiting for heartbeat response",5e4,500))},K=d.now(),Z=d.cheapRandStr(),ee=function(me){if(me===Z){D.off("heartbeat",ee),clearTimeout(ie);var Te=d.now()-K;N(null,Te)}},ie=setTimeout(G,this.options.timeouts.realtimeRequestTimeout);D.on("heartbeat",ee),D.ping(Z);return}if(this.state.state!=="connected"){N(new x.default("Unable to ping service; not connected",4e4,400));return}var ue=!1,pe=function(me,Te){j.off("transport.active",ne),ue||(ue=!0,N(me,Te))},ne=function(){ue||(ue=!0,C.default.Config.nextTick(function(){j.ping(null,N)}))};this.on("transport.active",ne),this.ping(this.activeProtocol.getTransport(),pe)},$.prototype.abort=function(D){this.activeProtocol.getTransport().fail(D)},$.prototype.registerProposedTransport=function(D){this.proposedTransports.push(D)},$.prototype.getTransportPreference=function(){var D,N;return this.transportPreference||s()&&((N=(D=C.default.WebStorage)===null||D===void 0?void 0:D.get)===null||N===void 0?void 0:N.call(D,L))},$.prototype.persistTransportPreference=function(D){var N,j;d.arrIn(m.default.upgradeTransports,D.shortName)&&(this.transportPreference=D.shortName,s()&&((j=(N=C.default.WebStorage)===null||N===void 0?void 0:N.set)===null||j===void 0||j.call(N,L,D.shortName)))},$.prototype.unpersistTransportPreference=function(){var D,N;this.transportPreference=null,s()&&((N=(D=C.default.WebStorage)===null||D===void 0?void 0:D.remove)===null||N===void 0||N.call(D,L))},$.prototype.actOnErrorFromAuthorize=function(D){if(D.code===40171)this.notifyState({state:"failed",error:D});else if(D.code===40102)this.notifyState({state:"failed",error:D});else if(D.statusCode===c.default.Forbidden){var N="Client configured authentication provider returned 403; failing the connection";l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",N),this.notifyState({state:"failed",error:new x.default(N,80019,403,D)})}else{var N="Client configured authentication provider request failed";l.default.logAction(l.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",N),this.notifyState({state:this.state.failState,error:new x.default(N,80019,401,D)})}},$.prototype.onConnectionDetailsUpdate=function(D,N){if(D){this.connectionDetails=D,D.maxMessageSize&&(this.options.maxMessageSize=D.maxMessageSize);var j=D.clientId;if(j){var G=this.realtime.auth._uncheckedSetClientId(j);if(G){l.default.logAction(l.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",G.message),N.fail(G);return}}var K=D.connectionStateTtl;K&&(this.connectionStateTtl=K),this.maxIdleInterval=D.maxIdleInterval,this.emit("connectiondetails",D)}},$.supportedTransports={},$}(w.default);n.default=z}).call(this,i(13))},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(7)),u=a.__importDefault(i(2)),d=function(h){a.__extends(m,h);function m(){var C=h.call(this)||this;return C.messages=[],C}return m.prototype.count=function(){return this.messages.length},m.prototype.push=function(C){this.messages.push(C)},m.prototype.shift=function(){return this.messages.shift()},m.prototype.last=function(){return this.messages[this.messages.length-1]},m.prototype.copyAll=function(){return this.messages.slice()},m.prototype.append=function(C){this.messages.push.apply(this.messages,C)},m.prototype.prepend=function(C){this.messages.unshift.apply(this.messages,C)},m.prototype.completeMessages=function(C,w,M){u.default.logAction(u.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+C+"; count = "+w),M=M||null;var l=this.messages;if(l.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var A=l[0];if(A){var T=A.message.msgSerial,x=C+w;if(x>T)for(var b=l.splice(0,x-T),y=0,R=b;y<R.length;y++){var p=R[y];p.callback(M)}l.length==0&&this.emit("idle")}},m.prototype.completeAllMessages=function(C){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,C)},m.prototype.resetSendAttempted=function(){for(var C=0,w=this.messages;C<w.length;C++){var M=w[C];M.sendAttempted=!1}},m.prototype.clear=function(){u.default.logAction(u.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},m}(o.default);n.default=d},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function o(u,d,h,m){this.previous=u,this.current=d,h&&(this.retryIn=h),m&&(this.reason=m)}return o}();n.default=a},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(10)),u=a.__importDefault(i(7)),d=a.__importStar(i(1)),h=a.__importDefault(i(33)),m=a.__importDefault(i(2)),C=a.__importDefault(i(54)),w=a.__importDefault(i(9)),M=a.__importDefault(i(39)),l=a.__importStar(i(4)),A=a.__importDefault(i(16)),T=a.__importDefault(i(21)),x=o.default.Action,b=function(){};function y(f){if(f&&"params"in f&&!d.isObject(f.params))return new l.default("options.params must be an object",4e4,400);if(f&&"modes"in f){if(!d.isArray(f.modes))return new l.default("options.modes must be an array",4e4,400);for(var c=0;c<f.modes.length;c++){var s=f.modes[c];if(!s||typeof s!="string"||!d.arrIn(o.default.channelModes,String.prototype.toUpperCase.call(s)))return new l.default("Invalid channel mode: "+s,4e4,400)}}}var R=function(f){a.__extends(c,f);function c(s,v,g){var S=f.call(this,s,v,g)||this;return S.retryCount=0,S.history=function(L,k){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),k===void 0)if(typeof L=="function")k=L,L=null;else{if(this.rest.options.promises)return d.promisify(this,"history",arguments);k=b}if(L&&L.untilAttach){if(this.state!=="attached"){k(new l.default("option untilAttach requires the channel to be attached",4e4,400));return}if(!this.properties.attachSerial){k(new l.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));return}delete L.untilAttach,L.from_serial=this.properties.attachSerial}h.default.prototype._history.call(this,L,k)},S.whenState=function(L,k){return u.default.prototype.whenState.call(S,L,S.state,k)},m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel()","started; name = "+v),S.realtime=s,S.presence=new C.default(S),S.connectionManager=s.connection.connectionManager,S.state="initialized",S.subscriptions=new u.default,S.syncChannelSerial=void 0,S.properties={attachSerial:void 0,channelSerial:void 0},S.setOptions(g),S.errorReason=null,S._requestedFlags=null,S._mode=null,S._attachResume=!1,S._decodingContext={channelOptions:S.channelOptions,plugins:s.options.plugins||{},baseEncodedPreviousPayload:void 0},S._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},S._allChannelChanges=new u.default,S}return c.prototype.invalidStateError=function(){return new l.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},c.processListenerArgs=function(s){return s=Array.prototype.slice.call(s),typeof s[0]=="function"&&s.unshift(null),s[s.length-1]==null&&s.pop(),s},c.prototype.setOptions=function(s,v){var g=this.channelOptions;if(!v&&this.rest.options.promises)return d.promisify(this,"setOptions",arguments);var S=v||function(k){k&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+k.toString())},L=y(s);if(L){S(L);return}h.default.prototype.setOptions.call(this,s),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(s,g)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],function(k){switch(this.event){case"update":case"attached":S==null||S(null);return;default:S==null||S(k.reason);return}})):S()},c.prototype._shouldReattachToSetOptions=function(s,v){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(s!=null&&s.params){var g=p(s.params),S=p(v.params);if(Object.keys(g).length!==Object.keys(S).length||!d.shallowEquals(S,g))return!0}return!!(s!=null&&s.modes&&(!v.modes||!d.arrEquals(s.modes,v.modes)))},c.prototype.publish=function(){for(var s=this,v=[],g=0;g<arguments.length;g++)v[g]=arguments[g];var S=v[0],L=v.length,k=v[L-1];if(typeof k!="function"){if(this.realtime.options.promises)return d.promisify(this,"publish",arguments);k=b,++L}if(!this.connectionManager.activeState()){k(this.connectionManager.getError());return}if(L==2)if(d.isObject(S))S=[w.default.fromValues(S)];else if(d.isArray(S))S=w.default.fromValuesArray(S);else throw new l.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else S=[w.default.fromValues({name:v[0],data:v[1]})];var _=this.realtime.options.maxMessageSize;w.default.encodeArray(S,this.channelOptions,function(I){if(I){k(I);return}var O=w.default.getMessagesSize(S);if(O>_){k(new l.default("Maximum size of messages that can be published at once exceeded ( was "+O+" bytes; limit is "+_+" bytes)",40009,400));return}s.__publish(S,k)})},c.prototype.__publish=function(s,v){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+s.length);var g=this.state;switch(g){case"failed":case"suspended":v(l.default.fromValues(this.invalidStateError()));break;default:{m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+g);var S=new o.default;S.action=x.MESSAGE,S.channel=this.name,S.messages=s,this.sendMessage(S,v);break}}},c.prototype.onEvent=function(s){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var v=this.subscriptions,g=0;g<s.length;g++){var S=s[g];v.emit(S.name,S)}},c.prototype.attach=function(s,v){var g;if(typeof s=="function"?(v=s,g=null):g=s,!v){if(this.realtime.options.promises)return d.promisify(this,"attach",arguments);v=function(S){S&&m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+S.toString())}}if(g)m.default.deprecated("The ability to pass an array of channel mode flags as the first argument of `RealtimeChannel.attach()`","To set channel mode flags, populate the `modes` property of the channel options object that you pass to `Channels.get()` or `RealtimeChannel.setOptions()`."),this._requestedFlags=g;else if(this.state==="attached"){v(null,null);return}this._attach(!1,null,v)},c.prototype._attach=function(s,v,g){g||(g=function(L){L&&m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+L.toString())});var S=this.connectionManager;if(!S.activeState()){g(S.getError());return}(this.state!=="attaching"||s)&&this.requestState("attaching",v),this.once(function(L){switch(this.event){case"attached":g==null||g(null,L);break;case"detached":case"suspended":case"failed":g==null||g(L.reason||S.getError()||new l.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":g==null||g(new l.default("Attach request superseded by a subsequent detach request",9e4,409));break}})},c.prototype.attachImpl=function(){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var s=o.default.fromValues({action:x.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?s.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&s.encodeModesToFlags(d.allToUpperCase(this.channelOptions.modes)),this._attachResume&&s.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(s.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(s,b)},c.prototype.detach=function(s){if(!s){if(this.realtime.options.promises)return d.promisify(this,"detach",arguments);s=b}var v=this.connectionManager;if(!v.activeState()){s(v.getError());return}switch(this.state){case"suspended":this.notifyState("detached"),s();break;case"detached":s();break;case"failed":s(new l.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once(function(g){switch(this.event){case"detached":s();break;case"attached":case"suspended":case"failed":s(g.reason||v.getError()||new l.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":s(new l.default("Detach request superseded by a subsequent attach request",9e4,409));break}})}},c.prototype.detachImpl=function(s){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var v=o.default.fromValues({action:x.DETACH,channel:this.name});this.sendMessage(v,s||b)},c.prototype.subscribe=function(){for(var s=[],v=0;v<arguments.length;v++)s[v]=arguments[v];var g=c.processListenerArgs(s),S=g[0],L=g[1],k=g[2];if(!k&&this.realtime.options.promises)return d.promisify(this,"subscribe",[S,L]);if(this.state==="failed"){k==null||k(l.default.fromValues(this.invalidStateError()));return}return S&&typeof S=="object"&&!Array.isArray(S)?this._subscribeFilter(S,L):this.subscriptions.on(S,L),this.attach(k||b)},c.prototype._subscribeFilter=function(s,v){var g=function(S){var L,k,_,I,O,E,P={name:S.name,refTimeserial:(k=(L=S.extras)===null||L===void 0?void 0:L.ref)===null||k===void 0?void 0:k.timeserial,refType:(I=(_=S.extras)===null||_===void 0?void 0:_.ref)===null||I===void 0?void 0:I.type,isRef:!!(!((E=(O=S.extras)===null||O===void 0?void 0:O.ref)===null||E===void 0)&&E.timeserial),clientId:S.clientId};Object.entries(s).find(function(F){var B=F[0],z=F[1];return z!==void 0?P[B]!==z:!1})||v(S)};this._addFilteredSubscription(s,v,g),this.subscriptions.on(g)},c.prototype._addFilteredSubscription=function(s,v,g){var S;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(v)){var L=this.filteredSubscriptions.get(v);L.set(s,((S=L==null?void 0:L.get(s))===null||S===void 0?void 0:S.concat(g))||[g])}else this.filteredSubscriptions.set(v,new Map([[s,[g]]]))},c.prototype._getAndDeleteFilteredSubscriptions=function(s,v){var g=this;if(!this.filteredSubscriptions)return[];if(!v&&s)return Array.from(this.filteredSubscriptions.entries()).map(function(_){var I,O=_[0],E=_[1],P=E.get(s);return E.delete(s),E.size===0&&((I=g.filteredSubscriptions)===null||I===void 0||I.delete(O)),P}).reduce(function(_,I){var O;return I?(O=_).concat.apply(O,I):_},[]);if(!v||!this.filteredSubscriptions.has(v))return[];var S=this.filteredSubscriptions.get(v);if(!s){var L=Array.from(S.values()).reduce(function(_,I){return _.concat.apply(_,I)},[]);return this.filteredSubscriptions.delete(v),L}var k=S.get(s);return S.delete(s),k||[]},c.prototype.unsubscribe=function(){for(var s=this,v,g=[],S=0;S<arguments.length;S++)g[S]=arguments[S];var L=c.processListenerArgs(g),k=L[0],_=L[1];if(typeof k=="object"&&!_||!((v=this.filteredSubscriptions)===null||v===void 0)&&v.has(_)){this._getAndDeleteFilteredSubscriptions(k,_).forEach(function(I){return s.subscriptions.off(I)});return}this.subscriptions.off(k,_)},c.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new l.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var s=this.connectionManager;if(!s.activeState())throw s.getError();var v=o.default.fromValues({action:x.SYNC,channel:this.name});this.syncChannelSerial&&(v.channelSerial=this.syncChannelSerial),s.send(v)},c.prototype.sendMessage=function(s,v){this.connectionManager.send(s,this.realtime.options.queueMessages,v)},c.prototype.sendPresence=function(s,v){var g=o.default.fromValues({action:x.PRESENCE,channel:this.name,presence:d.isArray(s)?A.default.fromValuesArray(s):[A.default.fromValues(s)]});this.sendMessage(g,v)},c.prototype.onMessage=function(s){(s.action===x.ATTACHED||s.action===x.MESSAGE||s.action===x.PRESENCE)&&this.setChannelSerial(s.channelSerial);var v,g=!1;switch(s.action){case x.ATTACHED:{this.properties.attachSerial=s.channelSerial,this._mode=s.getMode(),this.params=s.params||{};var S=s.decodeModesFromFlags();this.modes=S&&d.allToLowerCase(S)||void 0;var L=s.hasFlag("RESUMED"),k=s.hasFlag("HAS_PRESENCE"),_=s.hasFlag("HAS_BACKLOG");if(this.state==="attached"){L||this.presence.onAttached(k);var I=new M.default(this.state,this.state,L,_,s.error);this._allChannelChanges.emit("update",I),(!L||this.channelOptions.updateOnAttached)&&this.emit("update",I)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",s.error,L,k,_);break}case x.DETACHED:{var O=s.error?l.default.fromValues(s.error):new l.default("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",O):this.state==="attaching"?this.notifyState("suspended",O):this.requestState("attaching",O);break}case x.SYNC:if(g=!0,v=this.syncChannelSerial=s.channelSerial,!s.presence)break;case x.PRESENCE:{for(var E=s.presence,P=s.id,F=s.connectionId,B=s.timestamp,z=this.channelOptions,Y=void 0,$=0;$<E.length;$++)try{Y=E[$],A.default.decode(Y,z),Y.connectionId||(Y.connectionId=F),Y.timestamp||(Y.timestamp=B),Y.id||(Y.id=P+":"+$)}catch(Z){m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",Z.toString())}this.presence.setPresence(E,g,v);break}case x.MESSAGE:{if(this.state!=="attached"){m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+s.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}var D=s.messages,N=D[0],j=D[D.length-1],P=s.id,F=s.connectionId,B=s.timestamp;if(N.extras&&N.extras.delta&&N.extras.delta.from!==this._lastPayload.messageId){var G='Delta message decode failure - previous message not available for message "'+s.id+'" on this channel "'+this.name+'".';m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",G),this._startDecodeFailureRecovery(new l.default(G,40018,400));break}for(var $=0;$<D.length;$++){var G=D[$];try{w.default.decode(G,this._decodingContext)}catch(ne){switch(m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()",ne.toString()),ne.code){case 40018:this._startDecodeFailureRecovery(ne);return;case 40019:case 40021:this.notifyState("failed",ne);return}}G.connectionId||(G.connectionId=F),G.timestamp||(G.timestamp=B),G.id||(G.id=P+":"+$)}this._lastPayload.messageId=j.id,this._lastPayload.protocolMessageChannelSerial=s.channelSerial,this.onEvent(D);break}case x.ERROR:{var K=s.error;K&&K.code==80016?this.checkPendingState():this.notifyState("failed",l.default.fromValues(K));break}default:m.default.logAction(m.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+s.action+")"),this.connectionManager.abort(T.default.unknownChannelErr())}},c.prototype._startDecodeFailureRecovery=function(s){var v=this;this._lastPayload.decodeFailureRecoveryInProgress||(m.default.logAction(m.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,s,function(){v._lastPayload.decodeFailureRecoveryInProgress=!1}))},c.prototype.onAttached=function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},c.prototype.notifyState=function(s,v,g,S,L){if(m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+s),this.clearStateTimer(),d.arrIn(["detached","suspended","failed"],s)&&(this.properties.channelSerial=null),s!==this.state){this.presence.actOnChannelState(s,S,v),s==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),v&&(this.errorReason=v);var k=new M.default(this.state,s,g,L,v),_=s==="failed"?m.default.LOG_ERROR:m.default.LOG_MAJOR;m.default.logAction(_,'Channel state for channel "'+this.name+'"',s+(v?"; reason: "+v:"")),s!=="attaching"&&s!=="suspended"&&(this.retryCount=0),s==="attached"&&this.onAttached(),s==="attached"?this._attachResume=!0:(s==="detaching"||s==="failed")&&(this._attachResume=!1),this.state=s,this._allChannelChanges.emit(s,k),this.emit(s,k)}},c.prototype.requestState=function(s,v){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+s),this.notifyState(s,v),this.checkPendingState()},c.prototype.checkPendingState=function(){var s=this.connectionManager.state;if(!(s.sendEvents||s.forceQueueEvents)){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}},c.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":{var s=new l.default("Channel attach timed out",90007,408);this.notifyState("suspended",s);break}case"detaching":{var s=new l.default("Channel detach timed out",90007,408);this.notifyState("attached",s);break}default:this.checkPendingState();break}},c.prototype.startStateTimerIfNotRunning=function(){var s=this;this.stateTimer||(this.stateTimer=setTimeout(function(){m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),s.stateTimer=null,s.timeoutPendingState()},this.realtime.options.timeouts.realtimeRequestTimeout))},c.prototype.clearStateTimer=function(){var s=this.stateTimer;s&&(clearTimeout(s),this.stateTimer=null)},c.prototype.startRetryTimer=function(){var s=this;if(!this.retryTimer){this.retryCount++;var v=d.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(function(){s.state==="suspended"&&s.connectionManager.state.sendEvents&&(s.retryTimer=null,m.default.logAction(m.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),s.requestState("attaching"))},v)}},c.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},c.prototype.getReleaseErr=function(){var s=this.state;return s==="initialized"||s==="detached"||s==="failed"?null:new l.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+s,90001,400)},c.prototype.setChannelSerial=function(s){m.default.logAction(m.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+s+"; previous = "+this.properties.channelSerial),s&&(this.properties.channelSerial=s)},c}(h.default);function p(f){var c=f||{};c.agent;var s=a.__rest(c,["agent"]);return s}n.default=R},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function o(u,d,h,m,C){this.previous=u,this.current=d,d==="attached"&&(this.resumed=h,this.hasBacklog=m),C&&(this.reason=C)}return o}();n.default=a},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(){var o=a,u=o.lib,d=u.WordArray,h=u.Hasher,m=o.algo,C=[],w=m.SHA1=h.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,l){for(var A=this._hash.words,T=A[0],x=A[1],b=A[2],y=A[3],R=A[4],p=0;p<80;p++){if(p<16)C[p]=M[l+p]|0;else{var f=C[p-3]^C[p-8]^C[p-14]^C[p-16];C[p]=f<<1|f>>>31}var c=(T<<5|T>>>27)+R+C[p];p<20?c+=(x&b|~x&y)+1518500249:p<40?c+=(x^b^y)+1859775393:p<60?c+=(x&b|x&y|b&y)-1894007588:c+=(x^b^y)-899497514,R=y,y=b,b=x<<30|x>>>2,x=T,T=c}A[0]=A[0]+T|0,A[1]=A[1]+x|0,A[2]=A[2]+b|0,A[3]=A[3]+y|0,A[4]=A[4]+R|0},_doFinalize:function(){var M=this._data,l=M.words,A=this._nDataBytes*8,T=M.sigBytes*8;return l[T>>>5]|=128<<24-T%32,l[(T+64>>>9<<4)+14]=Math.floor(A/4294967296),l[(T+64>>>9<<4)+15]=A,M.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var M=h.clone.call(this);return M._hash=this._hash.clone(),M}});o.SHA1=h._createHelper(w),o.HmacSHA1=h._createHmacHelper(w)}(),a.SHA1})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});function a(p){if(p===void 0)return"undefined";var f,c;if(p instanceof ArrayBuffer?(c="ArrayBuffer",f=new DataView(p)):p instanceof DataView&&(c="DataView",f=p),!f)return JSON.stringify(p);for(var s=[],v=0;v<p.byteLength;v++){if(v>20){s.push("...");break}var g=f.getUint8(v).toString(16);g.length===1&&(g="0"+g),s.push(g)}return"<"+c+" "+s.join(" ")+">"}function o(p,f,c){for(var s=0,v=c.length;s<v;s++){var g=c.charCodeAt(s);if(g<128){p.setUint8(f++,g>>>0&127|0);continue}if(g<2048){p.setUint8(f++,g>>>6&31|192),p.setUint8(f++,g>>>0&63|128);continue}if(g<65536){p.setUint8(f++,g>>>12&15|224),p.setUint8(f++,g>>>6&63|128),p.setUint8(f++,g>>>0&63|128);continue}if(g<1114112){p.setUint8(f++,g>>>18&7|240),p.setUint8(f++,g>>>12&63|128),p.setUint8(f++,g>>>6&63|128),p.setUint8(f++,g>>>0&63|128);continue}throw new Error("bad codepoint "+g)}}function u(p,f,c){for(var s="",v=f,g=f+c;v<g;v++){var S=p.getUint8(v);if(!(S&128)){s+=String.fromCharCode(S);continue}if((S&224)===192){s+=String.fromCharCode((S&15)<<6|p.getUint8(++v)&63);continue}if((S&240)===224){s+=String.fromCharCode((S&15)<<12|(p.getUint8(++v)&63)<<6|(p.getUint8(++v)&63)<<0);continue}if((S&248)===240){s+=String.fromCharCode((S&7)<<18|(p.getUint8(++v)&63)<<12|(p.getUint8(++v)&63)<<6|(p.getUint8(++v)&63)<<0);continue}throw new Error("Invalid byte "+S.toString(16))}return s}function d(p){for(var f=0,c=0,s=p.length;c<s;c++){var v=p.charCodeAt(c);if(v<128){f+=1;continue}if(v<2048){f+=2;continue}if(v<65536){f+=3;continue}if(v<1114112){f+=4;continue}throw new Error("bad codepoint "+v)}return f}function h(p,f){var c=R(p,f);if(c!==0){var s=new ArrayBuffer(c),v=new DataView(s);return y(p,v,0,f),s}}var m=65536*65536,C=1/m;function w(p,f){return f=f||0,p.getInt32(f)*m+p.getUint32(f+4)}function M(p,f){return f=f||0,p.getUint32(f)*m+p.getUint32(f+4)}function l(p,f,c){c<9223372036854776e3?(p.setInt32(f,Math.floor(c*C)),p.setInt32(f+4,c&-1)):(p.setUint32(f,2147483647),p.setUint32(f+4,2147483647))}function A(p,f,c){c<18446744073709552e3?(p.setUint32(f,Math.floor(c*C)),p.setInt32(f+4,c&-1)):(p.setUint32(f,4294967295),p.setUint32(f+4,4294967295))}var T=function(){function p(f,c){var s=this;this.map=function(v){for(var g={},S=0;S<v;S++){var L=s.parse();g[L]=s.parse()}return g},this.bin=function(v){var g=new ArrayBuffer(v);return new Uint8Array(g).set(new Uint8Array(s.view.buffer,s.offset,v),0),s.offset+=v,g},this.buf=this.bin,this.str=function(v){var g=u(s.view,s.offset,v);return s.offset+=v,g},this.array=function(v){for(var g=new Array(v),S=0;S<v;S++)g[S]=s.parse();return g},this.ext=function(v){return s.offset+=v,{type:s.view.getInt8(s.offset),data:s.buf(v)}},this.parse=function(){var v=s.view.getUint8(s.offset),g,S;if(!(v&128))return s.offset++,v;if((v&240)===128)return S=v&15,s.offset++,s.map(S);if((v&240)===144)return S=v&15,s.offset++,s.array(S);if((v&224)===160)return S=v&31,s.offset++,s.str(S);if((v&224)===224)return g=s.view.getInt8(s.offset),s.offset++,g;switch(v){case 192:return s.offset++,null;case 193:s.offset++;return;case 194:return s.offset++,!1;case 195:return s.offset++,!0;case 196:return S=s.view.getUint8(s.offset+1),s.offset+=2,s.bin(S);case 197:return S=s.view.getUint16(s.offset+1),s.offset+=3,s.bin(S);case 198:return S=s.view.getUint32(s.offset+1),s.offset+=5,s.bin(S);case 199:return S=s.view.getUint8(s.offset+1),s.offset+=2,s.ext(S);case 200:return S=s.view.getUint16(s.offset+1),s.offset+=3,s.ext(S);case 201:return S=s.view.getUint32(s.offset+1),s.offset+=5,s.ext(S);case 202:return g=s.view.getFloat32(s.offset+1),s.offset+=5,g;case 203:return g=s.view.getFloat64(s.offset+1),s.offset+=9,g;case 204:return g=s.view.getUint8(s.offset+1),s.offset+=2,g;case 205:return g=s.view.getUint16(s.offset+1),s.offset+=3,g;case 206:return g=s.view.getUint32(s.offset+1),s.offset+=5,g;case 207:return g=M(s.view,s.offset+1),s.offset+=9,g;case 208:return g=s.view.getInt8(s.offset+1),s.offset+=2,g;case 209:return g=s.view.getInt16(s.offset+1),s.offset+=3,g;case 210:return g=s.view.getInt32(s.offset+1),s.offset+=5,g;case 211:return g=w(s.view,s.offset+1),s.offset+=9,g;case 212:return S=1,s.offset++,s.ext(S);case 213:return S=2,s.offset++,s.ext(S);case 214:return S=4,s.offset++,s.ext(S);case 215:return S=8,s.offset++,s.ext(S);case 216:return S=16,s.offset++,s.ext(S);case 217:return S=s.view.getUint8(s.offset+1),s.offset+=2,s.str(S);case 218:return S=s.view.getUint16(s.offset+1),s.offset+=3,s.str(S);case 219:return S=s.view.getUint32(s.offset+1),s.offset+=5,s.str(S);case 220:return S=s.view.getUint16(s.offset+1),s.offset+=3,s.array(S);case 221:return S=s.view.getUint32(s.offset+1),s.offset+=5,s.array(S);case 222:return S=s.view.getUint16(s.offset+1),s.offset+=3,s.map(S);case 223:return S=s.view.getUint32(s.offset+1),s.offset+=5,s.map(S)}throw new Error("Unknown type 0x"+v.toString(16))},this.offset=c||0,this.view=f}return p}();function x(p){var f=new DataView(p),c=new T(f),s=c.parse();if(c.offset!==p.byteLength)throw new Error(p.byteLength-c.offset+" trailing bytes");return s}function b(p,f){return Object.keys(p).filter(function(c){var s=p[c],v=typeof s;return(!f||s!=null)&&(v!=="function"||!!s.toJSON)})}function y(p,f,c,s){var v=typeof p;if(typeof p=="string"){var g=d(p);if(g<32)return f.setUint8(c,g|160),o(f,c+1,p),1+g;if(g<256)return f.setUint8(c,217),f.setUint8(c+1,g),o(f,c+2,p),2+g;if(g<65536)return f.setUint8(c,218),f.setUint16(c+1,g),o(f,c+3,p),3+g;if(g<4294967296)return f.setUint8(c,219),f.setUint32(c+1,g),o(f,c+5,p),5+g}if(ArrayBuffer.isView&&ArrayBuffer.isView(p)&&(p=p.buffer),p instanceof ArrayBuffer){var S=p.byteLength;if(S<256)return f.setUint8(c,196),f.setUint8(c+1,S),new Uint8Array(f.buffer).set(new Uint8Array(p),c+2),2+S;if(S<65536)return f.setUint8(c,197),f.setUint16(c+1,S),new Uint8Array(f.buffer).set(new Uint8Array(p),c+3),3+S;if(S<4294967296)return f.setUint8(c,198),f.setUint32(c+1,S),new Uint8Array(f.buffer).set(new Uint8Array(p),c+5),5+S}if(typeof p=="number"){if(Math.floor(p)!==p)return f.setUint8(c,203),f.setFloat64(c+1,p),9;if(p>=0){if(p<128)return f.setUint8(c,p),1;if(p<256)return f.setUint8(c,204),f.setUint8(c+1,p),2;if(p<65536)return f.setUint8(c,205),f.setUint16(c+1,p),3;if(p<4294967296)return f.setUint8(c,206),f.setUint32(c+1,p),5;if(p<18446744073709552e3)return f.setUint8(c,207),A(f,c+1,p),9;throw new Error("Number too big 0x"+p.toString(16))}if(p>=-32)return f.setInt8(c,p),1;if(p>=-128)return f.setUint8(c,208),f.setInt8(c+1,p),2;if(p>=-32768)return f.setUint8(c,209),f.setInt16(c+1,p),3;if(p>=-2147483648)return f.setUint8(c,210),f.setInt32(c+1,p),5;if(p>=-9223372036854776e3)return f.setUint8(c,211),l(f,c+1,p),9;throw new Error("Number too small -0x"+(-p).toString(16).substr(1))}if(v==="undefined")return s?0:(f.setUint8(c,212),f.setUint8(c+1,0),f.setUint8(c+2,0),3);if(p===null)return s?0:(f.setUint8(c,192),1);if(v==="boolean")return f.setUint8(c,p?195:194),1;if(typeof p.toJSON=="function")return y(p.toJSON(),f,c,s);if(v==="object"){var L,k=0,_=void 0,I=Array.isArray(p);if(I?L=p.length:(_=b(p,s),L=_.length),L<16?(f.setUint8(c,L|(I?144:128)),k=1):L<65536?(f.setUint8(c,I?220:222),f.setUint16(c+1,L),k=3):L<4294967296&&(f.setUint8(c,I?221:223),f.setUint32(c+1,L),k=5),I)for(var O=0;O<L;O++)k+=y(p[O],f,c+k,s);else if(_)for(var O=0;O<L;O++){var E=_[O];k+=y(E,f,c+k),k+=y(p[E],f,c+k,s)}return k}if(v==="function")return 0;throw new Error("Unknown type "+v)}function R(p,f){var c=typeof p;if(c==="string"){var s=d(p);if(s<32)return 1+s;if(s<256)return 2+s;if(s<65536)return 3+s;if(s<4294967296)return 5+s}if(ArrayBuffer.isView&&ArrayBuffer.isView(p)&&(p=p.buffer),p instanceof ArrayBuffer){var v=p.byteLength;if(v<256)return 2+v;if(v<65536)return 3+v;if(v<4294967296)return 5+v}if(typeof p=="number"){if(Math.floor(p)!==p)return 9;if(p>=0){if(p<128)return 1;if(p<256)return 2;if(p<65536)return 3;if(p<4294967296)return 5;if(p<18446744073709552e3)return 9;throw new Error("Number too big 0x"+p.toString(16))}if(p>=-32)return 1;if(p>=-128)return 2;if(p>=-32768)return 3;if(p>=-2147483648)return 5;if(p>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+p.toString(16).substr(1))}if(c==="boolean")return 1;if(p===null)return f?0:1;if(p===void 0)return f?0:3;if(typeof p.toJSON=="function")return R(p.toJSON(),f);if(c==="object"){var g,S=0;if(Array.isArray(p)){g=p.length;for(var L=0;L<g;L++)S+=R(p[L],f)}else{var k=b(p,f);g=k.length;for(var L=0;L<g;L++){var _=k[L];S+=R(_)+R(p[_],f)}}if(g<16)return 1+S;if(g<65536)return 3+S;if(g<4294967296)return 5+S;throw new Error("Array or object too long 0x"+g.toString(16))}if(c==="function")return 0;throw new Error("Unknown type "+c)}n.default={encode:h,decode:x,inspect:a,utf8Write:o,utf8Read:u,utf8ByteCount:d}},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(30)),u=a.__importDefault(i(50)),d=a.__importDefault(i(3)),h=a.__importDefault(i(4)),m=a.__importDefault(i(55)),C=a.__importDefault(i(57)),w=a.__importDefault(i(62)),M=a.__importDefault(i(64)),l=a.__importDefault(i(68)),A=a.__importDefault(i(2)),T=i(8),x=a.__importDefault(i(65)),b=a.__importDefault(i(66)),y=a.__importDefault(i(41)),R=(0,C.default)(M.default,m.default);d.default.Crypto=R,d.default.BufferUtils=m.default,d.default.Http=w.default,d.default.Config=M.default,d.default.Transports=l.default,d.default.WebStorage=x.default,o.default.Crypto=R,u.default.Crypto=R,A.default.initLogHandlers(),d.default.Defaults=(0,T.getDefaults)(b.default),d.default.Config.agent&&(d.default.Defaults.agent+=" "+d.default.Config.agent),d.default.Config.noUpgrade&&(d.default.Defaults.upgradeTransports=[]),n.default={ErrorInfo:h.default,Rest:o.default,Realtime:u.default,msgpack:y.default}},function(e){e.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.50","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@arethetypeswrong/cli":"^0.13.1","@babel/preset-env":"^7.23.6","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","babel-loader":"^8.3.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","mocha-junit-reporter":"^2.2.1","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0","webpack-node-externals":"^3.0.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(e,n){},function(e,n,i){(function(a,o){e.exports=o(i(6),i(32),i(25))})(this,function(a){return a.HmacSHA256})},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(47)),d=a.__importDefault(i(15)),h=a.__importDefault(i(20)),m=a.__importDefault(i(4)),C=a.__importDefault(i(48)),w=function(){},M=function(){function x(b){this.rest=b,this.admin=new l(b)}return x}(),l=function(){function x(b){this.rest=b,this.deviceRegistrations=new A(b),this.channelSubscriptions=new T(b)}return x.prototype.publish=function(b,y,R){var p=this.rest,f=p.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,c=o.defaultPostHeaders(p.options,f),s={},v=o.mixin({recipient:b},y);if(typeof R!="function"){if(this.rest.options.promises)return o.promisify(this,"publish",arguments);R=w}p.options.headers&&o.mixin(c,p.options.headers),p.options.pushFullWait&&o.mixin(s,{fullWait:"true"});var g=o.encodeBody(v,f);d.default.post(p,"/push/publish",g,c,s,null,function(S){return R(S)})},x}(),A=function(){function x(b){this.rest=b}return x.prototype.save=function(b,y){var R=this.rest,p=u.default.fromValues(b),f=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,c=o.defaultPostHeaders(R.options,f),s={};if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"save",arguments);y=w}R.options.headers&&o.mixin(c,R.options.headers),R.options.pushFullWait&&o.mixin(s,{fullWait:"true"});var v=o.encodeBody(p,f);d.default.put(R,"/push/deviceRegistrations/"+encodeURIComponent(b.id),v,c,s,null,function(g,S,L,k){y(g,g?void 0:u.default.fromResponseBody(S,k?void 0:f))})},x.prototype.get=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=o.defaultGetHeaders(R.options,p),c=b.id||b;if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"get",arguments);y=w}if(typeof c!="string"||!c.length){y(new m.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400));return}R.options.headers&&o.mixin(f,R.options.headers),d.default.get(R,"/push/deviceRegistrations/"+encodeURIComponent(c),f,{},null,function(s,v,g,S){y(s,s?void 0:u.default.fromResponseBody(v,S?void 0:p))})},x.prototype.list=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=this.rest.http.supportsLinkHeaders?void 0:p,c=o.defaultGetHeaders(R.options,p);if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"list",arguments);y=w}R.options.headers&&o.mixin(c,R.options.headers),new h.default(R,"/push/deviceRegistrations",c,f,function(s,v,g){return u.default.fromResponseBody(s,g?void 0:p)}).get(b,y)},x.prototype.remove=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=o.defaultGetHeaders(R.options,p),c={},s=b.id||b;if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"remove",arguments);y=w}if(typeof s!="string"||!s.length){y(new m.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400));return}R.options.headers&&o.mixin(f,R.options.headers),R.options.pushFullWait&&o.mixin(c,{fullWait:"true"}),d.default.delete(R,"/push/deviceRegistrations/"+encodeURIComponent(s),f,c,null,function(v){return y(v)})},x.prototype.removeWhere=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=o.defaultGetHeaders(R.options,p);if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);y=w}R.options.headers&&o.mixin(f,R.options.headers),R.options.pushFullWait&&o.mixin(b,{fullWait:"true"}),d.default.delete(R,"/push/deviceRegistrations",f,b,null,function(c){return y(c)})},x}(),T=function(){function x(b){this.remove=x.prototype.removeWhere,this.rest=b}return x.prototype.save=function(b,y){var R=this.rest,p=C.default.fromValues(b),f=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,c=o.defaultPostHeaders(R.options,f),s={};if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"save",arguments);y=w}R.options.headers&&o.mixin(c,R.options.headers),R.options.pushFullWait&&o.mixin(s,{fullWait:"true"});var v=o.encodeBody(p,f);d.default.post(R,"/push/channelSubscriptions",v,c,s,null,function(g,S,L,k){y(g,!g&&C.default.fromResponseBody(S,k?void 0:f))})},x.prototype.list=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=this.rest.http.supportsLinkHeaders?void 0:p,c=o.defaultGetHeaders(R.options,p);if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"list",arguments);y=w}R.options.headers&&o.mixin(c,R.options.headers),new h.default(R,"/push/channelSubscriptions",c,f,function(s,v,g){return C.default.fromResponseBody(s,g?void 0:p)}).get(b,y)},x.prototype.removeWhere=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=o.defaultGetHeaders(R.options,p);if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);y=w}R.options.headers&&o.mixin(f,R.options.headers),R.options.pushFullWait&&o.mixin(b,{fullWait:"true"}),d.default.delete(R,"/push/channelSubscriptions",f,b,null,function(c){return y(c)})},x.prototype.listChannels=function(b,y){var R=this.rest,p=R.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,f=this.rest.http.supportsLinkHeaders?void 0:p,c=o.defaultGetHeaders(R.options,p);if(typeof y!="function"){if(this.rest.options.promises)return o.promisify(this,"listChannels",arguments);y=w}R.options.headers&&o.mixin(c,R.options.headers),R.options.pushFullWait&&o.mixin(b,{fullWait:"true"}),new h.default(R,"/push/channels",c,f,function(s,v,g){for(var S=!g&&p?o.decodeBody(s,p):s,L=0;L<S.length;L++)S[L]=String(S[L]);return S}).get(b,y)},x}();n.default=M},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(4)),d;(function(C){C.Phone="phone",C.Tablet="tablet",C.Desktop="desktop",C.TV="tv",C.Watch="watch",C.Car="car",C.Embedded="embedded",C.Other="other"})(d||(d={}));var h;(function(C){C.Android="android",C.IOS="ios",C.Browser="browser"})(h||(h={}));var m=function(){function C(){}return C.prototype.toJSON=function(){var w,M,l;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(w=this.push)===null||w===void 0?void 0:w.recipient,state:(M=this.push)===null||M===void 0?void 0:M.state,error:(l=this.push)===null||l===void 0?void 0:l.error}}},C.prototype.toString=function(){var w,M,l,A,T="[DeviceDetails";return this.id&&(T+="; id="+this.id),this.platform&&(T+="; platform="+this.platform),this.formFactor&&(T+="; formFactor="+this.formFactor),this.clientId&&(T+="; clientId="+this.clientId),this.metadata&&(T+="; metadata="+this.metadata),this.deviceIdentityToken&&(T+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),!((w=this.push)===null||w===void 0)&&w.recipient&&(T+="; push.recipient="+JSON.stringify(this.push.recipient)),!((M=this.push)===null||M===void 0)&&M.state&&(T+="; push.state="+this.push.state),!((l=this.push)===null||l===void 0)&&l.error&&(T+="; push.error="+JSON.stringify(this.push.error)),!((A=this.push)===null||A===void 0)&&A.metadata&&(T+="; push.metadata="+this.push.metadata),T+="]",T},C.fromResponseBody=function(w,M){return M&&(w=o.decodeBody(w,M)),o.isArray(w)?C.fromValuesArray(w):C.fromValues(w)},C.fromValues=function(w){return w.error=w.error&&u.default.fromValues(w.error),Object.assign(new C,w)},C.fromValuesArray=function(w){for(var M=w.length,l=new Array(M),A=0;A<M;A++)l[A]=C.fromValues(w[A]);return l},C.toRequestBody=o.encodeBody,C}();n.default=m},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=function(){function d(){}return d.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},d.prototype.toString=function(){var h="[PushChannelSubscription";return this.channel&&(h+="; channel="+this.channel),this.deviceId&&(h+="; deviceId="+this.deviceId),this.clientId&&(h+="; clientId="+this.clientId),h+="]",h},d.fromResponseBody=function(h,m){return m&&(h=o.decodeBody(h,m)),o.isArray(h)?d.fromValuesArray(h):d.fromValues(h)},d.fromValues=function(h){return Object.assign(new d,h)},d.fromValuesArray=function(h){for(var m=h.length,C=new Array(m),w=0;w<m;w++)C[w]=d.fromValues(h[w]);return C},d.toRequestBody=o.encodeBody,d}();n.default=u},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=function(){function R(p){this.count=p&&p.count||0,this.data=p&&p.data||0,this.uncompressedData=p&&p.uncompressedData||0,this.failed=p&&p.failed||0,this.refused=p&&p.refused||0}return R}(),d=function(R){a.__extends(p,R);function p(f){var c=R.call(this,f)||this;return f&&f.category&&(c.category={},o.forInOwnNonNullProperties(f.category,function(s){c.category[s]=new u(f.category[s])})),c}return p}(u),h=function(){function R(p){this.peak=p&&p.peak||0,this.min=p&&p.min||0,this.mean=p&&p.mean||0,this.opened=p&&p.opened||0,this.refused=p&&p.refused||0}return R}(),m=function(){function R(p){this.succeeded=p&&p.succeeded||0,this.failed=p&&p.failed||0,this.refused=p&&p.refused||0}return R}(),C=function(){function R(p){this.plain=new h(p&&p.plain),this.tls=new h(p&&p.tls),this.all=new h(p&&p.all)}return R}(),w=function(){function R(p){this.messages=new d(p&&p.messages),this.presence=new d(p&&p.presence),this.all=new d(p&&p.all)}return R}(),M=function(){function R(p){this.realtime=new w(p&&p.realtime),this.rest=new w(p&&p.rest),this.webhook=new w(p&&p.webhook),this.sharedQueue=new w(p&&p.sharedQueue),this.externalQueue=new w(p&&p.externalQueue),this.httpEvent=new w(p&&p.httpEvent),this.push=new w(p&&p.push),this.all=new w(p&&p.all)}return R}(),l=function(){function R(p){this.all=new w(p&&p.all),this.inbound=new M(p&&p.inbound),this.outbound=new M(p&&p.outbound)}return R}(),A=function(){function R(p){this.all=new w(p&&p.all),this.producerPaid=new l(p&&p.producerPaid),this.consumerPaid=new l(p&&p.consumerPaid)}return R}(),T=function(){function R(p){this.messages=p&&p.messages||0;var f=p&&p.notifications;this.notifications={invalid:f&&f.invalid||0,attempted:f&&f.attempted||0,successful:f&&f.successful||0,failed:f&&f.failed||0},this.directPublishes=p&&p.directPublishes||0}return R}(),x=function(){function R(p){this.succeeded=p&&p.succeeded||0,this.skipped=p&&p.skipped||0,this.failed=p&&p.failed||0}return R}(),b=function(){function R(p){var f=this;this.delta=void 0,p&&p.delta&&(this.delta={},o.forInOwnNonNullProperties(p.delta,function(c){f.delta[c]=new x(p.delta[c])}))}return R}(),y=function(R){a.__extends(p,R);function p(f){var c=R.call(this,f)||this;return c.persisted=new w(f&&f.persisted),c.connections=new C(f&&f.connections),c.channels=new h(f&&f.channels),c.apiRequests=new m(f&&f.apiRequests),c.tokenRequests=new m(f&&f.tokenRequests),c.xchgProducer=new A(f&&f.xchgProducer),c.xchgConsumer=new A(f&&f.xchgConsumer),c.push=new T(f&&f.pushStats),c.processed=new b(f&&f.processed),c.inProgress=f&&f.inProgress||void 0,c.unit=f&&f.unit||void 0,c.intervalId=f&&f.intervalId||void 0,c}return p.fromValues=function(f){return new p(f)},p}(l);n.default=y},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(30)),d=a.__importDefault(i(7)),h=a.__importDefault(i(2)),m=a.__importDefault(i(51)),C=a.__importDefault(i(38)),w=a.__importDefault(i(8)),M=a.__importDefault(i(4)),l=a.__importDefault(i(10)),A=a.__importDefault(i(35)),T=a.__importDefault(i(3)),x=a.__importDefault(i(9)),b=function(R){a.__extends(p,R);function p(f){var c=R.call(this,f)||this;return h.default.logAction(h.default.LOG_MINOR,"Realtime()",""),c.connection=new m.default(c,c.options),c.channels=new y(c),f.autoConnect!==!1&&c.connect(),c}return p.prototype.connect=function(){h.default.logAction(h.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},p.prototype.close=function(){h.default.logAction(h.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},p.Promise=function(f){return f=w.default.objectifyOptions(f),f.promises=!0,new p(f)},p.Callbacks=p,p.Utils=o,p.ConnectionManager=A.default,p.Platform=T.default,p.ProtocolMessage=l.default,p.Message=x.default,p}(u.default),y=function(R){a.__extends(p,R);function p(f){var c=R.call(this)||this;return c.realtime=f,c.all=Object.create(null),f.connection.connectionManager.on("transport.active",function(){c.onTransportActive()}),c}return p.prototype.channelSerials=function(){for(var f={},c=0,s=o.keysArray(this.all,!0);c<s.length;c++){var v=s[c],g=this.all[v];g.properties.channelSerial&&(f[v]=g.properties.channelSerial)}return f},p.prototype.recoverChannels=function(f){for(var c=0,s=o.keysArray(f,!0);c<s.length;c++){var v=s[c],g=this.get(v);g.properties.channelSerial=f[v]}},p.prototype.onChannelMessage=function(f){var c=f.channel;if(c===void 0){h.default.logAction(h.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+f.action);return}var s=this.all[c];if(!s){h.default.logAction(h.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+c);return}s.onMessage(f)},p.prototype.onTransportActive=function(){for(var f in this.all){var c=this.all[f];c.state==="attaching"||c.state==="detaching"?c.checkPendingState():c.state==="suspended"?c._attach(!1,null):c.state==="attached"&&c.requestState("attaching")}},p.prototype.propogateConnectionInterruption=function(f,c){var s={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},v=["attaching","attached","detaching","suspended"],g=s[f];for(var S in this.all){var L=this.all[S];o.arrIn(v,L.state)&&L.notifyState(g,c)}},p.prototype.get=function(f,c){f=String(f);var s=this.all[f];if(!s)s=this.all[f]=new C.default(this.realtime,f,c);else if(c){if(s._shouldReattachToSetOptions(c,s.channelOptions))throw new M.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);s.setOptions(c)}return s},p.prototype.getDerived=function(f,c,s){if(c.filter){var v=o.toBase64(c.filter),g=o.matchDerivedChannel(f);f="[filter=".concat(v).concat(g.qualifierParam,"]").concat(g.channelName)}return this.get(f,s)},p.prototype.release=function(f){f=String(f);var c=this.all[f];if(c){var s=c.getReleaseErr();if(s)throw s;delete this.all[f]}},p}(d.default);n.default=b},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(7)),d=a.__importDefault(i(35)),h=a.__importDefault(i(2)),m=a.__importDefault(i(37)),C=a.__importDefault(i(3));function w(){}var M=function(l){a.__extends(A,l);function A(T,x){var b=l.call(this)||this;return b.whenState=function(y,R){return u.default.prototype.whenState.call(b,y,b.state,R,new m.default(void 0,y))},b.ably=T,b.connectionManager=new d.default(T,x),b.state=b.connectionManager.state.state,b.key=void 0,b.id=void 0,b.errorReason=null,b.connectionManager.on("connectionstate",function(y){var R=b.state=y.current;C.default.Config.nextTick(function(){b.emit(R,y)})}),b.connectionManager.on("update",function(y){C.default.Config.nextTick(function(){b.emit("update",y)})}),b}return A.prototype.connect=function(){h.default.logAction(h.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},A.prototype.ping=function(T){if(h.default.logAction(h.default.LOG_MINOR,"Connection.ping()",""),!T){if(this.ably.options.promises)return o.promisify(this,"ping",arguments);T=w}this.connectionManager.ping(null,T)},A.prototype.close=function(){h.default.logAction(h.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(A.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),A.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},A}(u.default);n.default=M},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PendingMessage=void 0;var a=i(0),o=a.__importDefault(i(10)),u=a.__importStar(i(1)),d=a.__importDefault(i(7)),h=a.__importDefault(i(2)),m=a.__importDefault(i(36)),C=a.__importDefault(i(4)),w=o.default.Action,M=function(){function A(T,x){this.message=T,this.callback=x,this.merged=!1;var b=T.action;this.sendAttempted=!1,this.ackRequired=b==w.MESSAGE||b==w.PRESENCE}return A}();n.PendingMessage=M;var l=function(A){a.__extends(T,A);function T(x){var b=A.call(this)||this;return b.transport=x,b.messageQueue=new m.default,x.on("ack",function(y,R){b.onAck(y,R)}),x.on("nack",function(y,R,p){b.onNack(y,R,p)}),b}return T.prototype.onAck=function(x,b){h.default.logAction(h.default.LOG_MICRO,"Protocol.onAck()","serial = "+x+"; count = "+b),this.messageQueue.completeMessages(x,b)},T.prototype.onNack=function(x,b,y){h.default.logAction(h.default.LOG_ERROR,"Protocol.onNack()","serial = "+x+"; count = "+b+"; err = "+u.inspectError(y)),y||(y=new C.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(x,b,y)},T.prototype.onceIdle=function(x){var b=this.messageQueue;if(b.count()===0){x();return}b.once("idle",x)},T.prototype.send=function(x){x.ackRequired&&this.messageQueue.push(x),h.default.shouldLog(h.default.LOG_MICRO)&&h.default.logAction(h.default.LOG_MICRO,"Protocol.send()","sending msg; "+o.default.stringify(x.message)),x.sendAttempted=!0,this.transport.send(x.message)},T.prototype.getTransport=function(){return this.transport},T.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},T.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},T.prototype.finish=function(){var x=this.transport;this.onceIdle(function(){x.disconnect()})},T}(d.default);n.default=l},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(3)),u=a.__importStar(i(1)),d=a.__importDefault(i(26)),h=a.__importDefault(i(8)),m=a.__importDefault(i(2)),C=a.__importDefault(i(10)),w=a.__importDefault(i(4)),M="web_socket";function l(x){return!!x.on}var A=function(x){a.__extends(b,x);function b(y,R,p){var f=x.call(this,y,R,p)||this;return f.shortName=M,p.heartbeats=o.default.Config.useProtocolHeartbeats,f.wsHost=h.default.getHost(p.options,p.host,!0),f}return b.isAvailable=function(){return!!o.default.Config.WebSocket},b.prototype.createWebSocket=function(y,R){return this.uri=y+u.toQueryString(R),new o.default.Config.WebSocket(this.uri)},b.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},b.prototype.connect=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),d.default.prototype.connect.call(this);var y=this,R=this.params,p=R.options,f=p.tls?"wss://":"ws://",c=f+this.wsHost+":"+h.default.getPort(p)+"/";m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+c),this.auth.getAuthParams(function(s,v){if(!y.isDisposed){var g="";for(var S in v)g+=" "+S+": "+v[S]+";";if(m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+g+" err: "+s),s){y.disconnect(s);return}var L=R.getConnectParams(v);try{var k=y.wsConnection=y.createWebSocket(c,L);k.binaryType=o.default.Config.binaryType,k.onopen=function(){y.onWsOpen()},k.onclose=function(_){y.onWsClose(_)},k.onmessage=function(_){y.onWsData(_.data)},k.onerror=function(_){y.onWsError(_)},l(k)&&k.on("ping",function(){y.onActivity()})}catch(_){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(_.stack||_.message)),y.disconnect(_)}}})},b.prototype.send=function(y){var R=this.wsConnection;if(!R){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{R.send(C.default.serialize(y,this.params.format))}catch(f){var p="Exception from ws connection when trying to send: "+u.inspectError(f);m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.send()",p),this.finish("disconnected",new w.default(p,5e4,500))}},b.prototype.onWsData=function(y){m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+y.length+"; type = "+typeof y);try{this.onProtocolMessage(C.default.deserialize(y,this.format))}catch(R){m.default.logAction(m.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+R.stack)}},b.prototype.onWsOpen=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},b.prototype.onWsClose=function(y){var R,p;if(typeof y=="object"?(p=y.code,R=y.wasClean||p===1e3):(p=y,R=p==1e3),delete this.wsConnection,R){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var f=new w.default("Websocket closed",80003,400);this.finish("disconnected",f)}else{var c="Unclean disconnection of WebSocket ; code = "+p,f=new w.default(c,80003,400);m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onWsClose()",c),this.finish("disconnected",f)}this.emit("disposed")},b.prototype.onWsError=function(y){var R=this;m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+y.message),o.default.Config.nextTick(function(){R.disconnect(Error(y.message))})},b.prototype.dispose=function(){m.default.logAction(m.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var y=this.wsConnection;y&&(y.onmessage=function(){},delete this.wsConnection,o.default.Config.nextTick(function(){if(m.default.logAction(m.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!y)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");y.close()}))},b}(d.default);function T(x){return A.isAvailable()&&(x.supportedTransports[M]=A),A}n.default=T},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(1)),u=a.__importDefault(i(34)),d=a.__importDefault(i(7)),h=a.__importDefault(i(2)),m=a.__importDefault(i(16)),C=a.__importStar(i(4)),w=a.__importDefault(i(38)),M=a.__importDefault(i(24)),l=a.__importDefault(i(39)),A=function(){};function T(f){return f.channel.realtime.auth.clientId}function x(f){var c=f.channel.realtime,s=c.auth.clientId;return(!s||s==="*")&&c.connection.state==="connected"}function b(f,c,s){switch(f.state){case"attached":case"suspended":s();break;case"initialized":case"detached":case"detaching":case"attaching":f.attach(function(v){v?c(v):s()});break;default:c(C.default.fromValues(f.invalidStateError()))}}function y(f,c){if(f.isSynthesized()||c.isSynthesized())return f.timestamp>=c.timestamp;var s=f.parseId(),v=c.parseId();return s.msgSerial===v.msgSerial?s.index>v.index:s.msgSerial>v.msgSerial}var R=function(f){a.__extends(c,f);function c(s){var v=f.call(this,s)||this;return v.channel=s,v.syncComplete=!1,v.members=new p(v,function(g){return g.clientId+":"+g.connectionId}),v._myMembers=new p(v,function(g){return g.clientId}),v.subscriptions=new d.default,v.pendingPresence=[],v}return c.prototype.enter=function(s,v){if(x(this))throw new C.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,s,"enter",v)},c.prototype.update=function(s,v){if(x(this))throw new C.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,s,"update",v)},c.prototype.enterClient=function(s,v,g){return this._enterOrUpdateClient(void 0,s,v,"enter",g)},c.prototype.updateClient=function(s,v,g){return this._enterOrUpdateClient(void 0,s,v,"update",g)},c.prototype._enterOrUpdateClient=function(s,v,g,S,L){var k=this;if(!L)if(typeof g=="function")L=g,g=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"_enterOrUpdateClient",[s,v,g,S]);L=A}var _=this.channel;if(!_.connectionManager.activeState()){L(_.connectionManager.getError());return}h.default.logAction(h.default.LOG_MICRO,"RealtimePresence."+S+"Client()","channel = "+_.name+", id = "+s+", client = "+(v||"(implicit) "+T(this)));var I=m.default.fromData(g);I.action=S,s&&(I.id=s),v&&(I.clientId=v),m.default.encode(I,_.channelOptions,function(O){if(O){L(O);return}switch(_.state){case"attached":_.sendPresence(I,L);break;case"initialized":case"detached":_.attach();case"attaching":k.pendingPresence.push({presence:I,callback:L});break;default:O=new C.PartialErrorInfo("Unable to "+S+" presence channel while in "+_.state+" state",90001),O.code=90001,L(O)}})},c.prototype.leave=function(s,v){if(x(this))throw new C.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,s,v)},c.prototype.leaveClient=function(s,v,g){if(!g)if(typeof v=="function")g=v,v=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"leaveClient",[s,v]);g=A}var S=this.channel;if(!S.connectionManager.activeState()){g==null||g(S.connectionManager.getError());return}h.default.logAction(h.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+s);var L=m.default.fromData(v);switch(L.action="leave",s&&(L.clientId=s),S.state){case"attached":S.sendPresence(L,g);break;case"attaching":this.pendingPresence.push({presence:L,callback:g});break;case"initialized":case"failed":{var k=new C.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);g==null||g(k);break}default:g==null||g(S.invalidStateError())}},c.prototype.get=function(s,v){var g=this,S=Array.prototype.slice.call(arguments);S.length==1&&typeof S[0]=="function"&&S.unshift(null),s=S[0],v=S[1];var L=!s||("waitForSync"in s?s.waitForSync:!0);if(!v){if(this.channel.realtime.options.promises)return o.promisify(this,"get",S);v=A}function k(_){v(null,s?_.list(s):_.values())}if(this.channel.state==="suspended"){L?v(C.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):k(this.members);return}b(this.channel,v,function(){var _=g.members;L?_.waitSync(function(){k(_)}):k(_)})},c.prototype.history=function(s,v){if(h.default.logAction(h.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),v===void 0)if(typeof s=="function")v=s,s=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"history",arguments);v=A}s&&s.untilAttach&&(this.channel.state==="attached"?(delete s.untilAttach,s.from_serial=this.channel.properties.attachSerial):v(new C.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),u.default.prototype._history.call(this,s,v)},c.prototype.setPresence=function(s,v,g){h.default.logAction(h.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+s.length+" participants; syncChannelSerial = "+g);var S,L,k=this.members,_=this._myMembers,I=[],O=this.channel.connectionManager.connectionId;v&&(this.members.startSync(),g&&(L=g.match(/^[\w-]+:(.*)$/))&&(S=L[1]));for(var E=0;E<s.length;E++){var P=m.default.fromValues(s[E]);switch(P.action){case"leave":k.remove(P)&&I.push(P),P.connectionId===O&&!P.isSynthesized()&&_.remove(P);break;case"enter":case"present":case"update":k.put(P)&&I.push(P),P.connectionId===O&&_.put(P);break}}v&&!S&&(k.endSync(),this.channel.syncChannelSerial=null);for(var E=0;E<I.length;E++){var P=I[E];this.subscriptions.emit(P.action,P)}},c.prototype.onAttached=function(s){h.default.logAction(h.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+s),s?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var v=this.pendingPresence,g=v.length;if(g){this.pendingPresence=[];var S=[],L=M.default.create();h.default.logAction(h.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+g+" queued presence messages");for(var k=0;k<g;k++){var _=v[k];S.push(_.presence),L.push(_.callback)}this.channel.sendPresence(S,L)}},c.prototype.actOnChannelState=function(s,v,g){switch(s){case"attached":this.onAttached(v);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(g);break}},c.prototype.failPendingPresence=function(s){if(this.pendingPresence.length){h.default.logAction(h.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+o.inspectError(s));for(var v=0;v<this.pendingPresence.length;v++)try{this.pendingPresence[v].callback(s)}catch{}this.pendingPresence=[]}},c.prototype._clearMyMembers=function(){this._myMembers.clear()},c.prototype._ensureMyMembersPresent=function(){var s=this,v=this._myMembers,g=function(k){if(k){var _="Presence auto-re-enter failed: "+k.toString(),I=new C.default(_,91004,400);h.default.logAction(h.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",_);var O=new l.default(s.channel.state,s.channel.state,!0,!1,I);s.channel.emit("update",O)}};for(var S in v.map){var L=v.map[S];h.default.logAction(h.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+L.clientId+'" into the presence set'),this._enterOrUpdateClient(L.id,L.clientId,L.data,"enter",g)}},c.prototype._synthesizeLeaves=function(s){var v=this.subscriptions;o.arrForEach(s,function(g){var S=m.default.fromValues({action:"leave",connectionId:g.connectionId,clientId:g.clientId,data:g.data,encoding:g.encoding,timestamp:o.now()});v.emit("leave",S)})},c.prototype.on=function(){for(var s=[],v=0;v<arguments.length;v++)s[v]=arguments[v];h.default.renamedMethod("RealtimePresence","on","subscribe"),this.subscribe.apply(this,s)},c.prototype.off=function(){for(var s=[],v=0;v<arguments.length;v++)s[v]=arguments[v];h.default.renamedMethod("RealtimePresence","off","unsubscribe"),this.unsubscribe.apply(this,s)},c.prototype.subscribe=function(){for(var s=[],v=0;v<arguments.length;v++)s[v]=arguments[v];var g=w.default.processListenerArgs(s),S=g[0],L=g[1],k=g[2],_=this.channel;if(!k){if(this.channel.realtime.options.promises)return o.promisify(this,"subscribe",[S,L]);k=A}if(_.state==="failed"){k(C.default.fromValues(_.invalidStateError()));return}this.subscriptions.on(S,L),_.attach(k)},c.prototype.unsubscribe=function(){for(var s=[],v=0;v<arguments.length;v++)s[v]=arguments[v];var g=w.default.processListenerArgs(s),S=g[0],L=g[1];this.subscriptions.off(S,L)},c}(u.default),p=function(f){a.__extends(c,f);function c(s,v){var g=f.call(this)||this;return g.presence=s,g.map=Object.create(null),g.syncInProgress=!1,g.residualMembers=null,g.memberKey=v,g}return c.prototype.get=function(s){return this.map[s]},c.prototype.getClient=function(s){var v=this.map,g=[];for(var S in v){var L=v[S];L.clientId==s&&L.action!="absent"&&g.push(L)}return g},c.prototype.list=function(s){var v=this.map,g=s&&s.clientId,S=s&&s.connectionId,L=[];for(var k in v){var _=v[k];_.action!=="absent"&&(g&&g!=_.clientId||S&&S!=_.connectionId||L.push(_))}return L},c.prototype.put=function(s){(s.action==="enter"||s.action==="update")&&(s=m.default.fromValues(s),s.action="present");var v=this.map,g=this.memberKey(s);this.residualMembers&&delete this.residualMembers[g];var S=v[g];return S&&!y(s,S)?!1:(v[g]=s,!0)},c.prototype.values=function(){var s=this.map,v=[];for(var g in s){var S=s[g];S.action!="absent"&&v.push(S)}return v},c.prototype.remove=function(s){var v=this.map,g=this.memberKey(s),S=v[g];return S&&!y(s,S)?!1:(this.syncInProgress?(s=m.default.fromValues(s),s.action="absent",v[g]=s):delete v[g],!0)},c.prototype.startSync=function(){var s=this.map,v=this.syncInProgress;h.default.logAction(h.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+v),this.syncInProgress||(this.residualMembers=o.copy(s),this.setInProgress(!0))},c.prototype.endSync=function(){var s=this.map,v=this.syncInProgress;if(h.default.logAction(h.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+v),v){for(var g in s){var S=s[g];S.action==="absent"&&delete s[g]}this.presence._synthesizeLeaves(o.valuesArray(this.residualMembers));for(var g in this.residualMembers)delete s[g];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},c.prototype.waitSync=function(s){var v=this.syncInProgress;if(h.default.logAction(h.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+v),!v){s();return}this.once("sync",s)},c.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},c.prototype.setInProgress=function(s){h.default.logAction(h.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+s),this.syncInProgress=s,this.presence.syncComplete=!s},c}(d.default);n.default=R},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=i(56),u=i(31),d=i(11),h=a.__importDefault(i(5)),m=a.__importDefault(i(3)),C=function(){function w(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return w.prototype.isWordArray=function(M){return M!=null&&M.sigBytes!==void 0},w.prototype.isArrayBuffer=function(M){return M!=null&&M.constructor===ArrayBuffer},w.prototype.isTypedArray=function(M){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(M)},w.prototype.uint8ViewToBase64=function(M){for(var l="",A=this.base64CharSet,T=M.byteLength,x=T%3,b=T-x,y,R,p,f,c,s=0;s<b;s=s+3)c=M[s]<<16|M[s+1]<<8|M[s+2],y=(c&16515072)>>18,R=(c&258048)>>12,p=(c&4032)>>6,f=c&63,l+=A[y]+A[R]+A[p]+A[f];return x==1?(c=M[b],y=(c&252)>>2,R=(c&3)<<4,l+=A[y]+A[R]+"=="):x==2&&(c=M[b]<<8|M[b+1],y=(c&64512)>>10,R=(c&1008)>>4,p=(c&15)<<2,l+=A[y]+A[R]+A[p]+"="),l},w.prototype.base64ToArrayBuffer=function(M){for(var l=atob==null?void 0:atob(M),A=l.length,T=new Uint8Array(A),x=0;x<A;x++){var b=l.charCodeAt(x);T[x]=b}return T.buffer},w.prototype.isBuffer=function(M){return this.isArrayBuffer(M)||this.isWordArray(M)||this.isTypedArray(M)},w.prototype.toBuffer=function(M){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(M))return new Uint8Array(M);if(this.isTypedArray(M))return new Uint8Array(M.buffer);if(this.isWordArray(M)){for(var l=new ArrayBuffer(M.sigBytes),A=new Uint8Array(l),T=0;T<M.sigBytes;T++)A[T]=M.words[T>>>2]>>>24-T%4*8&255;return A}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},w.prototype.toArrayBuffer=function(M){return this.isArrayBuffer(M)?M:this.toBuffer(M).buffer},w.prototype.toWordArray=function(M){return this.isTypedArray(M)&&(M=M.buffer),this.isWordArray(M)?M:h.default.create(M)},w.prototype.base64Encode=function(M){return this.isWordArray(M)?(0,d.stringify)(M):this.uint8ViewToBase64(this.toBuffer(M))},w.prototype.base64Decode=function(M){return ArrayBuffer&&m.default.Config.atob?this.base64ToArrayBuffer(M):(0,d.parse)(M)},w.prototype.hexEncode=function(M){return(0,o.stringify)(this.toWordArray(M))},w.prototype.hexDecode=function(M){var l=(0,o.parse)(M);return ArrayBuffer?this.toArrayBuffer(l):l},w.prototype.utf8Encode=function(M){return m.default.Config.TextEncoder?new m.default.Config.TextEncoder().encode(M).buffer:(0,u.parse)(M)},w.prototype.utf8Decode=function(M){if(!this.isBuffer(M))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(M)?new TextDecoder().decode(M):(M=this.toWordArray(M),(0,u.stringify)(M))},w.prototype.bufferCompare=function(M,l){if(!M)return-1;if(!l)return 1;var A=this.toWordArray(M),T=this.toWordArray(l);A.clamp(),T.clamp();var x=A.sigBytes-T.sigBytes;if(x!=0)return x;for(var b=A.words,y=T.words,R=0;R<b.length;R++)if(x=b[R]-y[R],x!=0)return x;return 0},w.prototype.byteLength=function(M){return this.isArrayBuffer(M)||this.isTypedArray(M)?M.byteLength:this.isWordArray(M)?M.sigBytes:-1},w.prototype.typedArrayToBuffer=function(M){return M.buffer},w}();n.default=new C},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return a.enc.Hex})},function(e,n,i){i.r(n);var a=i(5),o=i.n(a),u=i(11),d=i(23),h=i.n(d),m=i(2),C=i.n(m),w=i(4),M=i.n(w),l=function(A,T){var x="aes",b=256,y="cbc",R=16,p=4,f=4294967296,c=2147483648,s;if(A.getRandomWordArray)s=A.getRandomWordArray;else if(typeof Uint32Array<"u"&&A.getRandomValues){var v=new Uint32Array(p);s=function(E,P){var F=E/4,B=F==p?v:new Uint32Array(F);A.getRandomValues(B,function(z){typeof P<"u"&&P(z,T.toWordArray(B))})}}else s=function(E,P){C.a.logAction(C.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var F=E/4,B=new Array(F),z=0;z<F;z++)B[z]=Math.floor(Math.random()*f)-c;P(null,o.a.create(B))};function g(E){return E+R&-R}function S(E){if(E.algorithm==="aes"&&E.mode==="cbc"){if(E.keyLength===128||E.keyLength===256)return;throw new Error("Unsupported key length "+E.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function L(E){return E.replace("_","/").replace("-","+")}var k=[o.a.create([269488144,269488144,269488144,269488144],16),o.a.create([16777216],1),o.a.create([33685504],2),o.a.create([50529024],3),o.a.create([67372036],4),o.a.create([84215045,83886080],5),o.a.create([101058054,101056512],6),o.a.create([117901063,117901056],7),o.a.create([134744072,134744072],8),o.a.create([151587081,151587081,150994944],9),o.a.create([168430090,168430090,168427520],10),o.a.create([185273099,185273099,185273088],11),o.a.create([202116108,202116108,202116108],12),o.a.create([218959117,218959117,218959117,218103808],13),o.a.create([235802126,235802126,235802126,235798528],14),o.a.create([252645135,252645135,252645135,252645135],15),o.a.create([269488144,269488144,269488144,269488144],16)];function _(){}function I(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}_.CipherParams=I,_.getDefaultParams=function(E){var P;if(typeof E=="function"||typeof E=="string"){if(C.a.deprecated("The ability to pass a callback to `Crypto.getDefaultParams()`","This method now directly returns its result, instead of returning it asynchronously via a callback. Please update your code so that it uses the return value of this method instead of passing a callback."),typeof E=="function")C.a.deprecated("The ability to call `Crypto.getDefaultParams()` without specifying an encryption key","Please update your code so that it instead passes an object whose `key` property contains an encryption key. That is, replace `Crypto.getDefaultParams()` with `Crypto.getDefaultParams({ key })`, where `key` is an encryption key that you have generated (for example from the `Crypto.generateRandomKey()` method)."),_.generateRandomKey(function(B){E(null,_.getDefaultParams({key:B}))});else if(typeof arguments[1]=="function")C.a.deprecated("The ability to pass the encryption key as the first argument of `Crypto.getDefaultParams()`","Please update your code so that it instead passes an object whose `key` property contains the key. That is, replace `Crypto.getDefaultParams(key)` with `Crypto.getDefaultParams({ key })`."),arguments[1](null,_.getDefaultParams({key:E}));else throw new Error("Invalid arguments for Crypto.getDefaultParams");return}if(!E.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof E.key=="string"?P=Object(u.parse)(L(E.key)):P=T.toWordArray(E.key);var F=new I;if(F.key=P,F.algorithm=E.algorithm||x,F.keyLength=P.words.length*(4*8),F.mode=E.mode||y,E.keyLength&&E.keyLength!==F.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+E.keyLength+" was specified, but the key actually has length "+F.keyLength);return S(F),F},_.generateRandomKey=function(E,P){arguments.length==1&&typeof E=="function"&&(P=E,E=void 0),s((E||b)/8,function(F,B){P!==void 0&&P(F?M.a.fromValues(F):null,B)})},_.getCipher=function(E){var P=E instanceof I?E:_.getDefaultParams(E);return{cipherParams:P,cipher:new O(P,p,E.iv)}};function O(E,P,F){this.algorithm=E.algorithm+"-"+String(E.keyLength)+"-"+E.mode,this.cjsAlgorithm=E.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=T.toWordArray(E.key),F&&(this.iv=T.toWordArray(F).clone()),this.blockLengthWords=P}return O.prototype.encrypt=function(E,P){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.encrypt()",""),E=T.toWordArray(E);var F=E.sigBytes,B=g(F),z=this,Y=function(){z.getIv(function($,D){if($){P($);return}var N=z.encryptCipher.process(E.concat(k[B-F])),j=D.concat(N);P(null,j)})};this.encryptCipher?Y():this.iv?(this.encryptCipher=h.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),Y()):s(R,function($,D){if($){P($);return}z.encryptCipher=h.a.algo[z.cjsAlgorithm].createEncryptor(z.key,{iv:D}),z.iv=D,Y()})},O.prototype.decrypt=function(E){C.a.logAction(C.a.LOG_MICRO,"CBCCipher.decrypt()",""),E=T.toWordArray(E);var P=this.blockLengthWords,F=E.words,B=o.a.create(F.slice(0,P)),z=o.a.create(F.slice(P)),Y=h.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:B}),$=Y.process(z),D=Y.finalize();return Y.reset(),D&&D.sigBytes&&$.concat(D),$},O.prototype.getIv=function(E){if(this.iv){var P=this.iv;this.iv=null,E(null,P);return}var F=this;s(R,function(B,z){if(B){E(B);return}E(null,F.encryptCipher.process(z))})},_};n.default=l},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(){var o=a,u=o.lib,d=u.WordArray,h=o.enc;h.Utf16=h.Utf16BE={stringify:function(C){for(var w=C.words,M=C.sigBytes,l=[],A=0;A<M;A+=2){var T=w[A>>>2]>>>16-A%4*8&65535;l.push(String.fromCharCode(T))}return l.join("")},parse:function(C){for(var w=C.length,M=[],l=0;l<w;l++)M[l>>>1]|=C.charCodeAt(l)<<16-l%2*16;return d.create(M,w*2)}},h.Utf16LE={stringify:function(C){for(var w=C.words,M=C.sigBytes,l=[],A=0;A<M;A+=2){var T=m(w[A>>>2]>>>16-A%4*8&65535);l.push(String.fromCharCode(T))}return l.join("")},parse:function(C){for(var w=C.length,M=[],l=0;l<w;l++)M[l>>>1]|=m(C.charCodeAt(l)<<16-l%2*16);return d.create(M,w*2)}};function m(C){return C<<8&4278255360|C>>>8&16711935}}(),a.enc.Utf16})},function(e,n,i){(function(a,o){e.exports=o(i(6),i(28))})(this,function(a){return function(o){var u=a,d=u.lib,h=d.CipherParams,m=u.enc,C=m.Hex,w=u.format;w.Hex={stringify:function(M){return M.ciphertext.toString(C)},parse:function(M){var l=C.parse(M);return h.create({ciphertext:l})}}}(),a.format.Hex})},function(e,n,i){(function(a,o){e.exports=o(i(6),i(11),i(61),i(27),i(28))})(this,function(a){return function(){var o=a,u=o.lib,d=u.BlockCipher,h=o.algo,m=[],C=[],w=[],M=[],l=[],A=[],T=[],x=[],b=[],y=[];(function(){for(var f=[],c=0;c<256;c++)c<128?f[c]=c<<1:f[c]=c<<1^283;for(var s=0,v=0,c=0;c<256;c++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^g&255^99,m[s]=g,C[g]=s;var S=f[s],L=f[S],k=f[L],_=f[g]*257^g*16843008;w[s]=_<<24|_>>>8,M[s]=_<<16|_>>>16,l[s]=_<<8|_>>>24,A[s]=_;var _=k*16843009^L*65537^S*257^s*16843008;T[g]=_<<24|_>>>8,x[g]=_<<16|_>>>16,b[g]=_<<8|_>>>24,y[g]=_,s?(s=S^f[f[f[k^S]]],v^=f[f[v]]):s=v=1}})();var R=[0,1,2,4,8,16,32,64,128,27,54],p=h.AES=d.extend({_doReset:function(){var f;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var c=this._keyPriorReset=this._key,s=c.words,v=c.sigBytes/4,g=this._nRounds=v+6,S=(g+1)*4,L=this._keySchedule=[],k=0;k<S;k++)k<v?L[k]=s[k]:(f=L[k-1],k%v?v>6&&k%v==4&&(f=m[f>>>24]<<24|m[f>>>16&255]<<16|m[f>>>8&255]<<8|m[f&255]):(f=f<<8|f>>>24,f=m[f>>>24]<<24|m[f>>>16&255]<<16|m[f>>>8&255]<<8|m[f&255],f^=R[k/v|0]<<24),L[k]=L[k-v]^f);for(var _=this._invKeySchedule=[],I=0;I<S;I++){var k=S-I;if(I%4)var f=L[k];else var f=L[k-4];I<4||k<=4?_[I]=f:_[I]=T[m[f>>>24]]^x[m[f>>>16&255]]^b[m[f>>>8&255]]^y[m[f&255]]}}},encryptBlock:function(f,c){this._doCryptBlock(f,c,this._keySchedule,w,M,l,A,m)},decryptBlock:function(f,c){var s=f[c+1];f[c+1]=f[c+3],f[c+3]=s,this._doCryptBlock(f,c,this._invKeySchedule,T,x,b,y,C);var s=f[c+1];f[c+1]=f[c+3],f[c+3]=s},_doCryptBlock:function(f,c,s,v,g,S,L,k){for(var _=this._nRounds,I=f[c]^s[0],O=f[c+1]^s[1],E=f[c+2]^s[2],P=f[c+3]^s[3],F=4,B=1;B<_;B++){var z=v[I>>>24]^g[O>>>16&255]^S[E>>>8&255]^L[P&255]^s[F++],Y=v[O>>>24]^g[E>>>16&255]^S[P>>>8&255]^L[I&255]^s[F++],$=v[E>>>24]^g[P>>>16&255]^S[I>>>8&255]^L[O&255]^s[F++],D=v[P>>>24]^g[I>>>16&255]^S[O>>>8&255]^L[E&255]^s[F++];I=z,O=Y,E=$,P=D}var z=(k[I>>>24]<<24|k[O>>>16&255]<<16|k[E>>>8&255]<<8|k[P&255])^s[F++],Y=(k[O>>>24]<<24|k[E>>>16&255]<<16|k[P>>>8&255]<<8|k[I&255])^s[F++],$=(k[E>>>24]<<24|k[P>>>16&255]<<16|k[I>>>8&255]<<8|k[O&255])^s[F++],D=(k[P>>>24]<<24|k[I>>>16&255]<<16|k[O>>>8&255]<<8|k[E&255])^s[F++];f[c]=z,f[c+1]=Y,f[c+2]=$,f[c+3]=D},keySize:256/32});o.AES=d._createHelper(p)}(),a.AES})},function(e,n,i){(function(a,o){e.exports=o(i(6))})(this,function(a){return function(o){var u=a,d=u.lib,h=d.WordArray,m=d.Hasher,C=u.algo,w=[];(function(){for(var b=0;b<64;b++)w[b]=o.abs(o.sin(b+1))*4294967296|0})();var M=C.MD5=m.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(b,y){for(var R=0;R<16;R++){var p=y+R,f=b[p];b[p]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var c=this._hash.words,s=b[y+0],v=b[y+1],g=b[y+2],S=b[y+3],L=b[y+4],k=b[y+5],_=b[y+6],I=b[y+7],O=b[y+8],E=b[y+9],P=b[y+10],F=b[y+11],B=b[y+12],z=b[y+13],Y=b[y+14],$=b[y+15],D=c[0],N=c[1],j=c[2],G=c[3];D=l(D,N,j,G,s,7,w[0]),G=l(G,D,N,j,v,12,w[1]),j=l(j,G,D,N,g,17,w[2]),N=l(N,j,G,D,S,22,w[3]),D=l(D,N,j,G,L,7,w[4]),G=l(G,D,N,j,k,12,w[5]),j=l(j,G,D,N,_,17,w[6]),N=l(N,j,G,D,I,22,w[7]),D=l(D,N,j,G,O,7,w[8]),G=l(G,D,N,j,E,12,w[9]),j=l(j,G,D,N,P,17,w[10]),N=l(N,j,G,D,F,22,w[11]),D=l(D,N,j,G,B,7,w[12]),G=l(G,D,N,j,z,12,w[13]),j=l(j,G,D,N,Y,17,w[14]),N=l(N,j,G,D,$,22,w[15]),D=A(D,N,j,G,v,5,w[16]),G=A(G,D,N,j,_,9,w[17]),j=A(j,G,D,N,F,14,w[18]),N=A(N,j,G,D,s,20,w[19]),D=A(D,N,j,G,k,5,w[20]),G=A(G,D,N,j,P,9,w[21]),j=A(j,G,D,N,$,14,w[22]),N=A(N,j,G,D,L,20,w[23]),D=A(D,N,j,G,E,5,w[24]),G=A(G,D,N,j,Y,9,w[25]),j=A(j,G,D,N,S,14,w[26]),N=A(N,j,G,D,O,20,w[27]),D=A(D,N,j,G,z,5,w[28]),G=A(G,D,N,j,g,9,w[29]),j=A(j,G,D,N,I,14,w[30]),N=A(N,j,G,D,B,20,w[31]),D=T(D,N,j,G,k,4,w[32]),G=T(G,D,N,j,O,11,w[33]),j=T(j,G,D,N,F,16,w[34]),N=T(N,j,G,D,Y,23,w[35]),D=T(D,N,j,G,v,4,w[36]),G=T(G,D,N,j,L,11,w[37]),j=T(j,G,D,N,I,16,w[38]),N=T(N,j,G,D,P,23,w[39]),D=T(D,N,j,G,z,4,w[40]),G=T(G,D,N,j,s,11,w[41]),j=T(j,G,D,N,S,16,w[42]),N=T(N,j,G,D,_,23,w[43]),D=T(D,N,j,G,E,4,w[44]),G=T(G,D,N,j,B,11,w[45]),j=T(j,G,D,N,$,16,w[46]),N=T(N,j,G,D,g,23,w[47]),D=x(D,N,j,G,s,6,w[48]),G=x(G,D,N,j,I,10,w[49]),j=x(j,G,D,N,Y,15,w[50]),N=x(N,j,G,D,k,21,w[51]),D=x(D,N,j,G,B,6,w[52]),G=x(G,D,N,j,S,10,w[53]),j=x(j,G,D,N,P,15,w[54]),N=x(N,j,G,D,v,21,w[55]),D=x(D,N,j,G,O,6,w[56]),G=x(G,D,N,j,$,10,w[57]),j=x(j,G,D,N,_,15,w[58]),N=x(N,j,G,D,z,21,w[59]),D=x(D,N,j,G,L,6,w[60]),G=x(G,D,N,j,F,10,w[61]),j=x(j,G,D,N,g,15,w[62]),N=x(N,j,G,D,E,21,w[63]),c[0]=c[0]+D|0,c[1]=c[1]+N|0,c[2]=c[2]+j|0,c[3]=c[3]+G|0},_doFinalize:function(){var b=this._data,y=b.words,R=this._nDataBytes*8,p=b.sigBytes*8;y[p>>>5]|=128<<24-p%32;var f=o.floor(R/4294967296),c=R;y[(p+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,y[(p+64>>>9<<4)+14]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,b.sigBytes=(y.length+1)*4,this._process();for(var s=this._hash,v=s.words,g=0;g<4;g++){var S=v[g];v[g]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return s},clone:function(){var b=m.clone.call(this);return b._hash=this._hash.clone(),b}});function l(b,y,R,p,f,c,s){var v=b+(y&R|~y&p)+f+s;return(v<<c|v>>>32-c)+y}function A(b,y,R,p,f,c,s){var v=b+(y&p|R&~p)+f+s;return(v<<c|v>>>32-c)+y}function T(b,y,R,p,f,c,s){var v=b+(y^R^p)+f+s;return(v<<c|v>>>32-c)+y}function x(b,y,R,p,f,c,s){var v=b+(R^(y|~p))+f+s;return(v<<c|v>>>32-c)+y}u.MD5=m._createHelper(M),u.HmacMD5=m._createHmacHelper(M)}(Math),a.MD5})},function(e,n,i){var a;Object.defineProperty(n,"__esModule",{value:!0});var o=i(0),u=o.__importDefault(i(3)),d=o.__importStar(i(1)),h=o.__importDefault(i(8)),m=i(4),C=o.__importDefault(i(19)),w=o.__importDefault(i(17)),M=o.__importDefault(i(22)),l=o.__importDefault(i(2)),A=i(29),T=o.__importDefault(i(63)),x=i(14);function b(p){var f=p.statusCode;return f===408&&!p.code||f===400&&!p.code||f>=500&&f<=504}function y(p){var f=p.connection,c=f&&f.connectionManager.host;return c?[c].concat(h.default.getFallbackHosts(p.options)):h.default.getHosts(p.options)}var R=(a=function(){function p(f){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=y,this.options=f||{};var c=this.options.connectivityCheckUrl||h.default.connectivityCheckUrl,s=this.options.connectivityCheckParams,v=!this.options.connectivityCheckUrl;u.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(g,S,L,k,_,I,O){var E=w.default.createRequest(L,k,_,I,M.default.REQ_SEND,S&&S.options.timeouts,g);return E.once("complete",O),E.exec(),E},this.options.disableConnectivityCheck?this.checkConnectivity=function(g){g(null,!0)}:this.checkConnectivity=function(g){l.default.logAction(l.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+c),this.doUri(C.default.Get,null,c,null,null,s,function(S,L,k,_,I){var O=!1;v?O=!S&&(L==null?void 0:L.replace(/\n/,""))=="yes":O=!S&&(0,x.isSuccessCode)(I),l.default.logAction(l.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+O),g(null,O)})}):u.default.Config.jsonpSupported?(this.Request=function(g,S,L,k,_,I,O){var E=(0,A.createRequest)(L,k,_,I,M.default.REQ_SEND,S&&S.options.timeouts,g);return E.once("complete",O),u.default.Config.nextTick(function(){E.exec()}),E},this.options.disableConnectivityCheck?this.checkConnectivity=function(g){g(null,!0)}:this.checkConnectivity=function(g){var S=this,L=h.default.jsonpInternetUpUrl;if(this.checksInProgress){this.checksInProgress.push(g);return}this.checksInProgress=[g],l.default.logAction(l.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+L);var k=new A.Request("isTheInternetUp",L,null,null,null,M.default.REQ_SEND,h.default.TIMEOUTS);k.once("complete",function(_,I){var O=!_&&I;l.default.logAction(l.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+O);for(var E=0;E<S.checksInProgress.length;E++)S.checksInProgress[E](null,O);S.checksInProgress=null}),u.default.Config.nextTick(function(){k.exec()})}):u.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=T.default,this.checkConnectivity=function(g){l.default.logAction(l.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+c),this.doUri(C.default.Get,null,c,null,null,null,function(S,L){var k=!S&&(L==null?void 0:L.replace(/\n/,""))=="yes";l.default.logAction(l.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+k),g(null,k)})}):this.Request=function(g,S,L,k,_,I,O){O(new m.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return p.prototype.do=function(f,c,s,v,g,S,L){var k=this,_=typeof s=="function"?s:function(P){return c.baseUri(P)+s},I=c._currentFallback;if(I)if(I.validUntil>d.now()){if(!this.Request){L==null||L(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(f,c,_(I.host),v,S,g,function(P){for(var F=[],B=1;B<arguments.length;B++)F[B-1]=arguments[B];if(P&&b(P)){c._currentFallback=null,k.do(f,c,s,v,g,S,L);return}L==null||L.apply(void 0,o.__spreadArray([P],F,!1))});return}else c._currentFallback=null;var O=y(c);if(O.length===1){this.doUri(f,c,_(O[0]),v,g,S,L);return}var E=function(P,F){var B=P.shift();k.doUri(f,c,_(B),v,g,S,function(z){for(var Y=[],$=1;$<arguments.length;$++)Y[$-1]=arguments[$];if(z&&b(z)&&P.length){E(P,!0);return}F&&(c._currentFallback={host:B,validUntil:d.now()+c.options.timeouts.fallbackRetryTimeout}),L==null||L.apply(void 0,o.__spreadArray([z],Y,!1))})};E(O)},p.prototype.doUri=function(f,c,s,v,g,S,L){if(!this.Request){L(new m.PartialErrorInfo("Request invoked before assigned to",null,500));return}this.Request(f,c,s,v,S,g,L)},p}(),a.methods=[C.default.Get,C.default.Delete,C.default.Post,C.default.Put,C.default.Patch],a.methodsWithoutBody=[C.default.Get,C.default.Delete],a.methodsWithBody=[C.default.Post,C.default.Put,C.default.Patch],a);n.default=R},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importStar(i(4)),u=a.__importDefault(i(3)),d=a.__importDefault(i(8)),h=a.__importStar(i(1)),m=i(1);function C(l,A){return!!A.get("x-ably-errorcode")}function w(l,A){if(C(l,A))return l.error&&o.default.fromValues(l.error)}function M(l,A,T,x,b,y,R){var p=new Headers(x||{}),f=l?l.toUpperCase():h.isEmptyArg(y)?"GET":"POST",c=new AbortController,s=setTimeout(function(){c.abort(),R(new o.PartialErrorInfo("Request timed out",null,408))},A?A.options.timeouts.httpRequestTimeout:d.default.TIMEOUTS.httpRequestTimeout),v={method:f,headers:p,body:y};u.default.Config.isWebworker||(v.credentials=p.has("authorization")?"include":"same-origin"),(0,m.getGlobalObject)().fetch(T+"?"+new URLSearchParams(b||{}),v).then(function(g){clearTimeout(s);var S=g.headers.get("Content-Type"),L;S&&S.indexOf("application/x-msgpack")>-1?L=g.arrayBuffer():S&&S.indexOf("application/json")>-1?L=g.json():L=g.text(),L.then(function(k){var _=!!S&&S.indexOf("application/x-msgpack")===-1;if(g.ok)R(null,k,g.headers,_,g.status);else{var I=w(k,g.headers)||new o.PartialErrorInfo("Error response received from server: "+g.status+" body was: "+u.default.Config.inspect(k),null,g.status);R(I,k,g.headers,_,g.status)}})}).catch(function(g){clearTimeout(s),R(g)})}n.default=M},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(41)),u=a.__importStar(i(1)),d=u.getGlobalObject();typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function h(){var M=d.location;return!d.WebSocket||!M||!M.origin||M.origin.indexOf("http")>-1}var m=d.navigator&&d.navigator.userAgent.toString(),C=d.location&&d.location.href,w={agent:"browser",logTimestamps:!0,userAgent:m,currentUrl:C,noUpgrade:m&&!!m.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:d.WebSocket,fetchSupported:!!d.fetch,xhrSupported:d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:typeof document<"u",allowComet:h(),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:o.default,supportsBinary:!!d.TextDecoder,preferBinary:!1,ArrayBuffer:d.ArrayBuffer,atob:d.atob,nextTick:typeof d.setImmediate<"u"?d.setImmediate.bind(d):function(M){setTimeout(M,0)},addEventListener:d.addEventListener,inspect:JSON.stringify,stringByteSize:function(M){return d.TextDecoder&&new d.TextEncoder().encode(M).length||M.length},TextEncoder:d.TextEncoder,TextDecoder:d.TextDecoder,Promise:d.Promise,getRandomValues:function(M){if(M!==void 0)return function(l,A){M.getRandomValues(l),A&&A(null)}}(d.crypto||msCrypto)};n.default=w},function(e,n,i){(function(a){Object.defineProperty(n,"__esModule",{value:!0});var o=i(0),u=o.__importStar(i(1)),d="ablyjs-storage-test",h=function(){function m(){try{a.sessionStorage.setItem(d,d),a.sessionStorage.removeItem(d),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{a.localStorage.setItem(d,d),a.localStorage.removeItem(d),this.localSupported=!0}catch{this.localSupported=!1}}return m.prototype.get=function(C){return this._get(C,!1)},m.prototype.getSession=function(C){return this._get(C,!0)},m.prototype.remove=function(C){return this._remove(C,!1)},m.prototype.removeSession=function(C){return this._remove(C,!0)},m.prototype.set=function(C,w,M){return this._set(C,w,M,!1)},m.prototype.setSession=function(C,w,M){return this._set(C,w,M,!0)},m.prototype._set=function(C,w,M,l){var A={value:w};return M&&(A.expires=u.now()+M),this.storageInterface(l).setItem(C,JSON.stringify(A))},m.prototype._get=function(C,w){if(w&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!w&&!this.localSupported)throw new Error("Local Storage not supported");var M=this.storageInterface(w).getItem(C);if(!M)return null;var l=JSON.parse(M);return l.expires&&l.expires<u.now()?(this.storageInterface(w).removeItem(C),null):l.value},m.prototype._remove=function(C,w){return this.storageInterface(w).removeItem(C)},m.prototype.storageInterface=function(C){return C?a.sessionStorage:a.localStorage},m}();n.default=new h}).call(this,i(13))},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),o=a.__importDefault(i(67)),u={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[o.default.XhrPolling,o.default.XhrStreaming,o.default.JsonP,o.default.WebSocket],baseTransportOrder:[o.default.XhrPolling,o.default.XhrStreaming,o.default.JsonP,o.default.WebSocket],transportPreferenceOrder:[o.default.JsonP,o.default.XhrPolling,o.default.XhrStreaming,o.default.WebSocket],upgradeTransports:[o.default.XhrStreaming,o.default.WebSocket]};n.default=u},function(e,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a;(function(o){o.WebSocket="web_socket",o.Comet="comet",o.XhrStreaming="xhr_streaming",o.XhrPolling="xhr_polling",o.JsonP="jsonp"})(a||(a={})),n.default=a},function(e,n,i){i.r(n);var a=i(29),o=i.n(a),u=i(1),d=i(3),h=i.n(d),m=i(12),C=i.n(m),w=i(17),M=i.n(w),l=function(b){var y="xhr_polling";function R(p,f,c){c.stream=!1,C.a.call(this,p,f,c),this.shortName=y}return u.inherits(R,C.a),R.isAvailable=function(){return h.a.Config.xhrSupported&&h.a.Config.allowComet},R.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},R.prototype.createRequest=function(p,f,c,s,v){return M.a.createRequest(p,f,c,s,v,this.timeouts)},typeof b<"u"&&R.isAvailable()&&(b.supportedTransports[y]=R),R},A=l,T=function(b){var y="xhr_streaming";function R(p,f,c){C.a.call(this,p,f,c),this.shortName=y}return u.inherits(R,C.a),R.isAvailable=function(){return h.a.Config.xhrSupported&&h.a.Config.streamingSupported&&h.a.Config.allowComet},R.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},R.prototype.createRequest=function(p,f,c,s,v){return M.a.createRequest(p,f,c,s,v,this.timeouts)},typeof b<"u"&&R.isAvailable()&&(b.supportedTransports[y]=R),R},x=T;n.default=[o.a,A,x]}]).default})})(eo);var to=eo.exports;const Qs=Tr(to),uf=Jo({__proto__:null,default:Qs},[to]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qe=function(){return qe=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},qe.apply(this,arguments)},Xs=function(){function r(t){this.options=t,this.listeners={}}return r.prototype.on=function(t,e){var n=this.listeners[t]||[];this.listeners[t]=n.concat([e])},r.prototype.triggerEvent=function(t,e){var n=this,i=this.listeners[t]||[];i.forEach(function(a){return a({target:n,event:e})})},r}(),It;(function(r){r[r.Add=0]="Add",r[r.Remove=1]="Remove"})(It||(It={}));var Zs=function(){function r(){this.notifications=[]}return r.prototype.push=function(t){this.notifications.push(t),this.updateFn(t,It.Add,this.notifications)},r.prototype.splice=function(t,e){var n=this.notifications.splice(t,e)[0];return this.updateFn(n,It.Remove,this.notifications),n},r.prototype.indexOf=function(t){return this.notifications.indexOf(t)},r.prototype.onUpdate=function(t){this.updateFn=t},r}(),ut;(function(r){r.Dismiss="dismiss",r.Click="click"})(ut||(ut={}));var Kr={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},eu=function(){function r(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var t=document.createDocumentFragment(),e=this._createHTMLElement({tagName:"div",className:"notyf"});t.appendChild(e),document.body.appendChild(t),this.container=e,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return r.prototype.on=function(t,e){var n;this.events=qe(qe({},this.events),(n={},n[t]=e,n))},r.prototype.update=function(t,e){e===It.Add?this.addNotification(t):e===It.Remove&&this.removeNotification(t)},r.prototype.removeNotification=function(t){var e=this,n=this._popRenderedNotification(t),i;if(n){i=n.node,i.classList.add("notyf__toast--disappear");var a;i.addEventListener(this.animationEndEventName,a=function(o){o.target===i&&(i.removeEventListener(e.animationEndEventName,a),e.container.removeChild(i))})}},r.prototype.addNotification=function(t){var e=this._renderNotification(t);this.notifications.push({notification:t,node:e}),this._announce(t.options.message||"Notification")},r.prototype._renderNotification=function(t){var e,n=this._buildNotificationCard(t),i=t.options.className;return i&&(e=n.classList).add.apply(e,i.split(" ")),this.container.appendChild(n),n},r.prototype._popRenderedNotification=function(t){for(var e=-1,n=0;n<this.notifications.length&&e<0;n++)this.notifications[n].notification===t&&(e=n);if(e!==-1)return this.notifications.splice(e,1)[0]},r.prototype.getXPosition=function(t){var e;return((e=t==null?void 0:t.position)===null||e===void 0?void 0:e.x)||"right"},r.prototype.getYPosition=function(t){var e;return((e=t==null?void 0:t.position)===null||e===void 0?void 0:e.y)||"bottom"},r.prototype.adjustContainerAlignment=function(t){var e=this.X_POSITION_FLEX_MAP[this.getXPosition(t)],n=this.Y_POSITION_FLEX_MAP[this.getYPosition(t)],i=this.container.style;i.setProperty("justify-content",n),i.setProperty("align-items",e)},r.prototype._buildNotificationCard=function(t){var e=this,n=t.options,i=n.icon;this.adjustContainerAlignment(n);var a=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),o=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),u=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),d=this._createHTMLElement({tagName:"div",className:"notyf__message"});d.innerHTML=n.message||"";var h=n.background||n.backgroundColor;if(i){var m=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if((typeof i=="string"||i instanceof String)&&(m.innerHTML=new String(i).valueOf()),typeof i=="object"){var C=i.tagName,w=C===void 0?"i":C,M=i.className,l=i.text,A=i.color,T=A===void 0?h:A,x=this._createHTMLElement({tagName:w,className:M,text:l});T&&(x.style.color=T),m.appendChild(x)}u.appendChild(m)}if(u.appendChild(d),a.appendChild(u),h&&(n.ripple?(o.style.background=h,a.appendChild(o)):a.style.background=h),n.dismissible){var b=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),y=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});b.appendChild(y),u.appendChild(b),a.classList.add("notyf__toast--dismissible"),y.addEventListener("click",function(p){var f,c;(c=(f=e.events)[ut.Dismiss])===null||c===void 0||c.call(f,{target:t,event:p}),p.stopPropagation()})}a.addEventListener("click",function(p){var f,c;return(c=(f=e.events)[ut.Click])===null||c===void 0?void 0:c.call(f,{target:t,event:p})});var R=this.getYPosition(n)==="top"?"upper":"lower";return a.classList.add("notyf__toast--"+R),a},r.prototype._createHTMLElement=function(t){var e=t.tagName,n=t.className,i=t.text,a=document.createElement(e);return n&&(a.className=n),a.textContent=i||null,a},r.prototype._createA11yContainer=function(){var t=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});t.setAttribute("aria-atomic","true"),t.setAttribute("aria-live","polite"),t.style.border="0",t.style.clip="rect(0 0 0 0)",t.style.height="1px",t.style.margin="-1px",t.style.overflow="hidden",t.style.padding="0",t.style.position="absolute",t.style.width="1px",t.style.outline="0",document.body.appendChild(t),this.a11yContainer=t},r.prototype._announce=function(t){var e=this;this.a11yContainer.textContent="",setTimeout(function(){e.a11yContainer.textContent=t},100)},r.prototype._getAnimationEndEventName=function(){var t=document.createElement("_fake"),e={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"},n;for(n in e)if(t.style[n]!==void 0)return e[n];return"animationend"},r}(),lf=function(){function r(t){var e=this;this.dismiss=this._removeNotification,this.notifications=new Zs,this.view=new eu;var n=this.registerTypes(t);this.options=qe(qe({},Kr),t),this.options.types=n,this.notifications.onUpdate(function(i,a){return e.view.update(i,a)}),this.view.on(ut.Dismiss,function(i){var a=i.target,o=i.event;e._removeNotification(a),a.triggerEvent(ut.Dismiss,o)}),this.view.on(ut.Click,function(i){var a=i.target,o=i.event;return a.triggerEvent(ut.Click,o)})}return r.prototype.error=function(t){var e=this.normalizeOptions("error",t);return this.open(e)},r.prototype.success=function(t){var e=this.normalizeOptions("success",t);return this.open(e)},r.prototype.open=function(t){var e=this.options.types.find(function(a){var o=a.type;return o===t.type})||{},n=qe(qe({},e),t);this.assignProps(["ripple","position","dismissible"],n);var i=new Xs(n);return this._pushNotification(i),i},r.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},r.prototype.assignProps=function(t,e){var n=this;t.forEach(function(i){e[i]=e[i]==null?n.options[i]:e[i]})},r.prototype._pushNotification=function(t){var e=this;this.notifications.push(t);var n=t.options.duration!==void 0?t.options.duration:this.options.duration;n&&setTimeout(function(){return e._removeNotification(t)},n)},r.prototype._removeNotification=function(t){var e=this.notifications.indexOf(t);e!==-1&&this.notifications.splice(e,1)},r.prototype.normalizeOptions=function(t,e){var n={type:t};return typeof e=="string"?n.message=e:typeof e=="object"&&(n=qe(qe({},n),e)),n},r.prototype.registerTypes=function(t){var e=(t&&t.types||[]).slice(),n=Kr.types.map(function(i){var a=-1;e.forEach(function(u,d){u.type===i.type&&(a=d)});var o=a!==-1?e.splice(a,1)[0]:{};return qe(qe({},i),o)});return n.concat(e)},r}(),Yn={exports:{}},Jr;function no(){return Jr||(Jr=1,function(r,t){(function(e,n){r.exports=n()})(Kt,function(){var e=1e3,n=6e4,i=36e5,a="millisecond",o="second",u="minute",d="hour",h="day",m="week",C="month",w="quarter",M="year",l="date",A="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var I=["th","st","nd","rd"],O=_%100;return"["+_+(I[(O-20)%10]||I[O]||I[0])+"]"}},y=function(_,I,O){var E=String(_);return!E||E.length>=I?_:""+Array(I+1-E.length).join(O)+_},R={s:y,z:function(_){var I=-_.utcOffset(),O=Math.abs(I),E=Math.floor(O/60),P=O%60;return(I<=0?"+":"-")+y(E,2,"0")+":"+y(P,2,"0")},m:function _(I,O){if(I.date()<O.date())return-_(O,I);var E=12*(O.year()-I.year())+(O.month()-I.month()),P=I.clone().add(E,C),F=O-P<0,B=I.clone().add(E+(F?-1:1),C);return+(-(E+(O-P)/(F?P-B:B-P))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:C,y:M,w:m,d:h,D:l,h:d,m:u,s:o,ms:a,Q:w}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},p="en",f={};f[p]=b;var c="$isDayjsObject",s=function(_){return _ instanceof L||!(!_||!_[c])},v=function _(I,O,E){var P;if(!I)return p;if(typeof I=="string"){var F=I.toLowerCase();f[F]&&(P=F),O&&(f[F]=O,P=F);var B=I.split("-");if(!P&&B.length>1)return _(B[0])}else{var z=I.name;f[z]=I,P=z}return!E&&P&&(p=P),P||!E&&p},g=function(_,I){if(s(_))return _.clone();var O=typeof I=="object"?I:{};return O.date=_,O.args=arguments,new L(O)},S=R;S.l=v,S.i=s,S.w=function(_,I){return g(_,{locale:I.$L,utc:I.$u,x:I.$x,$offset:I.$offset})};var L=function(){function _(O){this.$L=v(O.locale,null,!0),this.parse(O),this.$x=this.$x||O.x||{},this[c]=!0}var I=_.prototype;return I.parse=function(O){this.$d=function(E){var P=E.date,F=E.utc;if(P===null)return new Date(NaN);if(S.u(P))return new Date;if(P instanceof Date)return new Date(P);if(typeof P=="string"&&!/Z$/i.test(P)){var B=P.match(T);if(B){var z=B[2]-1||0,Y=(B[7]||"0").substring(0,3);return F?new Date(Date.UTC(B[1],z,B[3]||1,B[4]||0,B[5]||0,B[6]||0,Y)):new Date(B[1],z,B[3]||1,B[4]||0,B[5]||0,B[6]||0,Y)}}return new Date(P)}(O),this.init()},I.init=function(){var O=this.$d;this.$y=O.getFullYear(),this.$M=O.getMonth(),this.$D=O.getDate(),this.$W=O.getDay(),this.$H=O.getHours(),this.$m=O.getMinutes(),this.$s=O.getSeconds(),this.$ms=O.getMilliseconds()},I.$utils=function(){return S},I.isValid=function(){return this.$d.toString()!==A},I.isSame=function(O,E){var P=g(O);return this.startOf(E)<=P&&P<=this.endOf(E)},I.isAfter=function(O,E){return g(O)<this.startOf(E)},I.isBefore=function(O,E){return this.endOf(E)<g(O)},I.$g=function(O,E,P){return S.u(O)?this[E]:this.set(P,O)},I.unix=function(){return Math.floor(this.valueOf()/1e3)},I.valueOf=function(){return this.$d.getTime()},I.startOf=function(O,E){var P=this,F=!!S.u(E)||E,B=S.p(O),z=function(Z,ee){var ie=S.w(P.$u?Date.UTC(P.$y,ee,Z):new Date(P.$y,ee,Z),P);return F?ie:ie.endOf(h)},Y=function(Z,ee){return S.w(P.toDate()[Z].apply(P.toDate("s"),(F?[0,0,0,0]:[23,59,59,999]).slice(ee)),P)},$=this.$W,D=this.$M,N=this.$D,j="set"+(this.$u?"UTC":"");switch(B){case M:return F?z(1,0):z(31,11);case C:return F?z(1,D):z(0,D+1);case m:var G=this.$locale().weekStart||0,K=($<G?$+7:$)-G;return z(F?N-K:N+(6-K),D);case h:case l:return Y(j+"Hours",0);case d:return Y(j+"Minutes",1);case u:return Y(j+"Seconds",2);case o:return Y(j+"Milliseconds",3);default:return this.clone()}},I.endOf=function(O){return this.startOf(O,!1)},I.$set=function(O,E){var P,F=S.p(O),B="set"+(this.$u?"UTC":""),z=(P={},P[h]=B+"Date",P[l]=B+"Date",P[C]=B+"Month",P[M]=B+"FullYear",P[d]=B+"Hours",P[u]=B+"Minutes",P[o]=B+"Seconds",P[a]=B+"Milliseconds",P)[F],Y=F===h?this.$D+(E-this.$W):E;if(F===C||F===M){var $=this.clone().set(l,1);$.$d[z](Y),$.init(),this.$d=$.set(l,Math.min(this.$D,$.daysInMonth())).$d}else z&&this.$d[z](Y);return this.init(),this},I.set=function(O,E){return this.clone().$set(O,E)},I.get=function(O){return this[S.p(O)]()},I.add=function(O,E){var P,F=this;O=Number(O);var B=S.p(E),z=function(D){var N=g(F);return S.w(N.date(N.date()+Math.round(D*O)),F)};if(B===C)return this.set(C,this.$M+O);if(B===M)return this.set(M,this.$y+O);if(B===h)return z(1);if(B===m)return z(7);var Y=(P={},P[u]=n,P[d]=i,P[o]=e,P)[B]||1,$=this.$d.getTime()+O*Y;return S.w($,this)},I.subtract=function(O,E){return this.add(-1*O,E)},I.format=function(O){var E=this,P=this.$locale();if(!this.isValid())return P.invalidDate||A;var F=O||"YYYY-MM-DDTHH:mm:ssZ",B=S.z(this),z=this.$H,Y=this.$m,$=this.$M,D=P.weekdays,N=P.months,j=P.meridiem,G=function(ee,ie,ue,pe){return ee&&(ee[ie]||ee(E,F))||ue[ie].slice(0,pe)},K=function(ee){return S.s(z%12||12,ee,"0")},Z=j||function(ee,ie,ue){var pe=ee<12?"AM":"PM";return ue?pe.toLowerCase():pe};return F.replace(x,function(ee,ie){return ie||function(ue){switch(ue){case"YY":return String(E.$y).slice(-2);case"YYYY":return S.s(E.$y,4,"0");case"M":return $+1;case"MM":return S.s($+1,2,"0");case"MMM":return G(P.monthsShort,$,N,3);case"MMMM":return G(N,$);case"D":return E.$D;case"DD":return S.s(E.$D,2,"0");case"d":return String(E.$W);case"dd":return G(P.weekdaysMin,E.$W,D,2);case"ddd":return G(P.weekdaysShort,E.$W,D,3);case"dddd":return D[E.$W];case"H":return String(z);case"HH":return S.s(z,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return Z(z,Y,!0);case"A":return Z(z,Y,!1);case"m":return String(Y);case"mm":return S.s(Y,2,"0");case"s":return String(E.$s);case"ss":return S.s(E.$s,2,"0");case"SSS":return S.s(E.$ms,3,"0");case"Z":return B}return null}(ee)||B.replace(":","")})},I.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},I.diff=function(O,E,P){var F,B=this,z=S.p(E),Y=g(O),$=(Y.utcOffset()-this.utcOffset())*n,D=this-Y,N=function(){return S.m(B,Y)};switch(z){case M:F=N()/12;break;case C:F=N();break;case w:F=N()/3;break;case m:F=(D-$)/6048e5;break;case h:F=(D-$)/864e5;break;case d:F=D/i;break;case u:F=D/n;break;case o:F=D/e;break;default:F=D}return P?F:S.a(F)},I.daysInMonth=function(){return this.endOf(C).$D},I.$locale=function(){return f[this.$L]},I.locale=function(O,E){if(!O)return this.$L;var P=this.clone(),F=v(O,E,!0);return F&&(P.$L=F),P},I.clone=function(){return S.w(this.$d,this)},I.toDate=function(){return new Date(this.valueOf())},I.toJSON=function(){return this.isValid()?this.toISOString():null},I.toISOString=function(){return this.$d.toISOString()},I.toString=function(){return this.$d.toUTCString()},_}(),k=L.prototype;return g.prototype=k,[["$ms",a],["$s",o],["$m",u],["$H",d],["$W",h],["$M",C],["$y",M],["$D",l]].forEach(function(_){k[_[1]]=function(I){return this.$g(I,_[0],_[1])}}),g.extend=function(_,I){return _.$i||(_(I,L,g),_.$i=!0),g},g.locale=v,g.isDayjs=s,g.unix=function(_){return g(1e3*_)},g.en=f[p],g.Ls=f,g.p={},g})}(Yn)),Yn.exports}var tu=no();const cf=Tr(tu);var nu={exports:{}};(function(r,t){(function(e,n){r.exports=n(no())})(Kt,function(e){function n(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var i=n(e),a={name:"id",weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Agt_Sep_Okt_Nov_Des".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),weekStart:1,formats:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},ordinal:function(o){return o+"."}};return i.default.locale(a,null,!0),a})})(nu);var Kn=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Rt={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(r){return typeof console<"u"&&console.warn(r)},getWeek:function(r){var t=new Date(r.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},Wt={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(r){var t=r%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ue=function(r,t){return t===void 0&&(t=2),("000"+r).slice(t*-1)},Je=function(r){return r===!0?1:0};function qr(r,t){var e;return function(){var n=this,i=arguments;clearTimeout(e),e=setTimeout(function(){return r.apply(n,i)},t)}}var Jn=function(r){return r instanceof Array?r:[r]};function Le(r,t,e){if(e===!0)return r.classList.add(t);r.classList.remove(t)}function ge(r,t,e){var n=window.document.createElement(r);return t=t||"",e=e||"",n.className=t,e!==void 0&&(n.textContent=e),n}function Xt(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function ro(r,t){if(t(r))return r;if(r.parentNode)return ro(r.parentNode,t)}function Zt(r,t){var e=ge("div","numInputWrapper"),n=ge("input","numInput "+r),i=ge("span","arrowUp"),a=ge("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),t!==void 0)for(var o in t)n.setAttribute(o,t[o]);return e.appendChild(n),e.appendChild(i),e.appendChild(a),e}function Ve(r){try{if(typeof r.composedPath=="function"){var t=r.composedPath();return t[0]}return r.target}catch{return r.target}}var qn=function(){},On=function(r,t,e){return e.months[t?"shorthand":"longhand"][r]},ru={D:qn,F:function(r,t,e){r.setMonth(e.months.longhand.indexOf(t))},G:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},H:function(r,t){r.setHours(parseFloat(t))},J:function(r,t){r.setDate(parseFloat(t))},K:function(r,t,e){r.setHours(r.getHours()%12+12*Je(new RegExp(e.amPM[1],"i").test(t)))},M:function(r,t,e){r.setMonth(e.months.shorthand.indexOf(t))},S:function(r,t){r.setSeconds(parseFloat(t))},U:function(r,t){return new Date(parseFloat(t)*1e3)},W:function(r,t,e){var n=parseInt(t),i=new Date(r.getFullYear(),0,2+(n-1)*7,0,0,0,0);return i.setDate(i.getDate()-i.getDay()+e.firstDayOfWeek),i},Y:function(r,t){r.setFullYear(parseFloat(t))},Z:function(r,t){return new Date(t)},d:function(r,t){r.setDate(parseFloat(t))},h:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},i:function(r,t){r.setMinutes(parseFloat(t))},j:function(r,t){r.setDate(parseFloat(t))},l:qn,m:function(r,t){r.setMonth(parseFloat(t)-1)},n:function(r,t){r.setMonth(parseFloat(t)-1)},s:function(r,t){r.setSeconds(parseFloat(t))},u:function(r,t){return new Date(parseFloat(t))},w:qn,y:function(r,t){r.setFullYear(2e3+parseFloat(t))}},vt={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},jt={Z:function(r){return r.toISOString()},D:function(r,t,e){return t.weekdays.shorthand[jt.w(r,t,e)]},F:function(r,t,e){return On(jt.n(r,t,e)-1,!1,t)},G:function(r,t,e){return Ue(jt.h(r,t,e))},H:function(r){return Ue(r.getHours())},J:function(r,t){return t.ordinal!==void 0?r.getDate()+t.ordinal(r.getDate()):r.getDate()},K:function(r,t){return t.amPM[Je(r.getHours()>11)]},M:function(r,t){return On(r.getMonth(),!0,t)},S:function(r){return Ue(r.getSeconds())},U:function(r){return r.getTime()/1e3},W:function(r,t,e){return e.getWeek(r)},Y:function(r){return Ue(r.getFullYear(),4)},d:function(r){return Ue(r.getDate())},h:function(r){return r.getHours()%12?r.getHours()%12:12},i:function(r){return Ue(r.getMinutes())},j:function(r){return r.getDate()},l:function(r,t){return t.weekdays.longhand[r.getDay()]},m:function(r){return Ue(r.getMonth()+1)},n:function(r){return r.getMonth()+1},s:function(r){return r.getSeconds()},u:function(r){return r.getTime()},w:function(r){return r.getDay()},y:function(r){return String(r.getFullYear()).substring(2)}},oo=function(r){var t=r.config,e=t===void 0?Rt:t,n=r.l10n,i=n===void 0?Wt:n,a=r.isMobile,o=a===void 0?!1:a;return function(u,d,h){var m=h||i;return e.formatDate!==void 0&&!o?e.formatDate(u,d,m):d.split("").map(function(C,w,M){return jt[C]&&M[w-1]!=="\\"?jt[C](u,m,e):C!=="\\"?C:""}).join("")}},mr=function(r){var t=r.config,e=t===void 0?Rt:t,n=r.l10n,i=n===void 0?Wt:n;return function(a,o,u,d){if(!(a!==0&&!a)){var h=d||i,m,C=a;if(a instanceof Date)m=new Date(a.getTime());else if(typeof a!="string"&&a.toFixed!==void 0)m=new Date(a);else if(typeof a=="string"){var w=o||(e||Rt).dateFormat,M=String(a).trim();if(M==="today")m=new Date,u=!0;else if(e&&e.parseDate)m=e.parseDate(a,w);else if(/Z$/.test(M)||/GMT$/.test(M))m=new Date(a);else{for(var l=void 0,A=[],T=0,x=0,b="";T<w.length;T++){var y=w[T],R=y==="\\",p=w[T-1]==="\\"||R;if(vt[y]&&!p){b+=vt[y];var f=new RegExp(b).exec(a);f&&(l=!0)&&A[y!=="Y"?"push":"unshift"]({fn:ru[y],val:f[++x]})}else R||(b+=".")}m=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),A.forEach(function(c){var s=c.fn,v=c.val;return m=s(m,v,h)||m}),m=l?m:void 0}}if(!(m instanceof Date&&!isNaN(m.getTime()))){e.errorHandler(new Error("Invalid date provided: "+C));return}return u===!0&&m.setHours(0,0,0,0),m}}};function Ye(r,t,e){return e===void 0&&(e=!0),e!==!1?new Date(r.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):r.getTime()-t.getTime()}var iu=function(r,t,e){return r>Math.min(t,e)&&r<Math.max(t,e)},Qn=function(r,t,e){return r*3600+t*60+e},ou=function(r){var t=Math.floor(r/3600),e=(r-t*3600)/60;return[t,e,r-t*3600-e*60]},au={DAY:864e5};function Xn(r){var t=r.defaultHour,e=r.defaultMinute,n=r.defaultSeconds;if(r.minDate!==void 0){var i=r.minDate.getHours(),a=r.minDate.getMinutes(),o=r.minDate.getSeconds();t<i&&(t=i),t===i&&e<a&&(e=a),t===i&&e===a&&n<o&&(n=r.minDate.getSeconds())}if(r.maxDate!==void 0){var u=r.maxDate.getHours(),d=r.maxDate.getMinutes();t=Math.min(t,u),t===u&&(e=Math.min(d,e)),t===u&&e===d&&(n=r.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!r)throw TypeError("Cannot convert undefined or null to object");for(var n=function(u){u&&Object.keys(u).forEach(function(d){return r[d]=u[d]})},i=0,a=t;i<a.length;i++){var o=a[i];n(o)}return r});var Pe=function(){return Pe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Pe.apply(this,arguments)},Qr=function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),i=0,t=0;t<e;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)n[i]=a[o];return n},su=300;function uu(r,t){var e={config:Pe(Pe({},Rt),Re.defaultConfig),l10n:Wt};e.parseDate=mr({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=A,e._setHoursFromDate=w,e._positionCalendar=Fe,e.changeMonth=z,e.changeYear=G,e.clear=Y,e.close=$,e.onMouseOver=ue,e._createElement=ge,e.createDay=f,e.destroy=D,e.isEnabled=K,e.jumpToDate=b,e.updateValue=rt,e.open=ne,e.redraw=ft,e.set=Fn,e.setDate=W,e.toggle=ht;function n(){e.utils={getDaysInMonth:function(U,H){return U===void 0&&(U=e.currentMonth),H===void 0&&(H=e.currentYear),U===1&&(H%4===0&&H%100!==0||H%400===0)?29:e.l10n.daysInMonth[U]}}}function i(){e.element=e.input=r,e.isOpen=!1,Te(),we(),oe(),X(),n(),e.isMobile||p(),x(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&w(e.config.noCalendar?e.latestSelectedDateObj:void 0),rt(!1)),u();var U=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&U&&Fe(),Oe("onReady")}function a(){var U;return((U=e.calendarContainer)===null||U===void 0?void 0:U.getRootNode()).activeElement||document.activeElement}function o(U){return U.bind(e)}function u(){var U=e.config;U.weekNumbers===!1&&U.showMonths===1||U.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var H=(e.days.offsetWidth+1)*U.showMonths;e.daysContainer.style.width=H+"px",e.calendarContainer.style.width=H+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function d(U){if(e.selectedDates.length===0){var H=e.config.minDate===void 0||Ye(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),V=Xn(e.config);H.setHours(V.hours,V.minutes,V.seconds,H.getMilliseconds()),e.selectedDates=[H],e.latestSelectedDateObj=H}U!==void 0&&U.type!=="blur"&&Mo(U);var q=e._input.value;C(),rt(),e._input.value!==q&&e._debouncedChange()}function h(U,H){return U%12+12*Je(H===e.l10n.amPM[1])}function m(U){switch(U%24){case 0:case 12:return 12;default:return U%12}}function C(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var U=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,H=(parseInt(e.minuteElement.value,10)||0)%60,V=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(U=h(U,e.amPM.textContent));var q=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&Ye(e.latestSelectedDateObj,e.config.minDate,!0)===0,te=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&Ye(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var re=Qn(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),fe=Qn(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),se=Qn(U,H,V);if(se>fe&&se<re){var he=ou(re);U=he[0],H=he[1],V=he[2]}}else{if(te){var ae=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;U=Math.min(U,ae.getHours()),U===ae.getHours()&&(H=Math.min(H,ae.getMinutes())),H===ae.getMinutes()&&(V=Math.min(V,ae.getSeconds()))}if(q){var le=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;U=Math.max(U,le.getHours()),U===le.getHours()&&H<le.getMinutes()&&(H=le.getMinutes()),H===le.getMinutes()&&(V=Math.max(V,le.getSeconds()))}}M(U,H,V)}}function w(U){var H=U||e.latestSelectedDateObj;H&&H instanceof Date&&M(H.getHours(),H.getMinutes(),H.getSeconds())}function M(U,H,V){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(U%24,H,V||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=Ue(e.config.time_24hr?U:(12+U)%12+12*Je(U%12===0)),e.minuteElement.value=Ue(H),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[Je(U>=12)]),e.secondElement!==void 0&&(e.secondElement.value=Ue(V)))}function l(U){var H=Ve(U),V=parseInt(H.value)+(U.delta||0);(V/1e3>1||U.key==="Enter"&&!/[^\d]/.test(V.toString()))&&G(V)}function A(U,H,V,q){if(H instanceof Array)return H.forEach(function(te){return A(U,te,V,q)});if(U instanceof Array)return U.forEach(function(te){return A(te,H,V,q)});U.addEventListener(H,V,q),e._handlers.push({remove:function(){return U.removeEventListener(H,V,q)}})}function T(){Oe("onChange")}function x(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(V){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+V+"]"),function(q){return A(q,"click",e[V])})}),e.isMobile){_e();return}var U=qr(pe,50);if(e._debouncedChange=qr(T,su),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&A(e.daysContainer,"mouseover",function(V){e.config.mode==="range"&&ue(Ve(V))}),A(e._input,"keydown",ie),e.calendarContainer!==void 0&&A(e.calendarContainer,"keydown",ie),!e.config.inline&&!e.config.static&&A(window,"resize",U),window.ontouchstart!==void 0?A(window.document,"touchstart",j):A(window.document,"mousedown",j),A(window.document,"focus",j,{capture:!0}),e.config.clickOpens===!0&&(A(e._input,"focus",e.open),A(e._input,"click",e.open)),e.daysContainer!==void 0&&(A(e.monthNav,"click",Ro),A(e.monthNav,["keyup","increment"],l),A(e.daysContainer,"click",wt)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var H=function(V){return Ve(V).select()};A(e.timeContainer,["increment"],d),A(e.timeContainer,"blur",d,{capture:!0}),A(e.timeContainer,"click",y),A([e.hourElement,e.minuteElement],["focus","click"],H),e.secondElement!==void 0&&A(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&A(e.amPM,"click",function(V){d(V)})}e.config.allowInput&&A(e._input,"blur",ee)}function b(U,H){var V=U!==void 0?e.parseDate(U):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),q=e.currentYear,te=e.currentMonth;try{V!==void 0&&(e.currentYear=V.getFullYear(),e.currentMonth=V.getMonth())}catch(re){re.message="Invalid date supplied: "+V,e.config.errorHandler(re)}H&&e.currentYear!==q&&(Oe("onYearChange"),k()),H&&(e.currentYear!==q||e.currentMonth!==te)&&Oe("onMonthChange"),e.redraw()}function y(U){var H=Ve(U);~H.className.indexOf("arrow")&&R(U,H.classList.contains("arrowUp")?1:-1)}function R(U,H,V){var q=U&&Ve(U),te=V||q&&q.parentNode&&q.parentNode.firstChild,re=jn("increment");re.delta=H,te&&te.dispatchEvent(re)}function p(){var U=window.document.createDocumentFragment();if(e.calendarContainer=ge("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(U.appendChild(O()),e.innerContainer=ge("div","flatpickr-innerContainer"),e.config.weekNumbers){var H=B(),V=H.weekWrapper,q=H.weekNumbers;e.innerContainer.appendChild(V),e.weekNumbers=q,e.weekWrapper=V}e.rContainer=ge("div","flatpickr-rContainer"),e.rContainer.appendChild(P()),e.daysContainer||(e.daysContainer=ge("div","flatpickr-days"),e.daysContainer.tabIndex=-1),L(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),U.appendChild(e.innerContainer)}e.config.enableTime&&U.appendChild(E()),Le(e.calendarContainer,"rangeMode",e.config.mode==="range"),Le(e.calendarContainer,"animate",e.config.animate===!0),Le(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(U);var te=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!te&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var re=ge("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(re,e.element),re.appendChild(e.element),e.altInput&&re.appendChild(e.altInput),re.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function f(U,H,V,q){var te=K(H,!0),re=ge("span",U,H.getDate().toString());return re.dateObj=H,re.$i=q,re.setAttribute("aria-label",e.formatDate(H,e.config.ariaDateFormat)),U.indexOf("hidden")===-1&&Ye(H,e.now)===0&&(e.todayDateElem=re,re.classList.add("today"),re.setAttribute("aria-current","date")),te?(re.tabIndex=-1,Un(H)&&(re.classList.add("selected"),e.selectedDateElem=re,e.config.mode==="range"&&(Le(re,"startRange",e.selectedDates[0]&&Ye(H,e.selectedDates[0],!0)===0),Le(re,"endRange",e.selectedDates[1]&&Ye(H,e.selectedDates[1],!0)===0),U==="nextMonthDay"&&re.classList.add("inRange")))):re.classList.add("flatpickr-disabled"),e.config.mode==="range"&&To(H)&&!Un(H)&&re.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&U!=="prevMonthDay"&&q%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(H)+"</span>"),Oe("onDayCreate",re),re}function c(U){U.focus(),e.config.mode==="range"&&ue(U)}function s(U){for(var H=U>0?0:e.config.showMonths-1,V=U>0?e.config.showMonths:-1,q=H;q!=V;q+=U)for(var te=e.daysContainer.children[q],re=U>0?0:te.children.length-1,fe=U>0?te.children.length:-1,se=re;se!=fe;se+=U){var he=te.children[se];if(he.className.indexOf("hidden")===-1&&K(he.dateObj))return he}}function v(U,H){for(var V=U.className.indexOf("Month")===-1?U.dateObj.getMonth():e.currentMonth,q=H>0?e.config.showMonths:-1,te=H>0?1:-1,re=V-e.currentMonth;re!=q;re+=te)for(var fe=e.daysContainer.children[re],se=V-e.currentMonth===re?U.$i+H:H<0?fe.children.length-1:0,he=fe.children.length,ae=se;ae>=0&&ae<he&&ae!=(H>0?he:-1);ae+=te){var le=fe.children[ae];if(le.className.indexOf("hidden")===-1&&K(le.dateObj)&&Math.abs(U.$i-ae)>=Math.abs(H))return c(le)}e.changeMonth(te),g(s(te),0)}function g(U,H){var V=a(),q=Z(V||document.body),te=U!==void 0?U:q?V:e.selectedDateElem!==void 0&&Z(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&Z(e.todayDateElem)?e.todayDateElem:s(H>0?1:-1);te===void 0?e._input.focus():q?v(te,H):c(te)}function S(U,H){for(var V=(new Date(U,H,1).getDay()-e.l10n.firstDayOfWeek+7)%7,q=e.utils.getDaysInMonth((H-1+12)%12,U),te=e.utils.getDaysInMonth(H,U),re=window.document.createDocumentFragment(),fe=e.config.showMonths>1,se=fe?"prevMonthDay hidden":"prevMonthDay",he=fe?"nextMonthDay hidden":"nextMonthDay",ae=q+1-V,le=0;ae<=q;ae++,le++)re.appendChild(f("flatpickr-day "+se,new Date(U,H-1,ae),ae,le));for(ae=1;ae<=te;ae++,le++)re.appendChild(f("flatpickr-day",new Date(U,H,ae),ae,le));for(var ve=te+1;ve<=42-V&&(e.config.showMonths===1||le%7!==0);ve++,le++)re.appendChild(f("flatpickr-day "+he,new Date(U,H+1,ve%te),ve,le));var et=ge("div","dayContainer");return et.appendChild(re),et}function L(){if(e.daysContainer!==void 0){Xt(e.daysContainer),e.weekNumbers&&Xt(e.weekNumbers);for(var U=document.createDocumentFragment(),H=0;H<e.config.showMonths;H++){var V=new Date(e.currentYear,e.currentMonth,1);V.setMonth(e.currentMonth+H),U.appendChild(S(V.getFullYear(),V.getMonth()))}e.daysContainer.appendChild(U),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&ue()}}function k(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var U=function(q){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&q<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&q>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var H=0;H<12;H++)if(U(H)){var V=ge("option","flatpickr-monthDropdown-month");V.value=new Date(e.currentYear,H).getMonth().toString(),V.textContent=On(H,e.config.shorthandCurrentMonth,e.l10n),V.tabIndex=-1,e.currentMonth===H&&(V.selected=!0),e.monthsDropdownContainer.appendChild(V)}}}function _(){var U=ge("div","flatpickr-month"),H=window.document.createDocumentFragment(),V;e.config.showMonths>1||e.config.monthSelectorType==="static"?V=ge("span","cur-month"):(e.monthsDropdownContainer=ge("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),A(e.monthsDropdownContainer,"change",function(fe){var se=Ve(fe),he=parseInt(se.value,10);e.changeMonth(he-e.currentMonth),Oe("onMonthChange")}),k(),V=e.monthsDropdownContainer);var q=Zt("cur-year",{tabindex:"-1"}),te=q.getElementsByTagName("input")[0];te.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&te.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(te.setAttribute("max",e.config.maxDate.getFullYear().toString()),te.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var re=ge("div","flatpickr-current-month");return re.appendChild(V),re.appendChild(q),H.appendChild(re),U.appendChild(H),{container:U,yearElement:te,monthElement:V}}function I(){Xt(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var U=e.config.showMonths;U--;){var H=_();e.yearElements.push(H.yearElement),e.monthElements.push(H.monthElement),e.monthNav.appendChild(H.container)}e.monthNav.appendChild(e.nextMonthNav)}function O(){return e.monthNav=ge("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=ge("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=ge("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,I(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(U){e.__hidePrevMonthArrow!==U&&(Le(e.prevMonthNav,"flatpickr-disabled",U),e.__hidePrevMonthArrow=U)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(U){e.__hideNextMonthArrow!==U&&(Le(e.nextMonthNav,"flatpickr-disabled",U),e.__hideNextMonthArrow=U)}}),e.currentYearElement=e.yearElements[0],Qt(),e.monthNav}function E(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var U=Xn(e.config);e.timeContainer=ge("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var H=ge("span","flatpickr-time-separator",":"),V=Zt("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=V.getElementsByTagName("input")[0];var q=Zt("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=q.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=Ue(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?U.hours:m(U.hours)),e.minuteElement.value=Ue(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():U.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(V),e.timeContainer.appendChild(H),e.timeContainer.appendChild(q),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var te=Zt("flatpickr-second");e.secondElement=te.getElementsByTagName("input")[0],e.secondElement.value=Ue(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():U.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(ge("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(te)}return e.config.time_24hr||(e.amPM=ge("span","flatpickr-am-pm",e.l10n.amPM[Je((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function P(){e.weekdayContainer?Xt(e.weekdayContainer):e.weekdayContainer=ge("div","flatpickr-weekdays");for(var U=e.config.showMonths;U--;){var H=ge("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(H)}return F(),e.weekdayContainer}function F(){if(e.weekdayContainer){var U=e.l10n.firstDayOfWeek,H=Qr(e.l10n.weekdays.shorthand);U>0&&U<H.length&&(H=Qr(H.splice(U,H.length),H.splice(0,U)));for(var V=e.config.showMonths;V--;)e.weekdayContainer.children[V].innerHTML=`
      <span class='flatpickr-weekday'>
        `+H.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function B(){e.calendarContainer.classList.add("hasWeeks");var U=ge("div","flatpickr-weekwrapper");U.appendChild(ge("span","flatpickr-weekday",e.l10n.weekAbbreviation));var H=ge("div","flatpickr-weeks");return U.appendChild(H),{weekWrapper:U,weekNumbers:H}}function z(U,H){H===void 0&&(H=!0);var V=H?U:U-e.currentMonth;V<0&&e._hidePrevMonthArrow===!0||V>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=V,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,Oe("onYearChange"),k()),L(),Oe("onMonthChange"),Qt())}function Y(U,H){if(U===void 0&&(U=!0),H===void 0&&(H=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,H===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var V=Xn(e.config),q=V.hours,te=V.minutes,re=V.seconds;M(q,te,re)}e.redraw(),U&&Oe("onChange")}function $(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),Oe("onClose")}function D(){e.config!==void 0&&Oe("onDestroy");for(var U=e._handlers.length;U--;)e._handlers[U].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var H=e.calendarContainer.parentNode;if(H.lastChild&&H.removeChild(H.lastChild),H.parentNode){for(;H.firstChild;)H.parentNode.insertBefore(H.firstChild,H);H.parentNode.removeChild(H)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(V){try{delete e[V]}catch{}})}function N(U){return e.calendarContainer.contains(U)}function j(U){if(e.isOpen&&!e.config.inline){var H=Ve(U),V=N(H),q=H===e.input||H===e.altInput||e.element.contains(H)||U.path&&U.path.indexOf&&(~U.path.indexOf(e.input)||~U.path.indexOf(e.altInput)),te=!q&&!V&&!N(U.relatedTarget),re=!e.config.ignoredFocusElements.some(function(fe){return fe.contains(H)});te&&re&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&d(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function G(U){if(!(!U||e.config.minDate&&U<e.config.minDate.getFullYear()||e.config.maxDate&&U>e.config.maxDate.getFullYear())){var H=U,V=e.currentYear!==H;e.currentYear=H||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),V&&(e.redraw(),Oe("onYearChange"),k())}}function K(U,H){var V;H===void 0&&(H=!0);var q=e.parseDate(U,void 0,H);if(e.config.minDate&&q&&Ye(q,e.config.minDate,H!==void 0?H:!e.minDateHasTime)<0||e.config.maxDate&&q&&Ye(q,e.config.maxDate,H!==void 0?H:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(q===void 0)return!1;for(var te=!!e.config.enable,re=(V=e.config.enable)!==null&&V!==void 0?V:e.config.disable,fe=0,se=void 0;fe<re.length;fe++){if(se=re[fe],typeof se=="function"&&se(q))return te;if(se instanceof Date&&q!==void 0&&se.getTime()===q.getTime())return te;if(typeof se=="string"){var he=e.parseDate(se,void 0,!0);return he&&he.getTime()===q.getTime()?te:!te}else if(typeof se=="object"&&q!==void 0&&se.from&&se.to&&q.getTime()>=se.from.getTime()&&q.getTime()<=se.to.getTime())return te}return!te}function Z(U){return e.daysContainer!==void 0?U.className.indexOf("hidden")===-1&&U.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(U):!1}function ee(U){var H=U.target===e._input,V=e._input.value.trimEnd()!==Bn();H&&V&&!(U.relatedTarget&&N(U.relatedTarget))&&e.setDate(e._input.value,!0,U.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function ie(U){var H=Ve(U),V=e.config.wrap?r.contains(H):H===e._input,q=e.config.allowInput,te=e.isOpen&&(!q||!V),re=e.config.inline&&V&&!q;if(U.keyCode===13&&V){if(q)return e.setDate(e._input.value,!0,H===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),H.blur();e.open()}else if(N(H)||te||re){var fe=!!e.timeContainer&&e.timeContainer.contains(H);switch(U.keyCode){case 13:fe?(U.preventDefault(),d(),dt()):wt(U);break;case 27:U.preventDefault(),dt();break;case 8:case 46:V&&!e.config.allowInput&&(U.preventDefault(),e.clear());break;case 37:case 39:if(!fe&&!V){U.preventDefault();var se=a();if(e.daysContainer!==void 0&&(q===!1||se&&Z(se))){var he=U.keyCode===39?1:-1;U.ctrlKey?(U.stopPropagation(),z(he),g(s(1),0)):g(void 0,he)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:U.preventDefault();var ae=U.keyCode===40?1:-1;e.daysContainer&&H.$i!==void 0||H===e.input||H===e.altInput?U.ctrlKey?(U.stopPropagation(),G(e.currentYear-ae),g(s(1),0)):fe||g(void 0,ae*7):H===e.currentYearElement?G(e.currentYear-ae):e.config.enableTime&&(!fe&&e.hourElement&&e.hourElement.focus(),d(U),e._debouncedChange());break;case 9:if(fe){var le=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(We){return We}),ve=le.indexOf(H);if(ve!==-1){var et=le[ve+(U.shiftKey?-1:1)];U.preventDefault(),(et||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(H)&&U.shiftKey&&(U.preventDefault(),e._input.focus());break}}if(e.amPM!==void 0&&H===e.amPM)switch(U.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],C(),rt();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],C(),rt();break}(V||N(H))&&Oe("onKeyDown",U)}function ue(U,H){if(H===void 0&&(H="flatpickr-day"),!(e.selectedDates.length!==1||U&&(!U.classList.contains(H)||U.classList.contains("flatpickr-disabled")))){for(var V=U?U.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),q=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),te=Math.min(V,e.selectedDates[0].getTime()),re=Math.max(V,e.selectedDates[0].getTime()),fe=!1,se=0,he=0,ae=te;ae<re;ae+=au.DAY)K(new Date(ae),!0)||(fe=fe||ae>te&&ae<re,ae<q&&(!se||ae>se)?se=ae:ae>q&&(!he||ae<he)&&(he=ae));var le=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+H));le.forEach(function(ve){var et=ve.dateObj,We=et.getTime(),Pt=se>0&&We<se||he>0&&We>he;if(Pt){ve.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(At){ve.classList.remove(At)});return}else if(fe&&!Pt)return;["startRange","inRange","endRange","notAllowed"].forEach(function(At){ve.classList.remove(At)}),U!==void 0&&(U.classList.add(V<=e.selectedDates[0].getTime()?"startRange":"endRange"),q<V&&We===q?ve.classList.add("startRange"):q>V&&We===q&&ve.classList.add("endRange"),We>=se&&(he===0||We<=he)&&iu(We,q,V)&&ve.classList.add("inRange"))})}}function pe(){e.isOpen&&!e.config.static&&!e.config.inline&&Fe()}function ne(U,H){if(H===void 0&&(H=e._positionElement),e.isMobile===!0){if(U){U.preventDefault();var V=Ve(U);V&&V.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),Oe("onOpen");return}else if(e._input.disabled||e.config.inline)return;var q=e.isOpen;e.isOpen=!0,q||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),Oe("onOpen"),Fe(H)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(U===void 0||!e.timeContainer.contains(U.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function me(U){return function(H){var V=e.config["_"+U+"Date"]=e.parseDate(H,e.config.dateFormat),q=e.config["_"+(U==="min"?"max":"min")+"Date"];V!==void 0&&(e[U==="min"?"minDateHasTime":"maxDateHasTime"]=V.getHours()>0||V.getMinutes()>0||V.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(te){return K(te)}),!e.selectedDates.length&&U==="min"&&w(V),rt()),e.daysContainer&&(ft(),V!==void 0?e.currentYearElement[U]=V.getFullYear().toString():e.currentYearElement.removeAttribute(U),e.currentYearElement.disabled=!!q&&V!==void 0&&q.getFullYear()===V.getFullYear())}}function Te(){var U=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],H=Pe(Pe({},JSON.parse(JSON.stringify(r.dataset||{}))),t),V={};e.config.parseDate=H.parseDate,e.config.formatDate=H.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(le){e.config._enable=Q(le)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(le){e.config._disable=Q(le)}});var q=H.mode==="time";if(!H.dateFormat&&(H.enableTime||q)){var te=Re.defaultConfig.dateFormat||Rt.dateFormat;V.dateFormat=H.noCalendar||q?"H:i"+(H.enableSeconds?":S":""):te+" H:i"+(H.enableSeconds?":S":"")}if(H.altInput&&(H.enableTime||q)&&!H.altFormat){var re=Re.defaultConfig.altFormat||Rt.altFormat;V.altFormat=H.noCalendar||q?"h:i"+(H.enableSeconds?":S K":" K"):re+(" h:i"+(H.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:me("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:me("max")});var fe=function(le){return function(ve){e.config[le==="min"?"_minTime":"_maxTime"]=e.parseDate(ve,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:fe("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:fe("max")}),H.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,V,H);for(var se=0;se<U.length;se++)e.config[U[se]]=e.config[U[se]]===!0||e.config[U[se]]==="true";Kn.filter(function(le){return e.config[le]!==void 0}).forEach(function(le){e.config[le]=Jn(e.config[le]||[]).map(o)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var se=0;se<e.config.plugins.length;se++){var he=e.config.plugins[se](e)||{};for(var ae in he)Kn.indexOf(ae)>-1?e.config[ae]=Jn(he[ae]).map(o).concat(e.config[ae]):typeof H[ae]>"u"&&(e.config[ae]=he[ae])}H.altInputClass||(e.config.altInputClass=Me().className+" "+e.config.altInputClass),Oe("onParseConfig")}function Me(){return e.config.wrap?r.querySelector("[data-input]"):r}function we(){typeof e.config.locale!="object"&&typeof Re.l10ns[e.config.locale]>"u"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=Pe(Pe({},Re.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?Re.l10ns[e.config.locale]:void 0),vt.D="("+e.l10n.weekdays.shorthand.join("|")+")",vt.l="("+e.l10n.weekdays.longhand.join("|")+")",vt.M="("+e.l10n.months.shorthand.join("|")+")",vt.F="("+e.l10n.months.longhand.join("|")+")",vt.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var U=Pe(Pe({},t),JSON.parse(JSON.stringify(r.dataset||{})));U.time_24hr===void 0&&Re.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=oo(e),e.parseDate=mr({config:e.config,l10n:e.l10n})}function Fe(U){if(typeof e.config.position=="function")return void e.config.position(e,U);if(e.calendarContainer!==void 0){Oe("onPreCalendarPosition");var H=U||e._positionElement,V=Array.prototype.reduce.call(e.calendarContainer.children,function(No,Fo){return No+Fo.offsetHeight},0),q=e.calendarContainer.offsetWidth,te=e.config.position.split(" "),re=te[0],fe=te.length>1?te[1]:null,se=H.getBoundingClientRect(),he=window.innerHeight-se.bottom,ae=re==="above"||re!=="below"&&he<V&&se.top>V,le=window.pageYOffset+se.top+(ae?-V-2:H.offsetHeight+2);if(Le(e.calendarContainer,"arrowTop",!ae),Le(e.calendarContainer,"arrowBottom",ae),!e.config.inline){var ve=window.pageXOffset+se.left,et=!1,We=!1;fe==="center"?(ve-=(q-se.width)/2,et=!0):fe==="right"&&(ve-=q-se.width,We=!0),Le(e.calendarContainer,"arrowLeft",!et&&!We),Le(e.calendarContainer,"arrowCenter",et),Le(e.calendarContainer,"arrowRight",We);var Pt=window.document.body.offsetWidth-(window.pageXOffset+se.right),At=ve+q>window.document.body.offsetWidth,xo=Pt+q>window.document.body.offsetWidth;if(Le(e.calendarContainer,"rightMost",At),!e.config.static)if(e.calendarContainer.style.top=le+"px",!At)e.calendarContainer.style.left=ve+"px",e.calendarContainer.style.right="auto";else if(!xo)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=Pt+"px";else{var Hn=Ot();if(Hn===void 0)return;var Io=window.document.body.offsetWidth,Do=Math.max(0,Io/2-q/2),_o=".flatpickr-calendar.centerMost:before",Po=".flatpickr-calendar.centerMost:after",ko=Hn.cssRules.length,Lo="{left:"+se.left+"px;right:auto;}";Le(e.calendarContainer,"rightMost",!1),Le(e.calendarContainer,"centerMost",!0),Hn.insertRule(_o+","+Po+Lo,ko),e.calendarContainer.style.left=Do+"px",e.calendarContainer.style.right="auto"}}}}function Ot(){for(var U=null,H=0;H<document.styleSheets.length;H++){var V=document.styleSheets[H];if(V.cssRules){try{V.cssRules}catch{continue}U=V;break}}return U??$e()}function $e(){var U=document.createElement("style");return document.head.appendChild(U),U.sheet}function ft(){e.config.noCalendar||e.isMobile||(k(),Qt(),L())}function dt(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function wt(U){U.preventDefault(),U.stopPropagation();var H=function(le){return le.classList&&le.classList.contains("flatpickr-day")&&!le.classList.contains("flatpickr-disabled")&&!le.classList.contains("notAllowed")},V=ro(Ve(U),H);if(V!==void 0){var q=V,te=e.latestSelectedDateObj=new Date(q.dateObj.getTime()),re=(te.getMonth()<e.currentMonth||te.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=q,e.config.mode==="single")e.selectedDates=[te];else if(e.config.mode==="multiple"){var fe=Un(te);fe?e.selectedDates.splice(parseInt(fe),1):e.selectedDates.push(te)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=te,e.selectedDates.push(te),Ye(te,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(le,ve){return le.getTime()-ve.getTime()}));if(C(),re){var se=e.currentYear!==te.getFullYear();e.currentYear=te.getFullYear(),e.currentMonth=te.getMonth(),se&&(Oe("onYearChange"),k()),Oe("onMonthChange")}if(Qt(),L(),rt(),!re&&e.config.mode!=="range"&&e.config.showMonths===1?c(q):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var he=e.config.mode==="single"&&!e.config.enableTime,ae=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(he||ae)&&dt()}T()}}var St={locale:[we,F],showMonths:[I,u,P],minDate:[b],maxDate:[b],positionElement:[de],clickOpens:[function(){e.config.clickOpens===!0?(A(e._input,"focus",e.open),A(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function Fn(U,H){if(U!==null&&typeof U=="object"){Object.assign(e.config,U);for(var V in U)St[V]!==void 0&&St[V].forEach(function(q){return q()})}else e.config[U]=H,St[U]!==void 0?St[U].forEach(function(q){return q()}):Kn.indexOf(U)>-1&&(e.config[U]=Jn(H));e.redraw(),rt(!0)}function qt(U,H){var V=[];if(U instanceof Array)V=U.map(function(q){return e.parseDate(q,H)});else if(U instanceof Date||typeof U=="number")V=[e.parseDate(U,H)];else if(typeof U=="string")switch(e.config.mode){case"single":case"time":V=[e.parseDate(U,H)];break;case"multiple":V=U.split(e.config.conjunction).map(function(q){return e.parseDate(q,H)});break;case"range":V=U.split(e.l10n.rangeSeparator).map(function(q){return e.parseDate(q,H)});break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(U)));e.selectedDates=e.config.allowInvalidPreload?V:V.filter(function(q){return q instanceof Date&&K(q,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(q,te){return q.getTime()-te.getTime()})}function W(U,H,V){if(H===void 0&&(H=!1),V===void 0&&(V=e.config.dateFormat),U!==0&&!U||U instanceof Array&&U.length===0)return e.clear(H);qt(U,V),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),b(void 0,H),w(),e.selectedDates.length===0&&e.clear(!1),rt(H),H&&Oe("onChange")}function Q(U){return U.slice().map(function(H){return typeof H=="string"||typeof H=="number"||H instanceof Date?e.parseDate(H,void 0,!0):H&&typeof H=="object"&&H.from&&H.to?{from:e.parseDate(H.from,void 0),to:e.parseDate(H.to,void 0)}:H}).filter(function(H){return H})}function X(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var U=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);U&&qt(U,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function oe(){if(e.input=Me(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=ge(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),de()}function de(){e._positionElement=e.config.positionElement||e._input}function _e(){var U=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=ge("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=U,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=U==="datetime-local"?"Y-m-d\\TH:i:S":U==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch{}A(e.mobileInput,"change",function(H){e.setDate(Ve(H).value,!1,e.mobileFormatStr),Oe("onChange"),Oe("onClose")})}function ht(U){if(e.isOpen===!0)return e.close();e.open(U)}function Oe(U,H){if(e.config!==void 0){var V=e.config[U];if(V!==void 0&&V.length>0)for(var q=0;V[q]&&q<V.length;q++)V[q](e.selectedDates,e.input.value,e,H);U==="onChange"&&(e.input.dispatchEvent(jn("change")),e.input.dispatchEvent(jn("input")))}}function jn(U){var H=document.createEvent("Event");return H.initEvent(U,!0,!0),H}function Un(U){for(var H=0;H<e.selectedDates.length;H++){var V=e.selectedDates[H];if(V instanceof Date&&Ye(V,U)===0)return""+H}return!1}function To(U){return e.config.mode!=="range"||e.selectedDates.length<2?!1:Ye(U,e.selectedDates[0])>=0&&Ye(U,e.selectedDates[1])<=0}function Qt(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(U,H){var V=new Date(e.currentYear,e.currentMonth,1);V.setMonth(e.currentMonth+H),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[H].textContent=On(V.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=V.getMonth().toString(),U.value=V.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function Bn(U){var H=U||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(V){return e.formatDate(V,H)}).filter(function(V,q,te){return e.config.mode!=="range"||e.config.enableTime||te.indexOf(V)===q}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function rt(U){U===void 0&&(U=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=Bn(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=Bn(e.config.altFormat)),U!==!1&&Oe("onValueUpdate")}function Ro(U){var H=Ve(U),V=e.prevMonthNav.contains(H),q=e.nextMonthNav.contains(H);V||q?z(V?-1:1):e.yearElements.indexOf(H)>=0?H.select():H.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):H.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function Mo(U){U.preventDefault();var H=U.type==="keydown",V=Ve(U),q=V;e.amPM!==void 0&&V===e.amPM&&(e.amPM.textContent=e.l10n.amPM[Je(e.amPM.textContent===e.l10n.amPM[0])]);var te=parseFloat(q.getAttribute("min")),re=parseFloat(q.getAttribute("max")),fe=parseFloat(q.getAttribute("step")),se=parseInt(q.value,10),he=U.delta||(H?U.which===38?1:-1:0),ae=se+fe*he;if(typeof q.value<"u"&&q.value.length===2){var le=q===e.hourElement,ve=q===e.minuteElement;ae<te?(ae=re+ae+Je(!le)+(Je(le)&&Je(!e.amPM)),ve&&R(void 0,-1,e.hourElement)):ae>re&&(ae=q===e.hourElement?ae-re-Je(!e.amPM):te,ve&&R(void 0,1,e.hourElement)),e.amPM&&le&&(fe===1?ae+se===23:Math.abs(ae-se)>fe)&&(e.amPM.textContent=e.l10n.amPM[Je(e.amPM.textContent===e.l10n.amPM[0])]),q.value=Ue(ae)}}return i(),e}function Mt(r,t){for(var e=Array.prototype.slice.call(r).filter(function(o){return o instanceof HTMLElement}),n=[],i=0;i<e.length;i++){var a=e[i];try{if(a.getAttribute("data-fp-omit")!==null)continue;a._flatpickr!==void 0&&(a._flatpickr.destroy(),a._flatpickr=void 0),a._flatpickr=uu(a,t||{}),n.push(a._flatpickr)}catch(o){console.error(o)}}return n.length===1?n[0]:n}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(r){return Mt(this,r)},HTMLElement.prototype.flatpickr=function(r){return Mt([this],r)});var Re=function(r,t){return typeof r=="string"?Mt(window.document.querySelectorAll(r),t):r instanceof Node?Mt([r],t):Mt(r,t)};Re.defaultConfig={};Re.l10ns={en:Pe({},Wt),default:Pe({},Wt)};Re.localize=function(r){Re.l10ns.default=Pe(Pe({},Re.l10ns.default),r)};Re.setDefaults=function(r){Re.defaultConfig=Pe(Pe({},Re.defaultConfig),r)};Re.parseDate=mr({});Re.formatDate=oo({});Re.compareDates=Ye;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(r){return Mt(this,r)});Date.prototype.fp_incr=function(r){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof r=="string"?parseInt(r,10):r))};typeof window<"u"&&(window.flatpickr=Re);var ao={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Kt,function(){return function(e,n,i){e=e||{};var a=n.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function u(h,m,C,w){return a.fromToBase(h,m,C,w)}i.en.relativeTime=o,a.fromToBase=function(h,m,C,w,M){for(var l,A,T,x=C.$locale().relativeTime||o,b=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],y=b.length,R=0;R<y;R+=1){var p=b[R];p.d&&(l=w?i(h).diff(C,p.d,!0):C.diff(h,p.d,!0));var f=(e.rounding||Math.round)(Math.abs(l));if(T=l>0,f<=p.r||!p.r){f<=1&&R>0&&(p=b[R-1]);var c=x[p.l];M&&(f=M(""+f)),A=typeof c=="string"?c.replace("%d",f):c(f,m,p.l,T);break}}if(m)return A;var s=T?x.future:x.past;return typeof s=="function"?s(A):s.replace("%s",A)},a.to=function(h,m){return u(h,m,this,!0)},a.from=function(h,m){return u(h,m,this)};var d=function(h){return h.$u?i.utc():i()};a.toNow=function(h){return this.to(d(this),h)},a.fromNow=function(h){return this.from(d(this),h)}}})})(ao);var lu=ao.exports;const ff=Tr(lu);function Zn(r,t){r.split(/\s+/).forEach(e=>{t(e)})}class cu{constructor(){this._events={}}on(t,e){Zn(t,n=>{const i=this._events[n]||[];i.push(e),this._events[n]=i})}off(t,e){var n=arguments.length;if(n===0){this._events={};return}Zn(t,i=>{if(n===1){delete this._events[i];return}const a=this._events[i];a!==void 0&&(a.splice(a.indexOf(e),1),this._events[i]=a)})}trigger(t,...e){var n=this;Zn(t,i=>{const a=n._events[i];a!==void 0&&a.forEach(o=>{o.apply(n,e)})})}}function fu(r){return r.plugins={},class extends r{constructor(){super(...arguments),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(t,e){r.plugins[t]={name:t,fn:e}}initializePlugins(t){var e,n;const i=this,a=[];if(Array.isArray(t))t.forEach(o=>{typeof o=="string"?a.push(o):(i.plugins.settings[o.name]=o.options,a.push(o.name))});else if(t)for(e in t)t.hasOwnProperty(e)&&(i.plugins.settings[e]=t[e],a.push(e));for(;n=a.shift();)i.require(n)}loadPlugin(t){var e=this,n=e.plugins,i=r.plugins[t];if(!r.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');n.requested[t]=!0,n.loaded[t]=i.fn.apply(e,[e.plugins.settings[t]||{}]),n.names.push(t)}require(t){var e=this,n=e.plugins;if(!e.plugins.loaded.hasOwnProperty(t)){if(n.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');e.loadPlugin(t)}return n.loaded[t]}}}const Nn=r=>(r=r.filter(Boolean),r.length<2?r[0]||"":hu(r)==1?"["+r.join("")+"]":"(?:"+r.join("|")+")"),so=r=>{if(!du(r))return r.join("");let t="",e=0;const n=()=>{e>1&&(t+="{"+e+"}")};return r.forEach((i,a)=>{if(i===r[a-1]){e++;return}n(),t+=i,e=1}),n(),t},uo=r=>{let t=Array.from(r);return Nn(t)},du=r=>new Set(r).size!==r.length,Vt=r=>(r+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),hu=r=>r.reduce((t,e)=>Math.max(t,pu(e)),0),pu=r=>Array.from(r).length,lo=r=>{if(r.length===1)return[[r]];let t=[];const e=r.substring(1);return lo(e).forEach(function(i){let a=i.slice(0);a[0]=r.charAt(0)+a[0],t.push(a),a=i.slice(0),a.unshift(r.charAt(0)),t.push(a)}),t},gu=[[0,65535]],mu="[̀-ͯ·ʾʼ]";let wn,co;const vu=3,Rr={},Xr={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let r in Xr){let t=Xr[r]||"";for(let e=0;e<t.length;e++){let n=t.substring(e,e+1);Rr[n]=r}}const yu=new RegExp(Object.keys(Rr).join("|")+"|"+mu,"gu"),bu=r=>{wn===void 0&&(wn=Su(gu))},Zr=(r,t="NFKD")=>r.normalize(t),Sn=r=>Array.from(r).reduce((t,e)=>t+Cu(e),""),Cu=r=>(r=Zr(r).toLowerCase().replace(yu,t=>Rr[t]||""),Zr(r,"NFC"));function*Ou(r){for(const[t,e]of r)for(let n=t;n<=e;n++){let i=String.fromCharCode(n),a=Sn(i);a!=i.toLowerCase()&&(a.length>vu||a.length!=0&&(yield{folded:a,composed:i,code_point:n}))}}const wu=r=>{const t={},e=(n,i)=>{const a=t[n]||new Set,o=new RegExp("^"+uo(a)+"$","iu");i.match(o)||(a.add(Vt(i)),t[n]=a)};for(let n of Ou(r))e(n.folded,n.folded),e(n.folded,n.composed);return t},Su=r=>{const t=wu(r),e={};let n=[];for(let a in t){let o=t[a];o&&(e[a]=uo(o)),a.length>1&&n.push(Vt(a))}n.sort((a,o)=>o.length-a.length);const i=Nn(n);return co=new RegExp("^"+i,"u"),e},Au=(r,t=1)=>{let e=0;return r=r.map(n=>(wn[n]&&(e+=n.length),wn[n]||n)),e>=t?so(r):""},Eu=(r,t=1)=>(t=Math.max(t,r.length-1),Nn(lo(r).map(e=>Au(e,t)))),ei=(r,t=!0)=>{let e=r.length>1?1:0;return Nn(r.map(n=>{let i=[];const a=t?n.length():n.length()-1;for(let o=0;o<a;o++)i.push(Eu(n.substrs[o]||"",e));return so(i)}))},Tu=(r,t)=>{for(const e of t){if(e.start!=r.start||e.end!=r.end||e.substrs.join("")!==r.substrs.join(""))continue;let n=r.parts;const i=o=>{for(const u of n){if(u.start===o.start&&u.substr===o.substr)return!1;if(!(o.length==1||u.length==1)&&(o.start<u.start&&o.end>u.start||u.start<o.start&&u.end>o.start))return!0}return!1};if(!(e.parts.filter(i).length>0))return!0}return!1};class An{constructor(){pt(this,"parts");pt(this,"substrs");pt(this,"start");pt(this,"end");this.parts=[],this.substrs=[],this.start=0,this.end=0}add(t){t&&(this.parts.push(t),this.substrs.push(t.substr),this.start=Math.min(t.start,this.start),this.end=Math.max(t.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(t,e){let n=new An,i=JSON.parse(JSON.stringify(this.parts)),a=i.pop();for(const d of i)n.add(d);let o=e.substr.substring(0,t-a.start),u=o.length;return n.add({start:a.start,end:a.start+u,length:u,substr:o}),n}}const Ru=r=>{bu(),r=Sn(r);let t="",e=[new An];for(let n=0;n<r.length;n++){let a=r.substring(n).match(co);const o=r.substring(n,n+1),u=a?a[0]:null;let d=[],h=new Set;for(const m of e){const C=m.last();if(!C||C.length==1||C.end<=n)if(u){const w=u.length;m.add({start:n,end:n+w,length:w,substr:u}),h.add("1")}else m.add({start:n,end:n+1,length:1,substr:o}),h.add("2");else if(u){let w=m.clone(n,C);const M=u.length;w.add({start:n,end:n+M,length:M,substr:u}),d.push(w)}else h.add("3")}if(d.length>0){d=d.sort((m,C)=>m.length()-C.length());for(let m of d)Tu(m,e)||e.push(m);continue}if(n>0&&h.size==1&&!h.has("3")){t+=ei(e,!1);let m=new An;const C=e[0];C&&m.add(C.last()),e=[m]}}return t+=ei(e,!0),t},Mu=(r,t)=>{if(r)return r[t]},xu=(r,t)=>{if(r){for(var e,n=t.split(".");(e=n.shift())&&(r=r[e]););return r}},er=(r,t,e)=>{var n,i;return!r||(r=r+"",t.regex==null)||(i=r.search(t.regex),i===-1)?0:(n=t.string.length/r.length,i===0&&(n+=.5),n*e)},tr=(r,t)=>{var e=r[t];if(typeof e=="function")return e;e&&!Array.isArray(e)&&(r[t]=[e])},en=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},Iu=(r,t)=>typeof r=="number"&&typeof t=="number"?r>t?1:r<t?-1:0:(r=Sn(r+"").toLowerCase(),t=Sn(t+"").toLowerCase(),r>t?1:t>r?-1:0);class Du{constructor(t,e){pt(this,"items");pt(this,"settings");this.items=t,this.settings=e||{diacritics:!0}}tokenize(t,e,n){if(!t||!t.length)return[];const i=[],a=t.split(/\s+/);var o;return n&&(o=new RegExp("^("+Object.keys(n).map(Vt).join("|")+"):(.*)$")),a.forEach(u=>{let d,h=null,m=null;o&&(d=u.match(o))&&(h=d[1],u=d[2]),u.length>0&&(this.settings.diacritics?m=Ru(u)||null:m=Vt(u),m&&e&&(m="\\b"+m)),i.push({string:u,regex:m?new RegExp(m,"iu"):null,field:h})}),i}getScoreFunction(t,e){var n=this.prepareSearch(t,e);return this._getScoreFunction(n)}_getScoreFunction(t){const e=t.tokens,n=e.length;if(!n)return function(){return 0};const i=t.options.fields,a=t.weights,o=i.length,u=t.getAttrFn;if(!o)return function(){return 1};const d=function(){return o===1?function(h,m){const C=i[0].field;return er(u(m,C),h,a[C]||1)}:function(h,m){var C=0;if(h.field){const w=u(m,h.field);!h.regex&&w?C+=1/o:C+=er(w,h,1)}else en(a,(w,M)=>{C+=er(u(m,M),h,w)});return C/o}}();return n===1?function(h){return d(e[0],h)}:t.options.conjunction==="and"?function(h){var m,C=0;for(let w of e){if(m=d(w,h),m<=0)return 0;C+=m}return C/n}:function(h){var m=0;return en(e,C=>{m+=d(C,h)}),m/n}}getSortFunction(t,e){var n=this.prepareSearch(t,e);return this._getSortFunction(n)}_getSortFunction(t){var e,n=[];const i=this,a=t.options,o=!t.query&&a.sort_empty?a.sort_empty:a.sort;if(typeof o=="function")return o.bind(this);const u=function(h,m){return h==="$score"?m.score:t.getAttrFn(i.items[m.id],h)};if(o)for(let h of o)(t.query||h.field!=="$score")&&n.push(h);if(t.query){e=!0;for(let h of n)if(h.field==="$score"){e=!1;break}e&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter(h=>h.field!=="$score");return n.length?function(h,m){var C,w;for(let M of n)if(w=M.field,C=(M.direction==="desc"?-1:1)*Iu(u(w,h),u(w,m)),C)return C;return 0}:null}prepareSearch(t,e){const n={};var i=Object.assign({},e);if(tr(i,"sort"),tr(i,"sort_empty"),i.fields){tr(i,"fields");const a=[];i.fields.forEach(o=>{typeof o=="string"&&(o={field:o,weight:1}),a.push(o),n[o.field]="weight"in o?o.weight:1}),i.fields=a}return{options:i,query:t.toLowerCase().trim(),tokens:this.tokenize(t,i.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:i.nesting?xu:Mu}}search(t,e){var n=this,i,a;a=this.prepareSearch(t,e),e=a.options,t=a.query;const o=e.score||n._getScoreFunction(a);t.length?en(n.items,(d,h)=>{i=o(d),(e.filter===!1||i>0)&&a.items.push({score:i,id:h})}):en(n.items,(d,h)=>{a.items.push({score:1,id:h})});const u=n._getSortFunction(a);return u&&a.items.sort(u),a.total=a.items.length,typeof e.limit=="number"&&(a.items=a.items.slice(0,e.limit)),a}}const Xe=r=>typeof r>"u"||r===null?null:gn(r),gn=r=>typeof r=="boolean"?r?"1":"0":r+"",nr=r=>(r+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),_u=(r,t)=>t>0?window.setTimeout(r,t):(r.call(null),null),Pu=(r,t)=>{var e;return function(n,i){var a=this;e&&(a.loading=Math.max(a.loading-1,0),clearTimeout(e)),e=setTimeout(function(){e=null,a.loadedSearches[n]=!0,r.call(a,n,i)},t)}},ti=(r,t,e)=>{var n,i=r.trigger,a={};r.trigger=function(){var o=arguments[0];if(t.indexOf(o)!==-1)a[o]=arguments;else return i.apply(r,arguments)},e.apply(r,[]),r.trigger=i;for(n of t)n in a&&i.apply(r,a[n])},ku=r=>({start:r.selectionStart||0,length:(r.selectionEnd||0)-(r.selectionStart||0)}),Se=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},Ne=(r,t,e,n)=>{r.addEventListener(t,e,n)},gt=(r,t)=>{if(!t||!t[r])return!1;var e=(t.altKey?1:0)+(t.ctrlKey?1:0)+(t.shiftKey?1:0)+(t.metaKey?1:0);return e===1},rr=(r,t)=>{const e=r.getAttribute("id");return e||(r.setAttribute("id",t),t)},ni=r=>r.replace(/[\\"']/g,"\\$&"),mt=(r,t)=>{t&&r.append(t)},xe=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},nt=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(fo(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},fo=r=>typeof r=="string"&&r.indexOf("<")>-1,Lu=r=>r.replace(/['"\\]/g,"\\$&"),ir=(r,t)=>{var e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!1),r.dispatchEvent(e)},tn=(r,t)=>{Object.assign(r.style,t)},ze=(r,...t)=>{var e=ho(t);r=po(r),r.map(n=>{e.map(i=>{n.classList.add(i)})})},st=(r,...t)=>{var e=ho(t);r=po(r),r.map(n=>{e.map(i=>{n.classList.remove(i)})})},ho=r=>{var t=[];return xe(r,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},po=r=>(Array.isArray(r)||(r=[r]),r),or=(r,t,e)=>{if(!(e&&!e.contains(r)))for(;r&&r.matches;){if(r.matches(t))return r;r=r.parentNode}},ri=(r,t=0)=>t>0?r[r.length-1]:r[0],Nu=r=>Object.keys(r).length===0,ii=(r,t)=>{if(!r)return-1;t=t||r.nodeName;for(var e=0;r=r.previousElementSibling;)r.matches(t)&&e++;return e},ye=(r,t)=>{xe(t,(e,n)=>{e==null?r.removeAttribute(n):r.setAttribute(n,""+e)})},vr=(r,t)=>{r.parentNode&&r.parentNode.replaceChild(t,r)},Fu=(r,t)=>{if(t===null)return;if(typeof t=="string"){if(!t.length)return;t=new RegExp(t,"i")}const e=a=>{var o=a.data.match(t);if(o&&a.data.length>0){var u=document.createElement("span");u.className="highlight";var d=a.splitText(o.index);d.splitText(o[0].length);var h=d.cloneNode(!0);return u.appendChild(h),vr(d,u),1}return 0},n=a=>{a.nodeType===1&&a.childNodes&&!/(script|style)/i.test(a.tagName)&&(a.className!=="highlight"||a.tagName!=="SPAN")&&Array.from(a.childNodes).forEach(o=>{i(o)})},i=a=>a.nodeType===3?e(a):(n(a),0);i(r)},ju=r=>{var t=r.querySelectorAll("span.highlight");Array.prototype.forEach.call(t,function(e){var n=e.parentNode;n.replaceChild(e.firstChild,e),n.normalize()})},Uu=65,Bu=13,Hu=27,Gu=37,$u=38,Wu=39,Vu=40,oi=8,zu=46,ai=9,Yu=typeof navigator>"u"?!1:/Mac/.test(navigator.userAgent),nn=Yu?"metaKey":"ctrlKey",si={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,refreshThrottle:300,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(r){return r.length>0},render:{}};function ui(r,t){var e=Object.assign({},si,t),n=e.dataAttr,i=e.labelField,a=e.valueField,o=e.disabledField,u=e.optgroupField,d=e.optgroupLabelField,h=e.optgroupValueField,m=r.tagName.toLowerCase(),C=r.getAttribute("placeholder")||r.getAttribute("data-placeholder");if(!C&&!e.allowEmptyOption){let A=r.querySelector('option[value=""]');A&&(C=A.textContent)}var w={placeholder:C,options:[],optgroups:[],items:[],maxItems:null},M=()=>{var A,T=w.options,x={},b=1;let y=0;var R=c=>{var s=Object.assign({},c.dataset),v=n&&s[n];return typeof v=="string"&&v.length&&(s=Object.assign(s,JSON.parse(v))),s},p=(c,s)=>{var v=Xe(c.value);if(v!=null&&!(!v&&!e.allowEmptyOption)){if(x.hasOwnProperty(v)){if(s){var g=x[v][u];g?Array.isArray(g)?g.push(s):x[v][u]=[g,s]:x[v][u]=s}}else{var S=R(c);S[i]=S[i]||c.textContent,S[a]=S[a]||v,S[o]=S[o]||c.disabled,S[u]=S[u]||s,S.$option=c,S.$order=S.$order||++y,x[v]=S,T.push(S)}c.selected&&w.items.push(v)}},f=c=>{var s,v;v=R(c),v[d]=v[d]||c.getAttribute("label")||"",v[h]=v[h]||b++,v[o]=v[o]||c.disabled,v.$order=v.$order||++y,w.optgroups.push(v),s=v[h],xe(c.children,g=>{p(g,s)})};w.maxItems=r.hasAttribute("multiple")?null:1,xe(r.children,c=>{A=c.tagName.toLowerCase(),A==="optgroup"?f(c):A==="option"&&p(c)})},l=()=>{const A=r.getAttribute(n);if(A)w.options=JSON.parse(A),xe(w.options,x=>{w.items.push(x[a])});else{var T=r.value.trim()||"";if(!e.allowEmptyOption&&!T.length)return;const x=T.split(e.delimiter);xe(x,b=>{const y={};y[i]=b,y[a]=b,w.options.push(y)}),w.items=x}};return m==="select"?M():l(),Object.assign({},si,w,t)}var li=0;class Ge extends fu(cu){constructor(t,e){super(),this.order=0,this.isOpen=!1,this.isDisabled=!1,this.isReadOnly=!1,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],this.refreshTimeout=null,li++;var n,i=nt(t);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this;var a=window.getComputedStyle&&window.getComputedStyle(i,null);n=a.getPropertyValue("direction");const o=ui(i,e);this.settings=o,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag=i.tagName.toLowerCase()==="select",this.rtl=/rtl/i.test(n),this.inputId=rr(i,"tomselect-"+li),this.isRequired=i.required,this.sifter=new Du(this.options,{diacritics:o.diacritics}),o.mode=o.mode||(o.maxItems===1?"single":"multi"),typeof o.hideSelected!="boolean"&&(o.hideSelected=o.mode==="multi"),typeof o.hidePlaceholder!="boolean"&&(o.hidePlaceholder=o.mode!=="multi");var u=o.createFilter;typeof u!="function"&&(typeof u=="string"&&(u=new RegExp(u)),u instanceof RegExp?o.createFilter=T=>u.test(T):o.createFilter=T=>this.settings.duplicates||!this.options[T]),this.initializePlugins(o.plugins),this.setupCallbacks(),this.setupTemplates();const d=nt("<div>"),h=nt("<div>"),m=this._render("dropdown"),C=nt('<div role="listbox" tabindex="-1">'),w=this.input.getAttribute("class")||"",M=o.mode;var l;if(ze(d,o.wrapperClass,w,M),ze(h,o.controlClass),mt(d,h),ze(m,o.dropdownClass,M),o.copyClassesToDropdown&&ze(m,w),ze(C,o.dropdownContentClass),mt(m,C),nt(o.dropdownParent||d).appendChild(m),fo(o.controlInput)){l=nt(o.controlInput);var A=["autocorrect","autocapitalize","autocomplete","spellcheck"];xe(A,T=>{i.getAttribute(T)&&ye(l,{[T]:i.getAttribute(T)})}),l.tabIndex=-1,h.appendChild(l),this.focus_node=l}else o.controlInput?(l=nt(o.controlInput),this.focus_node=l):(l=nt("<input/>"),this.focus_node=h);this.wrapper=d,this.dropdown=m,this.dropdown_content=C,this.control=h,this.control_input=l,this.setup()}setup(){const t=this,e=t.settings,n=t.control_input,i=t.dropdown,a=t.dropdown_content,o=t.wrapper,u=t.control,d=t.input,h=t.focus_node,m={passive:!0},C=t.inputId+"-ts-dropdown";ye(a,{id:C}),ye(h,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":C});const w=rr(h,t.inputId+"-ts-control"),M="label[for='"+Lu(t.inputId)+"']",l=document.querySelector(M),A=t.focus.bind(t);if(l){Ne(l,"click",A),ye(l,{for:w});const b=rr(l,t.inputId+"-ts-label");ye(h,{"aria-labelledby":b}),ye(a,{"aria-labelledby":b})}if(o.style.width=d.style.width,t.plugins.names.length){const b="plugin-"+t.plugins.names.join(" plugin-");ze([o,i],b)}(e.maxItems===null||e.maxItems>1)&&t.is_select_tag&&ye(d,{multiple:"multiple"}),e.placeholder&&ye(n,{placeholder:e.placeholder}),!e.splitOn&&e.delimiter&&(e.splitOn=new RegExp("\\s*"+Vt(e.delimiter)+"+\\s*")),e.load&&e.loadThrottle&&(e.load=Pu(e.load,e.loadThrottle)),Ne(i,"mousemove",()=>{t.ignoreHover=!1}),Ne(i,"mouseenter",b=>{var y=or(b.target,"[data-selectable]",i);y&&t.onOptionHover(b,y)},{capture:!0}),Ne(i,"click",b=>{const y=or(b.target,"[data-selectable]");y&&(t.onOptionSelect(b,y),Se(b,!0))}),Ne(u,"click",b=>{var y=or(b.target,"[data-ts-item]",u);if(y&&t.onItemSelect(b,y)){Se(b,!0);return}n.value==""&&(t.onClick(),Se(b,!0))}),Ne(h,"keydown",b=>t.onKeyDown(b)),Ne(n,"keypress",b=>t.onKeyPress(b)),Ne(n,"input",b=>t.onInput(b)),Ne(h,"blur",b=>t.onBlur(b)),Ne(h,"focus",b=>t.onFocus(b)),Ne(n,"paste",b=>t.onPaste(b));const T=b=>{const y=b.composedPath()[0];if(!o.contains(y)&&!i.contains(y)){t.isFocused&&t.blur(),t.inputState();return}y==n&&t.isOpen?b.stopPropagation():Se(b,!0)},x=()=>{t.isOpen&&t.positionDropdown()};Ne(document,"mousedown",T),Ne(window,"scroll",x,m),Ne(window,"resize",x,m),this._destroy=()=>{document.removeEventListener("mousedown",T),window.removeEventListener("scroll",x),window.removeEventListener("resize",x),l&&l.removeEventListener("click",A)},this.revertSettings={innerHTML:d.innerHTML,tabIndex:d.tabIndex},d.tabIndex=-1,d.insertAdjacentElement("afterend",t.wrapper),t.sync(!1),e.items=[],delete e.optgroups,delete e.options,Ne(d,"invalid",()=>{t.isValid&&(t.isValid=!1,t.isInvalid=!0,t.refreshState())}),t.updateOriginalInput(),t.refreshItems(),t.close(!1),t.inputState(),t.isSetup=!0,d.disabled?t.disable():d.readOnly?t.setReadOnly(!0):t.enable(),t.on("change",this.onChange),ze(d,"tomselected","ts-hidden-accessible"),t.trigger("initialize"),e.preload===!0&&t.preload()}setupOptions(t=[],e=[]){this.addOptions(t),xe(e,n=>{this.registerOptionGroup(n)})}setupTemplates(){var t=this,e=t.settings.labelField,n=t.settings.optgroupLabelField,i={optgroup:a=>{let o=document.createElement("div");return o.className="optgroup",o.appendChild(a.options),o},optgroup_header:(a,o)=>'<div class="optgroup-header">'+o(a[n])+"</div>",option:(a,o)=>"<div>"+o(a[e])+"</div>",item:(a,o)=>"<div>"+o(a[e])+"</div>",option_create:(a,o)=>'<div class="create">Add <strong>'+o(a.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};t.settings.render=Object.assign({},i,t.settings.render)}setupCallbacks(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)e=this.settings[n[t]],e&&this.on(t,e)}sync(t=!0){const e=this,n=t?ui(e.input,{delimiter:e.settings.delimiter}):e.settings;e.setupOptions(n.options,n.optgroups),e.setValue(n.items||[],!0),e.lastQuery=null}onClick(){var t=this;if(t.activeItems.length>0){t.clearActiveItems(),t.focus();return}t.isFocused&&t.isOpen?t.blur():t.focus()}onMouseDown(){}onChange(){ir(this.input,"input"),ir(this.input,"change")}onPaste(t){var e=this;if(e.isInputHidden||e.isLocked){Se(t);return}e.settings.splitOn&&setTimeout(()=>{var n=e.inputValue();if(n.match(e.settings.splitOn)){var i=n.trim().split(e.settings.splitOn);xe(i,a=>{Xe(a)&&(this.options[a]?e.addItem(a):e.createItem(a))})}},0)}onKeyPress(t){var e=this;if(e.isLocked){Se(t);return}var n=String.fromCharCode(t.keyCode||t.which);if(e.settings.create&&e.settings.mode==="multi"&&n===e.settings.delimiter){e.createItem(),Se(t);return}}onKeyDown(t){var e=this;if(e.ignoreHover=!0,e.isLocked){t.keyCode!==ai&&Se(t);return}switch(t.keyCode){case Uu:if(gt(nn,t)&&e.control_input.value==""){Se(t),e.selectAll();return}break;case Hu:e.isOpen&&(Se(t,!0),e.close()),e.clearActiveItems();return;case Vu:if(!e.isOpen&&e.hasOptions)e.open();else if(e.activeOption){let n=e.getAdjacent(e.activeOption,1);n&&e.setActiveOption(n)}Se(t);return;case $u:if(e.activeOption){let n=e.getAdjacent(e.activeOption,-1);n&&e.setActiveOption(n)}Se(t);return;case Bu:e.canSelect(e.activeOption)?(e.onOptionSelect(t,e.activeOption),Se(t)):(e.settings.create&&e.createItem()||document.activeElement==e.control_input&&e.isOpen)&&Se(t);return;case Gu:e.advanceSelection(-1,t);return;case Wu:e.advanceSelection(1,t);return;case ai:e.settings.selectOnTab&&(e.canSelect(e.activeOption)&&(e.onOptionSelect(t,e.activeOption),Se(t)),e.settings.create&&e.createItem()&&Se(t));return;case oi:case zu:e.deleteSelection(t);return}e.isInputHidden&&!gt(nn,t)&&Se(t)}onInput(t){if(this.isLocked)return;const e=this.inputValue();if(this.lastValue!==e){if(this.lastValue=e,e==""){this._onInput();return}this.refreshTimeout&&window.clearTimeout(this.refreshTimeout),this.refreshTimeout=_u(()=>{this.refreshTimeout=null,this._onInput()},this.settings.refreshThrottle)}}_onInput(){const t=this.lastValue;this.settings.shouldLoad.call(this,t)&&this.load(t),this.refreshOptions(),this.trigger("type",t)}onOptionHover(t,e){this.ignoreHover||this.setActiveOption(e,!1)}onFocus(t){var e=this,n=e.isFocused;if(e.isDisabled||e.isReadOnly){e.blur(),Se(t);return}e.ignoreFocus||(e.isFocused=!0,e.settings.preload==="focus"&&e.preload(),n||e.trigger("focus"),e.activeItems.length||(e.inputState(),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())}onBlur(t){if(document.hasFocus()!==!1){var e=this;if(e.isFocused){e.isFocused=!1,e.ignoreFocus=!1;var n=()=>{e.close(),e.setActiveItem(),e.setCaret(e.items.length),e.trigger("blur")};e.settings.create&&e.settings.createOnBlur?e.createItem(null,n):n()}}}onOptionSelect(t,e){var n,i=this;e.parentElement&&e.parentElement.matches("[data-disabled]")||(e.classList.contains("create")?i.createItem(null,()=>{i.settings.closeAfterSelect&&i.close()}):(n=e.dataset.value,typeof n<"u"&&(i.lastQuery=null,i.addItem(n),i.settings.closeAfterSelect&&i.close(),!i.settings.hideSelected&&t.type&&/click/.test(t.type)&&i.setActiveOption(e))))}canSelect(t){return!!(this.isOpen&&t&&this.dropdown_content.contains(t))}onItemSelect(t,e){var n=this;return!n.isLocked&&n.settings.mode==="multi"?(Se(t),n.setActiveItem(e,t),!0):!1}canLoad(t){return!(!this.settings.load||this.loadedSearches.hasOwnProperty(t))}load(t){const e=this;if(!e.canLoad(t))return;ze(e.wrapper,e.settings.loadingClass),e.loading++;const n=e.loadCallback.bind(e);e.settings.load.call(e,t,n)}loadCallback(t,e){const n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(t,e),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||st(n.wrapper,n.settings.loadingClass),n.trigger("load",t,e)}preload(){var t=this.wrapper.classList;t.contains("preloaded")||(t.add("preloaded"),this.load(""))}setTextboxValue(t=""){var e=this.control_input,n=e.value!==t;n&&(e.value=t,ir(e,"update"),this.lastValue=t)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(t,e){var n=e?[]:["change"];ti(this,n,()=>{this.clear(e),this.addItems(t,e)})}setMaxItems(t){t===0&&(t=null),this.settings.maxItems=t,this.refreshState()}setActiveItem(t,e){var n=this,i,a,o,u,d,h;if(n.settings.mode!=="single"){if(!t){n.clearActiveItems(),n.isFocused&&n.inputState();return}if(i=e&&e.type.toLowerCase(),i==="click"&&gt("shiftKey",e)&&n.activeItems.length){for(h=n.getLastActive(),o=Array.prototype.indexOf.call(n.control.children,h),u=Array.prototype.indexOf.call(n.control.children,t),o>u&&(d=o,o=u,u=d),a=o;a<=u;a++)t=n.control.children[a],n.activeItems.indexOf(t)===-1&&n.setActiveItemClass(t);Se(e)}else i==="click"&&gt(nn,e)||i==="keydown"&&gt("shiftKey",e)?t.classList.contains("active")?n.removeActiveItem(t):n.setActiveItemClass(t):(n.clearActiveItems(),n.setActiveItemClass(t));n.inputState(),n.isFocused||n.focus()}}setActiveItemClass(t){const e=this,n=e.control.querySelector(".last-active");n&&st(n,"last-active"),ze(t,"active last-active"),e.trigger("item_select",t),e.activeItems.indexOf(t)==-1&&e.activeItems.push(t)}removeActiveItem(t){var e=this.activeItems.indexOf(t);this.activeItems.splice(e,1),st(t,"active")}clearActiveItems(){st(this.activeItems,"active"),this.activeItems=[]}setActiveOption(t,e=!0){t!==this.activeOption&&(this.clearActiveOption(),t&&(this.activeOption=t,ye(this.focus_node,{"aria-activedescendant":t.getAttribute("id")}),ye(t,{"aria-selected":"true"}),ze(t,"active"),e&&this.scrollToOption(t)))}scrollToOption(t,e){if(!t)return;const n=this.dropdown_content,i=n.clientHeight,a=n.scrollTop||0,o=t.offsetHeight,u=t.getBoundingClientRect().top-n.getBoundingClientRect().top+a;u+o>i+a?this.scroll(u-i+o,e):u<a&&this.scroll(u,e)}scroll(t,e){const n=this.dropdown_content;e&&(n.style.scrollBehavior=e),n.scrollTop=t,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(st(this.activeOption,"active"),ye(this.activeOption,{"aria-selected":null})),this.activeOption=null,ye(this.focus_node,{"aria-activedescendant":null})}selectAll(){const t=this;if(t.settings.mode==="single")return;const e=t.controlChildren();e.length&&(t.inputState(),t.close(),t.activeItems=e,xe(e,n=>{t.setActiveItemClass(n)}))}inputState(){var t=this;t.control.contains(t.control_input)&&(ye(t.control_input,{placeholder:t.settings.placeholder}),t.activeItems.length>0||!t.isFocused&&t.settings.hidePlaceholder&&t.items.length>0?(t.setTextboxValue(),t.isInputHidden=!0):(t.settings.hidePlaceholder&&t.items.length>0&&ye(t.control_input,{placeholder:""}),t.isInputHidden=!1),t.wrapper.classList.toggle("input-hidden",t.isInputHidden))}inputValue(){return this.control_input.value.trim()}focus(){var t=this;t.isDisabled||t.isReadOnly||(t.ignoreFocus=!0,t.control_input.offsetWidth?t.control_input.focus():t.focus_node.focus(),setTimeout(()=>{t.ignoreFocus=!1,t.onFocus()},0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())}getSearchOptions(){var t=this.settings,e=t.sortField;return typeof t.sortField=="string"&&(e=[{field:t.sortField}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}}search(t){var e,n,i=this,a=this.getSearchOptions();if(i.settings.score&&(n=i.settings.score.call(i,t),typeof n!="function"))throw new Error('Tom Select "score" setting must be a function that returns a function');return t!==i.lastQuery?(i.lastQuery=t,e=i.sifter.search(t,Object.assign(a,{score:n})),i.currentResults=e):e=Object.assign({},i.currentResults),i.settings.hideSelected&&(e.items=e.items.filter(o=>{let u=Xe(o.id);return!(u&&i.items.indexOf(u)!==-1)})),e}refreshOptions(t=!0){var e,n,i,a,o,u,d,h,m,C;const w={},M=[];var l=this,A=l.inputValue();const T=A===l.lastQuery||A==""&&l.lastQuery==null;var x=l.search(A),b=null,y=l.settings.shouldOpen||!1,R=l.dropdown_content;T&&(b=l.activeOption,b&&(m=b.closest("[data-group]"))),a=x.items.length,typeof l.settings.maxOptions=="number"&&(a=Math.min(a,l.settings.maxOptions)),a>0&&(y=!0);const p=(c,s)=>{let v=w[c];if(v!==void 0){let S=M[v];if(S!==void 0)return[v,S.fragment]}let g=document.createDocumentFragment();return v=M.length,M.push({fragment:g,order:s,optgroup:c}),[v,g]};for(e=0;e<a;e++){let c=x.items[e];if(!c)continue;let s=c.id,v=l.options[s];if(v===void 0)continue;let g=gn(s),S=l.getOption(g,!0);for(l.settings.hideSelected||S.classList.toggle("selected",l.items.includes(g)),o=v[l.settings.optgroupField]||"",u=Array.isArray(o)?o:[o],n=0,i=u&&u.length;n<i;n++){o=u[n];let L=v.$order,k=l.optgroups[o];k===void 0?o="":L=k.$order;const[_,I]=p(o,L);n>0&&(S=S.cloneNode(!0),ye(S,{id:v.$id+"-clone-"+n,"aria-selected":null}),S.classList.add("ts-cloned"),st(S,"active"),l.activeOption&&l.activeOption.dataset.value==s&&m&&m.dataset.group===o.toString()&&(b=S)),I.appendChild(S),o!=""&&(w[o]=_)}}l.settings.lockOptgroupOrder&&M.sort((c,s)=>c.order-s.order),d=document.createDocumentFragment(),xe(M,c=>{let s=c.fragment,v=c.optgroup;if(!s||!s.children.length)return;let g=l.optgroups[v];if(g!==void 0){let S=document.createDocumentFragment(),L=l.render("optgroup_header",g);mt(S,L),mt(S,s);let k=l.render("optgroup",{group:g,options:S});mt(d,k)}else mt(d,s)}),R.innerHTML="",mt(R,d),l.settings.highlight&&(ju(R),x.query.length&&x.tokens.length&&xe(x.tokens,c=>{Fu(R,c.regex)}));var f=c=>{let s=l.render(c,{input:A});return s&&(y=!0,R.insertBefore(s,R.firstChild)),s};if(l.loading?f("loading"):l.settings.shouldLoad.call(l,A)?x.items.length===0&&f("no_results"):f("not_loading"),h=l.canCreate(A),h&&(C=f("option_create")),l.hasOptions=x.items.length>0||h,y){if(x.items.length>0){if(!b&&l.settings.mode==="single"&&l.items[0]!=null&&(b=l.getOption(l.items[0])),!R.contains(b)){let c=0;C&&!l.settings.addPrecedence&&(c=1),b=l.selectable()[c]}}else C&&(b=C);t&&!l.isOpen&&(l.open(),l.scrollToOption(b,"auto")),l.setActiveOption(b)}else l.clearActiveOption(),t&&l.isOpen&&l.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(t,e=!1){const n=this;if(Array.isArray(t))return n.addOptions(t,e),!1;const i=Xe(t[n.settings.valueField]);return i===null||n.options.hasOwnProperty(i)?!1:(t.$order=t.$order||++n.order,t.$id=n.inputId+"-opt-"+t.$order,n.options[i]=t,n.lastQuery=null,e&&(n.userOptions[i]=e,n.trigger("option_add",i,t)),i)}addOptions(t,e=!1){xe(t,n=>{this.addOption(n,e)})}registerOption(t){return this.addOption(t)}registerOptionGroup(t){var e=Xe(t[this.settings.optgroupValueField]);return e===null?!1:(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)}addOptionGroup(t,e){var n;e[this.settings.optgroupValueField]=t,(n=this.registerOptionGroup(e))&&this.trigger("optgroup_add",n,e)}removeOptionGroup(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.clearCache(),this.trigger("optgroup_remove",t))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(t,e){const n=this;var i,a;const o=Xe(t),u=Xe(e[n.settings.valueField]);if(o===null)return;const d=n.options[o];if(d==null)return;if(typeof u!="string")throw new Error("Value must be set in option data");const h=n.getOption(o),m=n.getItem(o);if(e.$order=e.$order||d.$order,delete n.options[o],n.uncacheValue(u),n.options[u]=e,h){if(n.dropdown_content.contains(h)){const C=n._render("option",e);vr(h,C),n.activeOption===h&&n.setActiveOption(C)}h.remove()}m&&(a=n.items.indexOf(o),a!==-1&&n.items.splice(a,1,u),i=n._render("item",e),m.classList.contains("active")&&ze(i,"active"),vr(m,i)),n.lastQuery=null}removeOption(t,e){const n=this;t=gn(t),n.uncacheValue(t),delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)}clearOptions(t){const e=(t||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();const n={};xe(this.options,(i,a)=>{e(i,a)&&(n[a]=i)}),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(t,e){return this.items.indexOf(e)>=0}getOption(t,e=!1){const n=Xe(t);if(n===null)return null;const i=this.options[n];if(i!=null){if(i.$div)return i.$div;if(e)return this._render("option",i)}return null}getAdjacent(t,e,n="option"){var i=this,a;if(!t)return null;n=="item"?a=i.controlChildren():a=i.dropdown_content.querySelectorAll("[data-selectable]");for(let o=0;o<a.length;o++)if(a[o]==t)return e>0?a[o+1]:a[o-1];return null}getItem(t){if(typeof t=="object")return t;var e=Xe(t);return e!==null?this.control.querySelector(`[data-value="${ni(e)}"]`):null}addItems(t,e){var n=this,i=Array.isArray(t)?t:[t];i=i.filter(o=>n.items.indexOf(o)===-1);const a=i[i.length-1];i.forEach(o=>{n.isPending=o!==a,n.addItem(o,e)})}addItem(t,e){var n=e?[]:["change","dropdown_close"];ti(this,n,()=>{var i,a;const o=this,u=o.settings.mode,d=Xe(t);if(!(d&&o.items.indexOf(d)!==-1&&(u==="single"&&o.close(),u==="single"||!o.settings.duplicates))&&!(d===null||!o.options.hasOwnProperty(d))&&(u==="single"&&o.clear(e),!(u==="multi"&&o.isFull()))){if(i=o._render("item",o.options[d]),o.control.contains(i)&&(i=i.cloneNode(!0)),a=o.isFull(),o.items.splice(o.caretPos,0,d),o.insertAtCaret(i),o.isSetup){if(!o.isPending&&o.settings.hideSelected){let h=o.getOption(d),m=o.getAdjacent(h,1);m&&o.setActiveOption(m)}!o.isPending&&!o.settings.closeAfterSelect&&o.refreshOptions(o.isFocused&&u!=="single"),o.settings.closeAfterSelect!=!1&&o.isFull()?o.close():o.isPending||o.positionDropdown(),o.trigger("item_add",d,i),o.isPending||o.updateOriginalInput({silent:e})}(!o.isPending||!a&&o.isFull())&&(o.inputState(),o.refreshState())}})}removeItem(t=null,e){const n=this;if(t=n.getItem(t),!t)return;var i,a;const o=t.dataset.value;i=ii(t),t.remove(),t.classList.contains("active")&&(a=n.activeItems.indexOf(t),n.activeItems.splice(a,1),st(t,"active")),n.items.splice(i,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(o)&&n.removeOption(o,e),i<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:e}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",o,t)}createItem(t=null,e=()=>{}){arguments.length===3&&(e=arguments[2]),typeof e!="function"&&(e=()=>{});var n=this,i=n.caretPos,a;if(t=t||n.inputValue(),!n.canCreate(t))return e(),!1;n.lock();var o=!1,u=d=>{if(n.unlock(),!d||typeof d!="object")return e();var h=Xe(d[n.settings.valueField]);if(typeof h!="string")return e();n.setTextboxValue(),n.addOption(d,!0),n.setCaret(i),n.addItem(h),e(d),o=!0};return typeof n.settings.create=="function"?a=n.settings.create.call(this,t,u):a={[n.settings.labelField]:t,[n.settings.valueField]:t},o||u(a),!0}refreshItems(){var t=this;t.lastQuery=null,t.isSetup&&t.addItems(t.items),t.updateOriginalInput(),t.refreshState()}refreshState(){const t=this;t.refreshValidityState();const e=t.isFull(),n=t.isLocked;t.wrapper.classList.toggle("rtl",t.rtl);const i=t.wrapper.classList;i.toggle("focus",t.isFocused),i.toggle("disabled",t.isDisabled),i.toggle("readonly",t.isReadOnly),i.toggle("required",t.isRequired),i.toggle("invalid",!t.isValid),i.toggle("locked",n),i.toggle("full",e),i.toggle("input-active",t.isFocused&&!t.isInputHidden),i.toggle("dropdown-active",t.isOpen),i.toggle("has-options",Nu(t.options)),i.toggle("has-items",t.items.length>0)}refreshValidityState(){var t=this;t.input.validity&&(t.isValid=t.input.validity.valid,t.isInvalid=!t.isValid)}isFull(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems}updateOriginalInput(t={}){const e=this;var n,i;const a=e.input.querySelector('option[value=""]');if(e.is_select_tag){let d=function(h,m,C){return h||(h=nt('<option value="'+nr(m)+'">'+nr(C)+"</option>")),h!=a&&e.input.append(h),o.push(h),(h!=a||u>0)&&(h.selected=!0),h};const o=[],u=e.input.querySelectorAll("option:checked").length;e.input.querySelectorAll("option:checked").forEach(h=>{h.selected=!1}),e.items.length==0&&e.settings.mode=="single"?d(a,"",""):e.items.forEach(h=>{if(n=e.options[h],i=n[e.settings.labelField]||"",o.includes(n.$option)){const m=e.input.querySelector(`option[value="${ni(h)}"]:not(:checked)`);d(m,h,i)}else n.$option=d(n.$option,h,i)})}else e.input.value=e.getValue();e.isSetup&&(t.silent||e.trigger("change",e.getValue()))}open(){var t=this;t.isLocked||t.isOpen||t.settings.mode==="multi"&&t.isFull()||(t.isOpen=!0,ye(t.focus_node,{"aria-expanded":"true"}),t.refreshState(),tn(t.dropdown,{visibility:"hidden",display:"block"}),t.positionDropdown(),tn(t.dropdown,{visibility:"visible",display:"block"}),t.focus(),t.trigger("dropdown_open",t.dropdown))}close(t=!0){var e=this,n=e.isOpen;t&&(e.setTextboxValue(),e.settings.mode==="single"&&e.items.length&&e.inputState()),e.isOpen=!1,ye(e.focus_node,{"aria-expanded":"false"}),tn(e.dropdown,{display:"none"}),e.settings.hideSelected&&e.clearActiveOption(),e.refreshState(),n&&e.trigger("dropdown_close",e.dropdown)}positionDropdown(){if(this.settings.dropdownParent==="body"){var t=this.control,e=t.getBoundingClientRect(),n=t.offsetHeight+e.top+window.scrollY,i=e.left+window.scrollX;tn(this.dropdown,{width:e.width+"px",top:n+"px",left:i+"px"})}}clear(t){var e=this;if(e.items.length){var n=e.controlChildren();xe(n,i=>{e.removeItem(i,!0)}),e.inputState(),t||e.updateOriginalInput(),e.trigger("clear")}}insertAtCaret(t){const e=this,n=e.caretPos,i=e.control;i.insertBefore(t,i.children[n]||null),e.setCaret(n+1)}deleteSelection(t){var e,n,i,a,o=this;e=t&&t.keyCode===oi?-1:1,n=ku(o.control_input);const u=[];if(o.activeItems.length)a=ri(o.activeItems,e),i=ii(a),e>0&&i++,xe(o.activeItems,d=>u.push(d));else if((o.isFocused||o.settings.mode==="single")&&o.items.length){const d=o.controlChildren();let h;e<0&&n.start===0&&n.length===0?h=d[o.caretPos-1]:e>0&&n.start===o.inputValue().length&&(h=d[o.caretPos]),h!==void 0&&u.push(h)}if(!o.shouldDelete(u,t))return!1;for(Se(t,!0),typeof i<"u"&&o.setCaret(i);u.length;)o.removeItem(u.pop());return o.inputState(),o.positionDropdown(),o.refreshOptions(!1),!0}shouldDelete(t,e){const n=t.map(i=>i.dataset.value);return!(!n.length||typeof this.settings.onDelete=="function"&&this.settings.onDelete(n,e)===!1)}advanceSelection(t,e){var n,i,a=this;a.rtl&&(t*=-1),!a.inputValue().length&&(gt(nn,e)||gt("shiftKey",e)?(n=a.getLastActive(t),n?n.classList.contains("active")?i=a.getAdjacent(n,t,"item"):i=n:t>0?i=a.control_input.nextElementSibling:i=a.control_input.previousElementSibling,i&&(i.classList.contains("active")&&a.removeActiveItem(n),a.setActiveItemClass(i))):a.moveCaret(t))}moveCaret(t){}getLastActive(t){let e=this.control.querySelector(".last-active");if(e)return e;var n=this.control.querySelectorAll(".active");if(n)return ri(n,t)}setCaret(t){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.setLocked(!0)}unlock(){this.setLocked(!1)}setLocked(t=this.isReadOnly||this.isDisabled){this.isLocked=t,this.refreshState()}disable(){this.setDisabled(!0),this.close()}enable(){this.setDisabled(!1)}setDisabled(t){this.focus_node.tabIndex=t?-1:this.tabIndex,this.isDisabled=t,this.input.disabled=t,this.control_input.disabled=t,this.setLocked()}setReadOnly(t){this.isReadOnly=t,this.input.readOnly=t,this.control_input.readOnly=t,this.setLocked()}destroy(){var t=this,e=t.revertSettings;t.trigger("destroy"),t.off(),t.wrapper.remove(),t.dropdown.remove(),t.input.innerHTML=e.innerHTML,t.input.tabIndex=e.tabIndex,st(t.input,"tomselected","ts-hidden-accessible"),t._destroy(),delete t.input.tomselect}render(t,e){var n,i;const a=this;if(typeof this.settings.render[t]!="function"||(i=a.settings.render[t].call(this,e,nr),!i))return null;if(i=nt(i),t==="option"||t==="option_create"?e[a.settings.disabledField]?ye(i,{"aria-disabled":"true"}):ye(i,{"data-selectable":""}):t==="optgroup"&&(n=e.group[a.settings.optgroupValueField],ye(i,{"data-group":n}),e.group[a.settings.disabledField]&&ye(i,{"data-disabled":""})),t==="option"||t==="item"){const o=gn(e[a.settings.valueField]);ye(i,{"data-value":o}),t==="item"?(ze(i,a.settings.itemClass),ye(i,{"data-ts-item":""})):(ze(i,a.settings.optionClass),ye(i,{role:"option",id:e.$id}),e.$div=i,a.options[o]=e)}return i}_render(t,e){const n=this.render(t,e);if(n==null)throw"HTMLElement expected";return n}clearCache(){xe(this.options,t=>{t.$div&&(t.$div.remove(),delete t.$div)})}uncacheValue(t){const e=this.getOption(t);e&&e.remove()}canCreate(t){return this.settings.create&&t.length>0&&this.settings.createFilter.call(this,t)}hook(t,e,n){var i=this,a=i[e];i[e]=function(){var o,u;return t==="after"&&(o=a.apply(i,arguments)),u=n.apply(i,arguments),t==="instead"?u:(t==="before"&&(o=a.apply(i,arguments)),o)}}}const Ku=(r,t,e,n)=>{r.addEventListener(t,e,n)};function Ju(){Ku(this.input,"change",()=>{this.sync()})}const qu=r=>typeof r>"u"||r===null?null:Qu(r),Qu=r=>typeof r=="boolean"?r?"1":"0":r+"",ci=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},Xu=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(Zu(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},Zu=r=>typeof r=="string"&&r.indexOf("<")>-1;function el(r){var t=this,e=t.onOptionSelect;t.settings.hideSelected=!1;const n=Object.assign({className:"tomselect-checkbox",checkedClassNames:void 0,uncheckedClassNames:void 0},r);var i=function(u,d){d?(u.checked=!0,n.uncheckedClassNames&&u.classList.remove(...n.uncheckedClassNames),n.checkedClassNames&&u.classList.add(...n.checkedClassNames)):(u.checked=!1,n.checkedClassNames&&u.classList.remove(...n.checkedClassNames),n.uncheckedClassNames&&u.classList.add(...n.uncheckedClassNames))},a=function(u){setTimeout(()=>{var d=u.querySelector("input."+n.className);d instanceof HTMLInputElement&&i(d,u.classList.contains("selected"))},1)};t.hook("after","setupTemplates",()=>{var o=t.settings.render.option;t.settings.render.option=(u,d)=>{var h=Xu(o.call(t,u,d)),m=document.createElement("input");n.className&&m.classList.add(n.className),m.addEventListener("click",function(w){ci(w)}),m.type="checkbox";const C=qu(u[t.settings.valueField]);return i(m,!!(C&&t.items.indexOf(C)>-1)),h.prepend(m),h}}),t.on("item_remove",o=>{var u=t.getOption(o);u&&(u.classList.remove("selected"),a(u))}),t.on("item_add",o=>{var u=t.getOption(o);u&&a(u)}),t.hook("instead","onOptionSelect",(o,u)=>{if(u.classList.contains("selected")){u.classList.remove("selected"),t.removeItem(u.dataset.value),t.refreshOptions(),ci(o,!0);return}e.call(t,o,u),a(u)})}const tl=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(nl(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},nl=r=>typeof r=="string"&&r.indexOf("<")>-1;function rl(r){const t=this,e=Object.assign({className:"clear-button",title:"Clear All",html:n=>`<div class="${n.className}" title="${n.title}">&#10799;</div>`},r);t.on("initialize",()=>{var n=tl(e.html(e));n.addEventListener("click",i=>{t.isLocked||(t.clear(),t.settings.mode==="single"&&t.settings.allowEmptyOption&&t.addItem(""),i.preventDefault(),i.stopPropagation())}),t.control.appendChild(n)})}const il=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},Et=(r,t,e,n)=>{r.addEventListener(t,e,n)},ol=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},al=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(sl(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},sl=r=>typeof r=="string"&&r.indexOf("<")>-1,ul=(r,t)=>{ol(t,(e,n)=>{e==null?r.removeAttribute(n):r.setAttribute(n,""+e)})},ll=(r,t)=>{var e;(e=r.parentNode)==null||e.insertBefore(t,r.nextSibling)},cl=(r,t)=>{var e;(e=r.parentNode)==null||e.insertBefore(t,r)},fl=(r,t)=>{do{var e;if(t=(e=t)==null?void 0:e.previousElementSibling,r==t)return!0}while(t&&t.previousElementSibling);return!1};function dl(){var r=this;if(r.settings.mode!=="multi")return;var t=r.lock,e=r.unlock;let n=!0,i;r.hook("after","setupTemplates",()=>{var a=r.settings.render.item;r.settings.render.item=(o,u)=>{const d=al(a.call(r,o,u));ul(d,{draggable:"true"});const h=A=>{n||il(A),A.stopPropagation()},m=A=>{i=d,setTimeout(()=>{d.classList.add("ts-dragging")},0)},C=A=>{A.preventDefault(),d.classList.add("ts-drag-over"),M(d,i)},w=()=>{d.classList.remove("ts-drag-over")},M=(A,T)=>{T!==void 0&&(fl(T,d)?ll(A,T):cl(A,T))},l=()=>{var A;document.querySelectorAll(".ts-drag-over").forEach(x=>x.classList.remove("ts-drag-over")),(A=i)==null||A.classList.remove("ts-dragging"),i=void 0;var T=[];r.control.querySelectorAll("[data-value]").forEach(x=>{if(x.dataset.value){let b=x.dataset.value;b&&T.push(b)}}),r.setValue(T)};return Et(d,"mousedown",h),Et(d,"dragstart",m),Et(d,"dragenter",C),Et(d,"dragover",C),Et(d,"dragleave",w),Et(d,"dragend",l),d}}),r.hook("instead","lock",()=>(n=!1,t.call(r))),r.hook("instead","unlock",()=>(n=!0,e.call(r)))}const hl=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},pl=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(gl(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},gl=r=>typeof r=="string"&&r.indexOf("<")>-1;function ml(r){const t=this,e=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:n=>'<div class="'+n.headerClass+'"><div class="'+n.titleRowClass+'"><span class="'+n.labelClass+'">'+n.title+'</span><a class="'+n.closeClass+'">&times;</a></div></div>'},r);t.on("initialize",()=>{var n=pl(e.html(e)),i=n.querySelector("."+e.closeClass);i&&i.addEventListener("click",a=>{hl(a,!0),t.close()}),t.dropdown.insertBefore(n,t.dropdown.firstChild)})}const vl=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},yl=(r,...t)=>{var e=bl(t);r=Cl(r),r.map(n=>{e.map(i=>{n.classList.remove(i)})})},bl=r=>{var t=[];return vl(r,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},Cl=r=>(Array.isArray(r)||(r=[r]),r),Ol=(r,t)=>{if(!r)return-1;t=t||r.nodeName;for(var e=0;r=r.previousElementSibling;)r.matches(t)&&e++;return e};function wl(){var r=this;r.hook("instead","setCaret",t=>{r.settings.mode==="single"||!r.control.contains(r.control_input)?t=r.items.length:(t=Math.max(0,Math.min(r.items.length,t)),t!=r.caretPos&&!r.isPending&&r.controlChildren().forEach((e,n)=>{n<t?r.control_input.insertAdjacentElement("beforebegin",e):r.control.appendChild(e)})),r.caretPos=t}),r.hook("instead","moveCaret",t=>{if(!r.isFocused)return;const e=r.getLastActive(t);if(e){const n=Ol(e);r.setCaret(t>0?n+1:n),r.setActiveItem(),yl(e,"last-active")}else r.setCaret(r.caretPos+t)})}const Sl=27,Al=9,El=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},Tl=(r,t,e,n)=>{r.addEventListener(t,e,n)},Rl=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},fi=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(Ml(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},Ml=r=>typeof r=="string"&&r.indexOf("<")>-1,xl=(r,...t)=>{var e=Il(t);r=Dl(r),r.map(n=>{e.map(i=>{n.classList.add(i)})})},Il=r=>{var t=[];return Rl(r,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},Dl=r=>(Array.isArray(r)||(r=[r]),r);function _l(){const r=this;r.settings.shouldOpen=!0,r.hook("before","setup",()=>{r.focus_node=r.control,xl(r.control_input,"dropdown-input");const t=fi('<div class="dropdown-input-wrap">');t.append(r.control_input),r.dropdown.insertBefore(t,r.dropdown.firstChild);const e=fi('<input class="items-placeholder" tabindex="-1" />');e.placeholder=r.settings.placeholder||"",r.control.append(e)}),r.on("initialize",()=>{r.control_input.addEventListener("keydown",e=>{switch(e.keyCode){case Sl:r.isOpen&&(El(e,!0),r.close()),r.clearActiveItems();return;case Al:r.focus_node.tabIndex=-1;break}return r.onKeyDown.call(r,e)}),r.on("blur",()=>{r.focus_node.tabIndex=r.isDisabled?-1:r.tabIndex}),r.on("dropdown_open",()=>{r.control_input.focus()});const t=r.onBlur;r.hook("instead","onBlur",e=>{if(!(e&&e.relatedTarget==r.control_input))return t.call(r)}),Tl(r.control_input,"blur",()=>r.onBlur()),r.hook("before","close",()=>{r.isOpen&&r.focus_node.focus({preventScroll:!0})})})}const rn=(r,t,e,n)=>{r.addEventListener(t,e,n)};function Pl(){var r=this;r.on("initialize",()=>{var t=document.createElement("span"),e=r.control_input;t.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",r.wrapper.appendChild(t);var n=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"];for(const a of n)t.style[a]=e.style[a];var i=()=>{t.textContent=e.value,e.style.width=t.clientWidth+"px"};i(),r.on("update item_add item_remove",i),rn(e,"input",i),rn(e,"keyup",i),rn(e,"blur",i),rn(e,"update",i)})}function kl(){var r=this,t=r.deleteSelection;this.hook("instead","deleteSelection",e=>r.activeItems.length?t.call(r,e):!1)}function Ll(){this.hook("instead","setActiveItem",()=>{}),this.hook("instead","selectAll",()=>{})}const di=37,Nl=39,Fl=(r,t,e)=>{for(;r&&r.matches;){if(r.matches(t))return r;r=r.parentNode}},jl=(r,t)=>{if(!r)return-1;t=t||r.nodeName;for(var e=0;r=r.previousElementSibling;)r.matches(t)&&e++;return e};function Ul(){var r=this,t=r.onKeyDown;r.hook("instead","onKeyDown",e=>{var n,i,a,o;if(!r.isOpen||!(e.keyCode===di||e.keyCode===Nl))return t.call(r,e);r.ignoreHover=!0,o=Fl(r.activeOption,"[data-group]"),n=jl(r.activeOption,"[data-selectable]"),o&&(e.keyCode===di?o=o.previousSibling:o=o.nextSibling,o&&(a=o.querySelectorAll("[data-selectable]"),i=a[Math.min(a.length-1,n)],i&&r.setActiveOption(i)))})}const Bl=r=>(r+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),hi=(r,t=!1)=>{r&&(r.preventDefault(),t&&r.stopPropagation())},pi=(r,t,e,n)=>{r.addEventListener(t,e,n)},gi=r=>{if(r.jquery)return r[0];if(r instanceof HTMLElement)return r;if(Hl(r)){var t=document.createElement("template");return t.innerHTML=r.trim(),t.content.firstChild}return document.querySelector(r)},Hl=r=>typeof r=="string"&&r.indexOf("<")>-1;function Gl(r){const t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},r);var e=this;if(t.append){var n='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+Bl(t.title)+'">'+t.label+"</a>";e.hook("after","setupTemplates",()=>{var i=e.settings.render.item;e.settings.render.item=(a,o)=>{var u=gi(i.call(e,a,o)),d=gi(n);return u.appendChild(d),pi(d,"mousedown",h=>{hi(h,!0)}),pi(d,"click",h=>{e.isLocked||(hi(h,!0),!e.isLocked&&e.shouldDelete([u],h)&&(e.removeItem(u),e.refreshOptions(!1),e.inputState()))}),u}})}}function $l(r){const t=this,e=Object.assign({text:n=>n[t.settings.labelField]},r);t.on("item_remove",function(n){if(t.isFocused&&t.control_input.value.trim()===""){var i=t.options[n];i&&t.setTextboxValue(e.text.call(t,i))}})}const Wl=(r,t)=>{if(Array.isArray(r))r.forEach(t);else for(var e in r)r.hasOwnProperty(e)&&t(r[e],e)},Vl=(r,...t)=>{var e=zl(t);r=Yl(r),r.map(n=>{e.map(i=>{n.classList.add(i)})})},zl=r=>{var t=[];return Wl(r,e=>{typeof e=="string"&&(e=e.trim().split(/[\t\n\f\r\s]/)),Array.isArray(e)&&(t=t.concat(e))}),t.filter(Boolean)},Yl=r=>(Array.isArray(r)||(r=[r]),r);function Kl(){const r=this,t=r.canLoad,e=r.clearActiveOption,n=r.loadCallback;var i={},a,o=!1,u,d=[];if(r.settings.shouldLoadMore||(r.settings.shouldLoadMore=()=>{if(a.clientHeight/(a.scrollHeight-a.scrollTop)>.9)return!0;if(r.activeOption){var w=r.selectable(),M=Array.from(w).indexOf(r.activeOption);if(M>=w.length-2)return!0}return!1}),!r.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";r.settings.sortField=[{field:"$order"},{field:"$score"}];const h=C=>typeof r.settings.maxOptions=="number"&&a.children.length>=r.settings.maxOptions?!1:!!(C in i&&i[C]),m=(C,w)=>r.items.indexOf(w)>=0||d.indexOf(w)>=0;r.setNextUrl=(C,w)=>{i[C]=w},r.getUrl=C=>{if(C in i){const w=i[C];return i[C]=!1,w}return r.clearPagination(),r.settings.firstUrl.call(r,C)},r.clearPagination=()=>{i={}},r.hook("instead","clearActiveOption",()=>{if(!o)return e.call(r)}),r.hook("instead","canLoad",C=>C in i?h(C):t.call(r,C)),r.hook("instead","loadCallback",(C,w)=>{if(!o)r.clearOptions(m);else if(u){const M=C[0];M!==void 0&&(u.dataset.value=M[r.settings.valueField])}n.call(r,C,w),o=!1}),r.hook("after","refreshOptions",()=>{const C=r.lastValue;var w;h(C)?(w=r.render("loading_more",{query:C}),w&&(w.setAttribute("data-selectable",""),u=w)):C in i&&!a.querySelector(".no-results")&&(w=r.render("no_more_results",{query:C})),w&&(Vl(w,r.settings.optionClass),a.append(w))}),r.on("initialize",()=>{d=Object.keys(r.options),a=r.dropdown_content,r.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},r.settings.render),a.addEventListener("scroll",()=>{r.settings.shouldLoadMore.call(r)&&h(r.lastValue)&&(o||(o=!0,r.load.call(r,r.lastValue)))})})}Ge.define("change_listener",Ju);Ge.define("checkbox_options",el);Ge.define("clear_button",rl);Ge.define("drag_drop",dl);Ge.define("dropdown_header",ml);Ge.define("caret_position",wl);Ge.define("dropdown_input",_l);Ge.define("input_autogrow",Pl);Ge.define("no_backspace_delete",kl);Ge.define("no_active_items",Ll);Ge.define("optgroup_columns",Ul);Ge.define("remove_button",Gl);Ge.define("restore_on_backspace",$l);Ge.define("virtual_scroll",Kl);var Jl={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Kt,function(){const e=(u,d)=>{if(Array.isArray(u))u.forEach(d);else for(var h in u)u.hasOwnProperty(h)&&d(u[h],h)},n=(u,...d)=>{var h=i(d);u=a(u),u.map(m=>{h.map(C=>{m.classList.add(C)})})},i=u=>{var d=[];return e(u,h=>{typeof h=="string"&&(h=h.trim().split(/[\t\n\f\r\s]/)),Array.isArray(h)&&(d=d.concat(h))}),d.filter(Boolean)},a=u=>(Array.isArray(u)||(u=[u]),u);function o(){const u=this,d=u.canLoad,h=u.clearActiveOption,m=u.loadCallback;var C={},w,M=!1,l,A=[];if(u.settings.shouldLoadMore||(u.settings.shouldLoadMore=()=>{if(w.clientHeight/(w.scrollHeight-w.scrollTop)>.9)return!0;if(u.activeOption){var y=u.selectable(),R=Array.from(y).indexOf(u.activeOption);if(R>=y.length-2)return!0}return!1}),!u.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";u.settings.sortField=[{field:"$order"},{field:"$score"}];const T=b=>typeof u.settings.maxOptions=="number"&&w.children.length>=u.settings.maxOptions?!1:!!(b in C&&C[b]),x=(b,y)=>u.items.indexOf(y)>=0||A.indexOf(y)>=0;u.setNextUrl=(b,y)=>{C[b]=y},u.getUrl=b=>{if(b in C){const y=C[b];return C[b]=!1,y}return u.clearPagination(),u.settings.firstUrl.call(u,b)},u.clearPagination=()=>{C={}},u.hook("instead","clearActiveOption",()=>{if(!M)return h.call(u)}),u.hook("instead","canLoad",b=>b in C?T(b):d.call(u,b)),u.hook("instead","loadCallback",(b,y)=>{if(!M)u.clearOptions(x);else if(l){const R=b[0];R!==void 0&&(l.dataset.value=R[u.settings.valueField])}m.call(u,b,y),M=!1}),u.hook("after","refreshOptions",()=>{const b=u.lastValue;var y;T(b)?(y=u.render("loading_more",{query:b}),y&&(y.setAttribute("data-selectable",""),l=y)):b in C&&!w.querySelector(".no-results")&&(y=u.render("no_more_results",{query:b})),y&&(n(y,u.settings.optionClass),w.append(y))}),u.on("initialize",()=>{A=Object.keys(u.options),w=u.dropdown_content,u.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},u.settings.render),w.addEventListener("scroll",()=>{u.settings.shouldLoadMore.call(u)&&T(u.lastValue)&&(M||(M=!0,u.load.call(u,u.lastValue)))})})}return o})})(Jl);var ql={exports:{}};(function(r,t){(function(e,n){r.exports=n()})(Kt,function(){const i=(u,d,h)=>{for(;u&&u.matches;){if(u.matches(d))return u;u=u.parentNode}},a=(u,d)=>{if(!u)return-1;d=d||u.nodeName;for(var h=0;u=u.previousElementSibling;)u.matches(d)&&h++;return h};function o(){var u=this,d=u.onKeyDown;u.hook("instead","onKeyDown",h=>{var m,C,w,M;if(!u.isOpen||!(h.keyCode===37||h.keyCode===39))return d.call(u,h);u.ignoreHover=!0,M=i(u.activeOption,"[data-group]"),m=a(u.activeOption,"[data-selectable]"),M&&(h.keyCode===37?M=M.previousSibling:M=M.nextSibling,M&&(w=M.querySelectorAll("[data-selectable]"),C=w[Math.min(w.length-1,m)],C&&u.setActiveOption(C)))})}return o})})(ql);/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Jt(r){return r+.5|0}const lt=(r,t,e)=>Math.max(Math.min(r,e),t);function Nt(r){return lt(Jt(r*2.55),0,255)}function ct(r){return lt(Jt(r*255),0,255)}function it(r){return lt(Jt(r/2.55)/100,0,1)}function mi(r){return lt(Jt(r*100),0,100)}const Ke={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},yr=[..."0123456789ABCDEF"],Ql=r=>yr[r&15],Xl=r=>yr[(r&240)>>4]+yr[r&15],on=r=>(r&240)>>4===(r&15),Zl=r=>on(r.r)&&on(r.g)&&on(r.b)&&on(r.a);function ec(r){var t=r.length,e;return r[0]==="#"&&(t===4||t===5?e={r:255&Ke[r[1]]*17,g:255&Ke[r[2]]*17,b:255&Ke[r[3]]*17,a:t===5?Ke[r[4]]*17:255}:(t===7||t===9)&&(e={r:Ke[r[1]]<<4|Ke[r[2]],g:Ke[r[3]]<<4|Ke[r[4]],b:Ke[r[5]]<<4|Ke[r[6]],a:t===9?Ke[r[7]]<<4|Ke[r[8]]:255})),e}const tc=(r,t)=>r<255?t(r):"";function nc(r){var t=Zl(r)?Ql:Xl;return r?"#"+t(r.r)+t(r.g)+t(r.b)+tc(r.a,t):void 0}const rc=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function go(r,t,e){const n=t*Math.min(e,1-e),i=(a,o=(a+r/30)%12)=>e-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function ic(r,t,e){const n=(i,a=(i+r/60)%6)=>e-e*t*Math.max(Math.min(a,4-a,1),0);return[n(5),n(3),n(1)]}function oc(r,t,e){const n=go(r,1,.5);let i;for(t+e>1&&(i=1/(t+e),t*=i,e*=i),i=0;i<3;i++)n[i]*=1-t-e,n[i]+=t;return n}function ac(r,t,e,n,i){return r===i?(t-e)/n+(t<e?6:0):t===i?(e-r)/n+2:(r-t)/n+4}function Mr(r){const e=r.r/255,n=r.g/255,i=r.b/255,a=Math.max(e,n,i),o=Math.min(e,n,i),u=(a+o)/2;let d,h,m;return a!==o&&(m=a-o,h=u>.5?m/(2-a-o):m/(a+o),d=ac(e,n,i,m,a),d=d*60+.5),[d|0,h||0,u]}function xr(r,t,e,n){return(Array.isArray(t)?r(t[0],t[1],t[2]):r(t,e,n)).map(ct)}function Ir(r,t,e){return xr(go,r,t,e)}function sc(r,t,e){return xr(oc,r,t,e)}function uc(r,t,e){return xr(ic,r,t,e)}function mo(r){return(r%360+360)%360}function lc(r){const t=rc.exec(r);let e=255,n;if(!t)return;t[5]!==n&&(e=t[6]?Nt(+t[5]):ct(+t[5]));const i=mo(+t[2]),a=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=sc(i,a,o):t[1]==="hsv"?n=uc(i,a,o):n=Ir(i,a,o),{r:n[0],g:n[1],b:n[2],a:e}}function cc(r,t){var e=Mr(r);e[0]=mo(e[0]+t),e=Ir(e),r.r=e[0],r.g=e[1],r.b=e[2]}function fc(r){if(!r)return;const t=Mr(r),e=t[0],n=mi(t[1]),i=mi(t[2]);return r.a<255?`hsla(${e}, ${n}%, ${i}%, ${it(r.a)})`:`hsl(${e}, ${n}%, ${i}%)`}const vi={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},yi={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function dc(){const r={},t=Object.keys(yi),e=Object.keys(vi);let n,i,a,o,u;for(n=0;n<t.length;n++){for(o=u=t[n],i=0;i<e.length;i++)a=e[i],u=u.replace(a,vi[a]);a=parseInt(yi[o],16),r[u]=[a>>16&255,a>>8&255,a&255]}return r}let an;function hc(r){an||(an=dc(),an.transparent=[0,0,0,0]);const t=an[r.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const pc=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function gc(r){const t=pc.exec(r);let e=255,n,i,a;if(t){if(t[7]!==n){const o=+t[7];e=t[8]?Nt(o):lt(o*255,0,255)}return n=+t[1],i=+t[3],a=+t[5],n=255&(t[2]?Nt(n):lt(n,0,255)),i=255&(t[4]?Nt(i):lt(i,0,255)),a=255&(t[6]?Nt(a):lt(a,0,255)),{r:n,g:i,b:a,a:e}}}function mc(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${it(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const ar=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,Tt=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function vc(r,t,e){const n=Tt(it(r.r)),i=Tt(it(r.g)),a=Tt(it(r.b));return{r:ct(ar(n+e*(Tt(it(t.r))-n))),g:ct(ar(i+e*(Tt(it(t.g))-i))),b:ct(ar(a+e*(Tt(it(t.b))-a))),a:r.a+e*(t.a-r.a)}}function sn(r,t,e){if(r){let n=Mr(r);n[t]=Math.max(0,Math.min(n[t]+n[t]*e,t===0?360:1)),n=Ir(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function vo(r,t){return r&&Object.assign(t||{},r)}function bi(r){var t={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(t={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(t.a=ct(r[3]))):(t=vo(r,{r:0,g:0,b:0,a:1}),t.a=ct(t.a)),t}function yc(r){return r.charAt(0)==="r"?gc(r):lc(r)}class br{constructor(t){if(t instanceof br)return t;const e=typeof t;let n;e==="object"?n=bi(t):e==="string"&&(n=ec(t)||hc(t)||yc(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=vo(this._rgb);return t&&(t.a=it(t.a)),t}set rgb(t){this._rgb=bi(t)}rgbString(){return this._valid?mc(this._rgb):void 0}hexString(){return this._valid?nc(this._rgb):void 0}hslString(){return this._valid?fc(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let a;const o=e===a?.5:e,u=2*o-1,d=n.a-i.a,h=((u*d===-1?u:(u+d)/(1+u*d))+1)/2;a=1-h,n.r=255&h*n.r+a*i.r+.5,n.g=255&h*n.g+a*i.g+.5,n.b=255&h*n.b+a*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=vc(this._rgb,t._rgb,e)),this}clone(){return new br(this.rgb)}alpha(t){return this._rgb.a=ct(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Jt(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return sn(this._rgb,2,t),this}darken(t){return sn(this._rgb,2,-t),this}saturate(t){return sn(this._rgb,1,t),this}desaturate(t){return sn(this._rgb,1,-t),this}rotate(t){return cc(this._rgb,t),this}}/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Ci=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var r=window.screen;if(r)return(r.deviceXDPI||1)/(r.logicalXDPI||1)}return 1}(),Ut={toTextLines:function(r){var t=[],e;for(r=[].concat(r);r.length;)e=r.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?r.push.apply(r,e):Ft(r)||t.unshift(""+e);return t},textSize:function(r,t,e){var n=[].concat(t),i=n.length,a=r.font,o=0,u;for(r.font=e.string,u=0;u<i;++u)o=Math.max(r.measureText(n[u]).width,o);return r.font=a,{height:i*e.lineHeight,width:o}},bound:function(r,t,e){return Math.max(r,Math.min(t,e))},arrayDiff:function(r,t){var e=r.slice(),n=[],i,a,o,u;for(i=0,o=t.length;i<o;++i)u=t[i],a=e.indexOf(u),a===-1?n.push([u,1]):e.splice(a,1);for(i=0,o=e.length;i<o;++i)n.push([e[i],-1]);return n},rasterize:function(r){return Math.round(r*Ci)/Ci}};function sr(r,t){var e=t.x,n=t.y;if(e===null)return{x:0,y:-1};if(n===null)return{x:1,y:0};var i=r.x-e,a=r.y-n,o=Math.sqrt(i*i+a*a);return{x:o?i/o:0,y:o?a/o:-1}}function bc(r,t,e,n,i){switch(i){case"center":e=n=0;break;case"bottom":e=0,n=1;break;case"right":e=1,n=0;break;case"left":e=-1,n=0;break;case"top":e=0,n=-1;break;case"start":e=-e,n=-n;break;case"end":break;default:i*=Math.PI/180,e=Math.cos(i),n=Math.sin(i);break}return{x:r,y:t,vx:e,vy:n}}var Cc=0,yo=1,bo=2,Co=4,Oo=8;function un(r,t,e){var n=Cc;return r<e.left?n|=yo:r>e.right&&(n|=bo),t<e.top?n|=Oo:t>e.bottom&&(n|=Co),n}function Oc(r,t){for(var e=r.x0,n=r.y0,i=r.x1,a=r.y1,o=un(e,n,t),u=un(i,a,t),d,h,m;!(!(o|u)||o&u);)d=o||u,d&Oo?(h=e+(i-e)*(t.top-n)/(a-n),m=t.top):d&Co?(h=e+(i-e)*(t.bottom-n)/(a-n),m=t.bottom):d&bo?(m=n+(a-n)*(t.right-e)/(i-e),h=t.right):d&yo&&(m=n+(a-n)*(t.left-e)/(i-e),h=t.left),d===o?(e=h,n=m,o=un(e,n,t)):(i=h,a=m,u=un(i,a,t));return{x0:e,x1:i,y0:n,y1:a}}function ln(r,t){var e=t.anchor,n=r,i,a;return t.clamp&&(n=Oc(n,t.area)),e==="start"?(i=n.x0,a=n.y0):e==="end"?(i=n.x1,a=n.y1):(i=(n.x0+n.x1)/2,a=(n.y0+n.y1)/2),bc(i,a,r.vx,r.vy,t.align)}var cn={arc:function(r,t){var e=(r.startAngle+r.endAngle)/2,n=Math.cos(e),i=Math.sin(e),a=r.innerRadius,o=r.outerRadius;return ln({x0:r.x+n*a,y0:r.y+i*a,x1:r.x+n*o,y1:r.y+i*o,vx:n,vy:i},t)},point:function(r,t){var e=sr(r,t.origin),n=e.x*r.options.radius,i=e.y*r.options.radius;return ln({x0:r.x-n,y0:r.y-i,x1:r.x+n,y1:r.y+i,vx:e.x,vy:e.y},t)},bar:function(r,t){var e=sr(r,t.origin),n=r.x,i=r.y,a=0,o=0;return r.horizontal?(n=Math.min(r.x,r.base),a=Math.abs(r.base-r.x)):(i=Math.min(r.y,r.base),o=Math.abs(r.base-r.y)),ln({x0:n,y0:i+o,x1:n+a,y1:i,vx:e.x,vy:e.y},t)},fallback:function(r,t){var e=sr(r,t.origin);return ln({x0:r.x,y0:r.y,x1:r.x+(r.width||0),y1:r.y+(r.height||0),vx:e.x,vy:e.y},t)}},at=Ut.rasterize;function wc(r){var t=r.borderWidth||0,e=r.padding,n=r.size.height,i=r.size.width,a=-i/2,o=-n/2;return{frame:{x:a-e.left-t,y:o-e.top-t,w:i+e.width+t*2,h:n+e.height+t*2},text:{x:a,y:o,w:i,h:n}}}function Sc(r,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var n=e.getBasePixel();return r.horizontal?{x:n,y:null}:{x:null,y:n}}function Ac(r){return r instanceof zo?cn.arc:r instanceof Yo?cn.point:r instanceof Ko?cn.bar:cn.fallback}function Ec(r,t,e,n,i,a){var o=Math.PI/2;if(a){var u=Math.min(a,i/2,n/2),d=t+u,h=e+u,m=t+n-u,C=e+i-u;r.moveTo(t,h),d<m&&h<C?(r.arc(d,h,u,-Math.PI,-o),r.arc(m,h,u,-o,0),r.arc(m,C,u,0,o),r.arc(d,C,u,o,Math.PI)):d<m?(r.moveTo(d,e),r.arc(m,h,u,-o,o),r.arc(d,h,u,o,Math.PI+o)):h<C?(r.arc(d,h,u,-Math.PI,0),r.arc(d,C,u,0,Math.PI)):r.arc(d,h,u,-Math.PI,Math.PI),r.closePath(),r.moveTo(t,e)}else r.rect(t,e,n,i)}function Tc(r,t,e){var n=e.backgroundColor,i=e.borderColor,a=e.borderWidth;!n&&(!i||!a)||(r.beginPath(),Ec(r,at(t.x)+a/2,at(t.y)+a/2,at(t.w)-a,at(t.h)-a,e.borderRadius),r.closePath(),n&&(r.fillStyle=n,r.fill()),i&&a&&(r.strokeStyle=i,r.lineWidth=a,r.lineJoin="miter",r.stroke()))}function Rc(r,t,e){var n=e.lineHeight,i=r.w,a=r.x,o=r.y+n/2;return t==="center"?a+=i/2:(t==="end"||t==="right")&&(a+=i),{h:n,w:i,x:a,y:o}}function Mc(r,t,e){var n=r.shadowBlur,i=e.stroked,a=at(e.x),o=at(e.y),u=at(e.w);i&&r.strokeText(t,a,o,u),e.filled&&(n&&i&&(r.shadowBlur=0),r.fillText(t,a,o,u),n&&i&&(r.shadowBlur=n))}function xc(r,t,e,n){var i=n.textAlign,a=n.color,o=!!a,u=n.font,d=t.length,h=n.textStrokeColor,m=n.textStrokeWidth,C=h&&m,w;if(!(!d||!o&&!C))for(e=Rc(e,i,u),r.font=u.string,r.textAlign=i,r.textBaseline="middle",r.shadowBlur=n.textShadowBlur,r.shadowColor=n.textShadowColor,o&&(r.fillStyle=a),C&&(r.lineJoin="round",r.lineWidth=m,r.strokeStyle=h),w=0,d=t.length;w<d;++w)Mc(r,t[w],{stroked:C,filled:o,w:e.w,x:e.x,y:e.y+e.h*w})}var wo=function(r,t,e,n){var i=this;i._config=r,i._index=n,i._model=null,i._rects=null,i._ctx=t,i._el=e};Ht(wo.prototype,{_modelize:function(r,t,e,n){var i=this,a=i._index,o=$o(Ae([e.font,{}],n,a)),u=Ae([e.color,Wo.color],n,a);return{align:Ae([e.align,"center"],n,a),anchor:Ae([e.anchor,"center"],n,a),area:n.chart.chartArea,backgroundColor:Ae([e.backgroundColor,null],n,a),borderColor:Ae([e.borderColor,null],n,a),borderRadius:Ae([e.borderRadius,0],n,a),borderWidth:Ae([e.borderWidth,0],n,a),clamp:Ae([e.clamp,!1],n,a),clip:Ae([e.clip,!1],n,a),color:u,display:r,font:o,lines:t,offset:Ae([e.offset,4],n,a),opacity:Ae([e.opacity,1],n,a),origin:Sc(i._el,n),padding:Vo(Ae([e.padding,4],n,a)),positioner:Ac(i._el),rotation:Ae([e.rotation,0],n,a)*(Math.PI/180),size:Ut.textSize(i._ctx,t,o),textAlign:Ae([e.textAlign,"start"],n,a),textShadowBlur:Ae([e.textShadowBlur,0],n,a),textShadowColor:Ae([e.textShadowColor,u],n,a),textStrokeColor:Ae([e.textStrokeColor,u],n,a),textStrokeWidth:Ae([e.textStrokeWidth,0],n,a)}},update:function(r){var t=this,e=null,n=null,i=t._index,a=t._config,o,u,d,h=Ae([a.display,!0],r,i);h&&(o=r.dataset.data[i],u=Go(wi(a.formatter,[o,r]),o),d=Ft(u)?[]:Ut.toTextLines(u),d.length&&(e=t._modelize(h,d,a,r),n=wc(e))),t._model=e,t._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(r,t){var e=this,n=r.ctx,i=e._model,a=e._rects,o;this.visible()&&(n.save(),i.clip&&(o=i.area,n.beginPath(),n.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),n.clip()),n.globalAlpha=Ut.bound(0,i.opacity,1),n.translate(at(t.x),at(t.y)),n.rotate(i.rotation),Tc(n,a.frame,i),xc(n,i.lines,a.text,i),n.restore())}});var Ic=Number.MIN_SAFE_INTEGER||-9007199254740991,Dc=Number.MAX_SAFE_INTEGER||9007199254740991;function Lt(r,t,e){var n=Math.cos(e),i=Math.sin(e),a=t.x,o=t.y;return{x:a+n*(r.x-a)-i*(r.y-o),y:o+i*(r.x-a)+n*(r.y-o)}}function Oi(r,t){var e=Dc,n=Ic,i=t.origin,a,o,u,d,h;for(a=0;a<r.length;++a)o=r[a],u=o.x-i.x,d=o.y-i.y,h=t.vx*u+t.vy*d,e=Math.min(e,h),n=Math.max(n,h);return{min:e,max:n}}function fn(r,t){var e=t.x-r.x,n=t.y-r.y,i=Math.sqrt(e*e+n*n);return{vx:(t.x-r.x)/i,vy:(t.y-r.y)/i,origin:r,ln:i}}var So=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};Ht(So.prototype,{center:function(){var r=this._rect;return{x:r.x+r.w/2,y:r.y+r.h/2}},update:function(r,t,e){this._rotation=e,this._rect={x:t.x+r.x,y:t.y+r.y,w:t.w,h:t.h}},contains:function(r){var t=this,e=1,n=t._rect;return r=Lt(r,t.center(),-t._rotation),!(r.x<n.x-e||r.y<n.y-e||r.x>n.x+n.w+e*2||r.y>n.y+n.h+e*2)},intersects:function(r){var t=this._points(),e=r._points(),n=[fn(t[0],t[1]),fn(t[0],t[3])],i,a,o;for(this._rotation!==r._rotation&&n.push(fn(e[0],e[1]),fn(e[0],e[3])),i=0;i<n.length;++i)if(a=Oi(t,n[i]),o=Oi(e,n[i]),a.max<o.min||o.max<a.min)return!1;return!0},_points:function(){var r=this,t=r._rect,e=r._rotation,n=r.center();return[Lt({x:t.x,y:t.y},n,e),Lt({x:t.x+t.w,y:t.y},n,e),Lt({x:t.x+t.w,y:t.y+t.h},n,e),Lt({x:t.x,y:t.y+t.h},n,e)]}});function Ao(r,t,e){var n=t.positioner(r,t),i=n.vx,a=n.vy;if(!i&&!a)return{x:n.x,y:n.y};var o=e.w,u=e.h,d=t.rotation,h=Math.abs(o/2*Math.cos(d))+Math.abs(u/2*Math.sin(d)),m=Math.abs(o/2*Math.sin(d))+Math.abs(u/2*Math.cos(d)),C=1/Math.max(Math.abs(i),Math.abs(a));return h*=i*C,m*=a*C,h+=t.offset*i,m+=t.offset*a,{x:n.x+h,y:n.y+m}}function _c(r,t){var e,n,i,a;for(e=r.length-1;e>=0;--e)for(i=r[e].$layout,n=e-1;n>=0&&i._visible;--n)a=r[n].$layout,a._visible&&i._box.intersects(a._box)&&t(i,a);return r}function Pc(r){var t,e,n,i,a,o,u;for(t=0,e=r.length;t<e;++t)n=r[t],i=n.$layout,i._visible&&(u=new Proxy(n._el,{get:(d,h)=>d.getProps([h],!0)[h]}),a=n.geometry(),o=Ao(u,n.model(),a),i._box.update(o,a,n.rotation()));return _c(r,function(d,h){var m=d._hidable,C=h._hidable;m&&C||C?h._visible=!1:m&&(d._visible=!1)})}var Bt={prepare:function(r){var t=[],e,n,i,a,o;for(e=0,i=r.length;e<i;++e)for(n=0,a=r[e].length;n<a;++n)o=r[e][n],t.push(o),o.$layout={_box:new So,_hidable:!1,_visible:!0,_set:e,_idx:o._index};return t.sort(function(u,d){var h=u.$layout,m=d.$layout;return h._idx===m._idx?m._set-h._set:m._idx-h._idx}),this.update(t),t},update:function(r){var t=!1,e,n,i,a,o;for(e=0,n=r.length;e<n;++e)i=r[e],a=i.model(),o=i.$layout,o._hidable=a&&a.display==="auto",o._visible=i.visible(),t|=o._hidable;t&&Pc(r)},lookup:function(r,t){var e,n;for(e=r.length-1;e>=0;--e)if(n=r[e].$layout,n&&n._visible&&n._box.contains(t))return r[e];return null},draw:function(r,t){var e,n,i,a,o,u;for(e=0,n=t.length;e<n;++e)i=t[e],a=i.$layout,a._visible&&(o=i.geometry(),u=Ao(i._el,i.model(),o),a._box.update(u,o,i.rotation()),i.draw(r,u))}},kc=function(r){if(Ft(r))return null;var t=r,e,n,i;if(Bo(r))if(!Ft(r.label))t=r.label;else if(!Ft(r.r))t=r.r;else for(t="",e=Object.keys(r),i=0,n=e.length;i<n;++i)t+=(i!==0?", ":"")+e[i]+": "+r[e[i]];return""+t},Lc={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:kc,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},je="$datalabels",Eo="$default";function Nc(r,t){var e=r.datalabels,n={},i=[],a,o;return e===!1?null:(e===!0&&(e={}),t=Ht({},[t,e]),a=t.labels||{},o=Object.keys(a),delete t.labels,o.length?o.forEach(function(u){a[u]&&i.push(Ht({},[t,a[u],{_key:u}]))}):i.push(t),n=i.reduce(function(u,d){return Ho(d.listeners||{},function(h,m){u[m]=u[m]||{},u[m][d._key||Eo]=h}),delete d.listeners,u},{}),{labels:i,listeners:n})}function Cr(r,t,e,n){if(t){var i=e.$context,a=e.$groups,o;t[a._set]&&(o=t[a._set][a._key],o&&wi(o,[i,n])===!0&&(r[je]._dirty=!0,e.update(i)))}}function Fc(r,t,e,n,i){var a,o;!e&&!n||(e?n?e!==n&&(o=a=!0):o=!0:a=!0,o&&Cr(r,t.leave,e,i),a&&Cr(r,t.enter,n,i))}function jc(r,t){var e=r[je],n=e._listeners,i,a;if(!(!n.enter&&!n.leave)){if(t.type==="mousemove")a=Bt.lookup(e._labels,t);else if(t.type!=="mouseout")return;i=e._hovered,e._hovered=a,Fc(r,n,i,a,t)}}function Uc(r,t){var e=r[je],n=e._listeners.click,i=n&&Bt.lookup(e._labels,t);i&&Cr(r,n,i,t)}var df={id:"datalabels",defaults:Lc,beforeInit:function(r){r[je]={_actives:[]}},beforeUpdate:function(r){var t=r[je];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(r,t,e){var n=t.index,i=r[je],a=i._datasets[n]=[],o=r.isDatasetVisible(n),u=r.data.datasets[n],d=Nc(u,e),h=t.meta.data||[],m=r.ctx,C,w,M,l,A,T,x,b;for(m.save(),C=0,M=h.length;C<M;++C)if(x=h[C],x[je]=[],o&&x&&r.getDataVisibility(C)&&!x.skip)for(w=0,l=d.labels.length;w<l;++w)A=d.labels[w],T=A._key,b=new wo(A,m,x,C),b.$groups={_set:n,_key:T||Eo},b.$context={active:!1,chart:r,dataIndex:C,dataset:u,datasetIndex:n},b.update(b.$context),x[je].push(b),a.push(b);m.restore(),Ht(i._listeners,d.listeners,{merger:function(y,R,p){R[y]=R[y]||{},R[y][t.index]=p[y],i._listened=!0}})},afterUpdate:function(r){r[je]._labels=Bt.prepare(r[je]._datasets)},afterDatasetsDraw:function(r){Bt.draw(r,r[je]._labels)},beforeEvent:function(r,t){if(r[je]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":jc(r,e);break;case"click":Uc(r,e);break}}},afterEvent:function(r){var t=r[je],e=t._actives,n=t._actives=r.getActiveElements(),i=Ut.arrayDiff(e,n),a,o,u,d,h,m,C;for(a=0,o=i.length;a<o;++a)if(h=i[a],h[1])for(C=h[0].element[je]||[],u=0,d=C.length;u<d;++u)m=C[u],m.$context.active=h[1]===1,m.update(m.$context);(t._dirty||i.length)&&(Bt.update(t._labels),r.render()),delete t._dirty}};export{uf as A,br as C,sf as E,lf as N,Ge as T,Ee as a,cf as d,Re as f,df as p,ff as r};
